---
title: Titanic Tree Based Model
author: ''
date: '2021-11-22'
slug: titanic-tree-based-model
categories: []
tags: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="summary" class="section level1">
<h1>Summary</h1>
<pre class="r"><code>summary(titanic3)</code></pre>
<pre><code>##      pclass         survived         name               sex           
##  Min.   :1.000   Min.   :0.000   Length:1309        Length:1309       
##  1st Qu.:2.000   1st Qu.:0.000   Class :character   Class :character  
##  Median :3.000   Median :0.000   Mode  :character   Mode  :character  
##  Mean   :2.295   Mean   :0.382                                        
##  3rd Qu.:3.000   3rd Qu.:1.000                                        
##  Max.   :3.000   Max.   :1.000                                        
##                                                                       
##       age            sibsp            parch          ticket         
##  Min.   : 0.17   Min.   :0.0000   Min.   :0.000   Length:1309       
##  1st Qu.:21.00   1st Qu.:0.0000   1st Qu.:0.000   Class :character  
##  Median :28.00   Median :0.0000   Median :0.000   Mode  :character  
##  Mean   :29.88   Mean   :0.4989   Mean   :0.385                     
##  3rd Qu.:39.00   3rd Qu.:1.0000   3rd Qu.:0.000                     
##  Max.   :80.00   Max.   :8.0000   Max.   :9.000                     
##  NA&#39;s   :263                                                        
##       fare            cabin             embarked             boat          
##  Min.   :  0.000   Length:1309        Length:1309        Length:1309       
##  1st Qu.:  7.896   Class :character   Class :character   Class :character  
##  Median : 14.454   Mode  :character   Mode  :character   Mode  :character  
##  Mean   : 33.295                                                           
##  3rd Qu.: 31.275                                                           
##  Max.   :512.329                                                           
##  NA&#39;s   :1                                                                 
##       body        home.dest        
##  Min.   :  1.0   Length:1309       
##  1st Qu.: 72.0   Class :character  
##  Median :155.0   Mode  :character  
##  Mean   :160.8                     
##  3rd Qu.:256.0                     
##  Max.   :328.0                     
##  NA&#39;s   :1188</code></pre>
<p>We can see above the NA values are in age, fare and body but character variable NA values are not given above. Hence, we use misssmap to visualize the NA values.</p>
</div>
<div id="cleaning-and-preparing-the-dataset" class="section level1">
<h1>Cleaning and preparing the dataset</h1>
<pre class="r"><code>missmap(titanic3, col = c(&quot;black&quot;, &quot;grey&quot;))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" />
We can see many NA values for body, cabin, boat, home.dest and age and we can intuitively decide that body, Cabin, boat, home.dest will not impact the survival. Age also has some NA values but it is likely that it will impact the survival and we will remove the NA values. Though there is no NA for name and ticket number, we can intutively remove those as it will not impact survival</p>
</div>
<div id="removing-cabin-body-boat-and-home.dest" class="section level1">
<h1>Removing cabin, body, boat and home.dest</h1>
<pre class="r"><code>titanic3 &lt;- subset (titanic3, select = - cabin)
titanic3 &lt;- subset (titanic3, select = - body)
titanic3 &lt;- subset (titanic3, select = - boat)
titanic3 &lt;- subset (titanic3, select = - home.dest)
titanic3 &lt;- subset (titanic3, select = - name)
titanic3 &lt;- subset (titanic3, select = - ticket)</code></pre>
</div>
<div id="dropping-the-missing-values" class="section level1">
<h1>Dropping the missing values</h1>
<pre class="r"><code>titanic3 = na.omit(titanic3)</code></pre>
</div>
<div id="summary-after-removing-na" class="section level1">
<h1>summary after removing NA</h1>
<pre class="r"><code>summary(titanic3)</code></pre>
<pre><code>##      pclass         survived          sex                 age       
##  Min.   :1.000   Min.   :0.0000   Length:1043        Min.   : 0.17  
##  1st Qu.:1.000   1st Qu.:0.0000   Class :character   1st Qu.:21.00  
##  Median :2.000   Median :0.0000   Mode  :character   Median :28.00  
##  Mean   :2.209   Mean   :0.4075                      Mean   :29.81  
##  3rd Qu.:3.000   3rd Qu.:1.0000                      3rd Qu.:39.00  
##  Max.   :3.000   Max.   :1.0000                      Max.   :80.00  
##      sibsp            parch             fare          embarked        
##  Min.   :0.0000   Min.   :0.0000   Min.   :  0.00   Length:1043       
##  1st Qu.:0.0000   1st Qu.:0.0000   1st Qu.:  8.05   Class :character  
##  Median :0.0000   Median :0.0000   Median : 15.75   Mode  :character  
##  Mean   :0.5043   Mean   :0.4219   Mean   : 36.60                     
##  3rd Qu.:1.0000   3rd Qu.:1.0000   3rd Qu.: 35.08                     
##  Max.   :8.0000   Max.   :6.0000   Max.   :512.33</code></pre>
</div>
<div id="descriptive-statistics" class="section level1">
<h1>Descriptive Statistics</h1>
<pre class="r"><code>descr(titanic3)</code></pre>
<pre><code>## Non-numerical variable(s) ignored: sex, embarked</code></pre>
<pre><code>## Descriptive Statistics  
## titanic3  
## N: 1043  
## 
##                         age      fare     parch    pclass     sibsp   survived
## ----------------- --------- --------- --------- --------- --------- ----------
##              Mean     29.81     36.60      0.42      2.21      0.50       0.41
##           Std.Dev     14.37     55.75      0.84      0.84      0.91       0.49
##               Min      0.17      0.00      0.00      1.00      0.00       0.00
##                Q1     21.00      8.05      0.00      1.00      0.00       0.00
##            Median     28.00     15.75      0.00      2.00      0.00       0.00
##                Q3     39.00     35.50      1.00      3.00      1.00       1.00
##               Max     80.00    512.33      6.00      3.00      8.00       1.00
##               MAD     11.86     12.16      0.00      1.48      0.00       0.00
##               IQR     18.00     27.03      1.00      2.00      1.00       1.00
##                CV      0.48      1.52      1.99      0.38      1.81       1.21
##          Skewness      0.41      4.11      2.65     -0.41      2.80       0.38
##       SE.Skewness      0.08      0.08      0.08      0.08      0.08       0.08
##          Kurtosis      0.15     23.52      9.27     -1.47     10.46      -1.86
##           N.Valid   1043.00   1043.00   1043.00   1043.00   1043.00    1043.00
##         Pct.Valid    100.00    100.00    100.00    100.00    100.00     100.00</code></pre>
</div>
<div id="structure-of-the-data" class="section level1">
<h1>Structure of the data</h1>
<pre class="r"><code>str(titanic3)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1043 obs. of  8 variables:
##  $ pclass  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ survived: int  1 1 0 0 0 1 1 0 1 0 ...
##  $ sex     : chr  &quot;female&quot; &quot;male&quot; &quot;female&quot; &quot;male&quot; ...
##  $ age     : num  29 0.92 2 30 25 48 63 39 53 71 ...
##  $ sibsp   : int  0 1 1 1 1 0 1 0 2 0 ...
##  $ parch   : int  0 2 2 2 2 0 0 0 0 0 ...
##  $ fare    : num  211 152 152 152 152 ...
##  $ embarked: chr  &quot;S&quot; &quot;S&quot; &quot;S&quot; &quot;S&quot; ...
##  - attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:266] 16 38 41 47 60 70 71 75 81 107 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:266] &quot;16&quot; &quot;38&quot; &quot;41&quot; &quot;47&quot; ...</code></pre>
<p>pclass is the ticket class and it is ordinal categorical value but it is taken as integer. Survived is a nominal categorical value but taken as integer. Hence, I change both as a categorical values</p>
</div>
<div id="changing-survived-and-pclass-as-categorical-value" class="section level1">
<h1>Changing survived and pclass as categorical value</h1>
<pre class="r"><code>titanic3$survived = factor(titanic3$survived)
titanic3$pclass = factor(titanic3$pclass, order=TRUE, levels = c(3, 2, 1))</code></pre>
</div>
<div id="revised-structure" class="section level1">
<h1>Revised structure</h1>
<pre class="r"><code>str(titanic3)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1043 obs. of  8 variables:
##  $ pclass  : Ord.factor w/ 3 levels &quot;3&quot;&lt;&quot;2&quot;&lt;&quot;1&quot;: 3 3 3 3 3 3 3 3 3 3 ...
##  $ survived: Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 1 1 1 2 2 1 2 1 ...
##  $ sex     : chr  &quot;female&quot; &quot;male&quot; &quot;female&quot; &quot;male&quot; ...
##  $ age     : num  29 0.92 2 30 25 48 63 39 53 71 ...
##  $ sibsp   : int  0 1 1 1 1 0 1 0 2 0 ...
##  $ parch   : int  0 2 2 2 2 0 0 0 0 0 ...
##  $ fare    : num  211 152 152 152 152 ...
##  $ embarked: chr  &quot;S&quot; &quot;S&quot; &quot;S&quot; &quot;S&quot; ...
##  - attr(*, &quot;na.action&quot;)= &#39;omit&#39; Named int [1:266] 16 38 41 47 60 70 71 75 81 107 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:266] &quot;16&quot; &quot;38&quot; &quot;41&quot; &quot;47&quot; ...</code></pre>
</div>
<div id="univariate-analysis-on-numerical-data" class="section level1">
<h1>Univariate analysis on numerical data</h1>
</div>
<div id="univariate-analysis-on-age" class="section level1">
<h1>Univariate analysis on age</h1>
<pre class="r"><code>descr(titanic3$age)</code></pre>
<pre><code>## Descriptive Statistics  
## titanic3$age  
## N: 1043  
## 
##                         age
## ----------------- ---------
##              Mean     29.81
##           Std.Dev     14.37
##               Min      0.17
##                Q1     21.00
##            Median     28.00
##                Q3     39.00
##               Max     80.00
##               MAD     11.86
##               IQR     18.00
##                CV      0.48
##          Skewness      0.41
##       SE.Skewness      0.08
##          Kurtosis      0.15
##           N.Valid   1043.00
##         Pct.Valid    100.00</code></pre>
</div>
<div id="boxplot-of-age-and-its-outliers" class="section level1">
<h1>Boxplot of age and its outliers</h1>
<pre class="r"><code>age_outliers&lt;-boxplot.stats(titanic3$age)$out
boxplot(titanic3$age, main = &quot;Box plot of age&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(age_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<pre class="r"><code>age_outliers</code></pre>
<pre><code>## [1] 71.0 80.0 76.0 70.0 71.0 67.0 70.0 70.5 74.0</code></pre>
</div>
<div id="removal-of-outliers-of-age" class="section level1">
<h1>Removal of outliers of age</h1>
<pre class="r"><code>titanic3 &lt;- subset (titanic3, age &lt; 67)</code></pre>
</div>
<div id="univariate-analysis-on-sibsp" class="section level1">
<h1>Univariate analysis on sibsp</h1>
<pre class="r"><code>descr(titanic3$sibsp)</code></pre>
<pre><code>## Descriptive Statistics  
## titanic3$sibsp  
## N: 1034  
## 
##                       sibsp
## ----------------- ---------
##              Mean      0.51
##           Std.Dev      0.92
##               Min      0.00
##                Q1      0.00
##            Median      0.00
##                Q3      1.00
##               Max      8.00
##               MAD      0.00
##               IQR      1.00
##                CV      1.81
##          Skewness      2.79
##       SE.Skewness      0.08
##          Kurtosis     10.39
##           N.Valid   1034.00
##         Pct.Valid    100.00</code></pre>
</div>
<div id="boxplot-of-sibsp-and-its-outliers" class="section level1">
<h1>Boxplot of sibsp and its outliers</h1>
<pre class="r"><code>sibsp_outliers&lt;-boxplot.stats(titanic3$sibsp)$out
boxplot(titanic3$sibsp, main = &quot;Box plot of sibsp&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(sibsp_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<pre class="r"><code>sibsp_outliers</code></pre>
<pre><code>##  [1] 3 3 3 3 3 4 4 4 4 4 4 4 4 4 4 4 4 3 5 5 5 5 5 5 3 3 3 3 3 4 4 4 4 4 4 4 4 4
## [39] 4 8 3 3 3 3 3</code></pre>
</div>
<div id="removal-of-outliers-of-sibsp" class="section level1">
<h1>Removal of outliers of sibsp</h1>
<pre class="r"><code>titanic3 &lt;- subset (titanic3, sibsp &lt; 3)</code></pre>
<p>Removed siblings/ spouses greater than 3</p>
</div>
<div id="univariate-analysis-on-parch" class="section level1">
<h1>Univariate analysis on parch</h1>
<pre class="r"><code>descr(titanic3$parch)</code></pre>
<pre><code>## Descriptive Statistics  
## titanic3$parch  
## N: 989  
## 
##                      parch
## ----------------- --------
##              Mean     0.37
##           Std.Dev     0.82
##               Min     0.00
##                Q1     0.00
##            Median     0.00
##                Q3     0.00
##               Max     6.00
##               MAD     0.00
##               IQR     0.00
##                CV     2.18
##          Skewness     3.02
##       SE.Skewness     0.08
##          Kurtosis    11.80
##           N.Valid   989.00
##         Pct.Valid   100.00</code></pre>
</div>
<div id="boxplot-of-parch-and-its-outliers" class="section level1">
<h1>Boxplot of parch and its outliers</h1>
<pre class="r"><code>parch_outliers&lt;-boxplot.stats(titanic3$parch)$out
boxplot(titanic3$parch, main = &quot;Box plot of parch&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(parch_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>parch_outliers</code></pre>
<pre><code>##   [1] 2 2 2 2 1 1 1 1 1 1 1 2 2 2 2 1 1 2 2 1 2 1 2 1 1 1 4 4 2 1 1 1 1 1 1 1 1
##  [38] 1 1 1 1 1 1 1 1 2 2 1 1 1 1 2 2 2 3 3 2 1 1 2 1 1 1 2 1 1 1 2 1 1 1 2 1 1
##  [75] 1 1 1 1 3 2 1 1 2 1 1 1 2 2 1 1 1 2 1 1 2 1 1 1 2 1 1 2 1 1 2 2 2 2 1 1 1
## [112] 3 1 1 1 2 2 2 2 2 1 1 1 1 1 1 2 1 1 1 1 1 1 2 1 1 3 1 2 1 1 2 2 2 2 2 2 1
## [149] 1 1 1 5 5 5 5 1 1 1 3 1 1 1 1 1 1 1 1 2 1 1 2 1 1 2 2 2 2 2 1 1 2 2 2 3 3
## [186] 2 1 1 6 6 1 1 1 1 2 1 1 2 1 1 1 2 1 1 2 1 1 1 1 4 5 1 1 2 5 1 1 2 1 2 1 4
## [223] 4 1 1 1 1 1 1 2 1 2 2 1 1</code></pre>
<p>Though majority of the data are shown as outliers for parents and childern aboard the Titanic, i feel that they might influence the survival, Hence, I did not remove the outliers or the data</p>
</div>
<div id="univariate-analysis-on-fare" class="section level1">
<h1>Univariate analysis on fare</h1>
<pre class="r"><code>descr(titanic3$fare)</code></pre>
<pre><code>## Descriptive Statistics  
## titanic3$fare  
## N: 989  
## 
##                       fare
## ----------------- --------
##              Mean    35.71
##           Std.Dev    54.98
##               Min     0.00
##                Q1     8.05
##            Median    14.50
##                Q3    33.50
##               Max   512.33
##               MAD    10.26
##               IQR    25.45
##                CV     1.54
##          Skewness     4.25
##       SE.Skewness     0.08
##          Kurtosis    25.55
##           N.Valid   989.00
##         Pct.Valid   100.00</code></pre>
</div>
<div id="boxplot-of-fare-and-its-outliers" class="section level1">
<h1>Boxplot of fare and its outliers</h1>
<pre class="r"><code>fare_outliers&lt;-boxplot.stats(titanic3$fare)$out
boxplot(titanic3$fare, main = &quot;Box plot of fare&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(fare_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>fare_outliers</code></pre>
<pre><code>##   [1] 211.3375 151.5500 151.5500 151.5500 151.5500  77.9583 227.5250 227.5250
##   [9]  78.8500 247.5208 247.5208  76.2917  75.2417 227.5250 221.7792  91.0792
##  [17]  91.0792 135.6333 164.8667 262.3750  76.2917 134.5000 512.3292 512.3292
##  [25] 120.0000 120.0000 120.0000 120.0000  78.8500 262.3750  86.5000 136.7792
##  [33] 136.7792 151.5500  83.1583  83.1583  83.1583 151.5500  81.8583  81.8583
##  [41]  81.8583 106.4250 247.5208 106.4250  83.1583 227.5250  78.2667 263.0000
##  [49] 263.0000 133.6500  79.2000  79.2000 211.5000  79.2000  89.1042 153.4625
##  [57] 153.4625  79.2000  76.7292  76.7292  83.4750  83.4750  76.7292  83.1583
##  [65]  93.5000  93.5000  77.9583  90.0000  90.0000 211.5000 211.3375 106.4250
##  [73] 512.3292  77.9583 146.5208 211.3375  86.5000  75.2417  82.1708  90.0000
##  [81]  90.0000  90.0000 113.2750 113.2750 113.2750 108.9000  93.5000 108.9000
##  [89] 108.9000  93.5000  83.1583 135.6333 211.3375  79.2000  86.5000 262.3750
##  [97] 262.3750 262.3750 262.3750 262.3750 153.4625  82.2667  82.2667 134.5000
## [105] 134.5000 134.5000 146.5208  78.2667 221.7792  79.6500  79.6500  79.6500
## [113] 110.8833 110.8833 110.8833 512.3292  75.2500  75.2500  77.2875  77.2875
## [121] 135.6333 164.8667 164.8667 164.8667 211.5000 211.5000 211.5000 134.5000
## [129] 135.6333  73.5000  73.5000  73.5000  73.5000  73.5000  73.5000  73.5000</code></pre>
<p>Here, fare also has more outliers but I don’t delete it and keep the file as it is and process further.</p>
</div>
<div id="univariate-analysis-on-categorical-value" class="section level1">
<h1>UNivariate analysis on categorical value</h1>
</div>
<div id="frequency-distribution-of-pclass" class="section level1">
<h1>Frequency distribution of pclass</h1>
<pre class="r"><code>tab1(titanic3$pclass, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of pclass&quot;, xlab =&quot;pclass&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<pre><code>## titanic3$pclass : 
##         Frequency Percent Cum. percent
## 2             259    26.2         26.2
## 1             272    27.5         53.7
## 3             458    46.3        100.0
##   Total       989   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-survived" class="section level1">
<h1>Frequency distribution of survived</h1>
<pre class="r"><code>tab1(titanic3$survived, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of survived&quot;, xlab =&quot;survived&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre><code>## titanic3$survived : 
##         Frequency Percent Cum. percent
## 1             414    41.9         41.9
## 0             575    58.1        100.0
##   Total       989   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-sex" class="section level1">
<h1>Frequency distribution of sex</h1>
<pre class="r"><code>tab1(titanic3$sex, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of sex&quot;, xlab =&quot;sex&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<pre><code>## titanic3$sex : 
##         Frequency Percent Cum. percent
## female        367    37.1         37.1
## male          622    62.9        100.0
##   Total       989   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-embarked" class="section level1">
<h1>Frequency distribution of embarked</h1>
<p>Writing the embarked data in full words</p>
<pre class="r"><code>titanic3$embarked[titanic3$embarked == &quot;S&quot; ] &lt;-&quot;Southampton&quot;
titanic3$embarked[titanic3$embarked == &quot;C&quot; ] &lt;-&quot;Cherbourg&quot;
titanic3$embarked[titanic3$embarked == &quot;Q&quot; ] &lt;-&quot;Queenstown&quot;</code></pre>
<pre class="r"><code>tab1(titanic3$embarked, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of embarked&quot;, xlab =&quot;embarked&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<pre><code>## titanic3$embarked : 
##             Frequency Percent Cum. percent
## Queenstown         44     4.4          4.4
## Cherbourg         210    21.2         25.7
## Southampton       735    74.3        100.0
##   Total           989   100.0        100.0</code></pre>
</div>
<div id="bivariate-analysis-to-see-the-relationship-between-dependant-and-independant-variable" class="section level1">
<h1>Bivariate analysis to see the relationship between dependant and independant variable</h1>
</div>
<div id="relationship-between-survived-and-pclass" class="section level1">
<h1>Relationship between survived and pclass</h1>
<pre class="r"><code>pclass_survived = glm(survived~ pclass, data = titanic3, family = &quot;binomial&quot;)
summary(pclass_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ pclass, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4289  -0.8022  -0.8022   0.9453   1.6066  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.21177    0.06877  -3.079  0.00208 ** 
## pclass.L     1.09102    0.11597   9.408  &lt; 2e-16 ***
## pclass.Q     0.03523    0.12218   0.288  0.77306    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1249.7  on 986  degrees of freedom
## AIC: 1255.7
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>ggplot(titanic3, aes(x = survived, fill = pclass)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-28-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-sex" class="section level1">
<h1>Relationship between survived and sex</h1>
<pre class="r"><code>sex_survived = glm(survived~ sex, data = titanic3, family = &quot;binomial&quot;)
summary(sex_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ sex, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7104  -0.6907  -0.6907   0.7259   1.7608  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)   1.1993     0.1237   9.692   &lt;2e-16 ***
## sexmale      -2.5109     0.1579 -15.903   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1040.2  on 987  degrees of freedom
## AIC: 1044.2
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>ggplot(titanic3, aes(x = survived, fill = sex)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-30-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-embarked" class="section level1">
<h1>Relationship between survived and embarked</h1>
<pre class="r"><code>embarked_survived = glm(survived~ embarked, data = titanic3, family = &quot;binomial&quot;)
summary(embarked_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ embarked, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.4074  -0.9547  -0.9547   1.4179   1.5616  
## 
## Coefficients:
##                     Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)           0.5261     0.1428   3.684 0.000230 ***
## embarkedQueenstown   -1.3951     0.3600  -3.876 0.000106 ***
## embarkedSouthampton  -1.0756     0.1620  -6.637 3.19e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1296.0  on 986  degrees of freedom
## AIC: 1302
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>ggplot(titanic3, aes(x = survived, fill = embarked)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-32-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-age" class="section level1">
<h1>Relationship between survived and age</h1>
<pre class="r"><code>age_survived = glm(survived~ age, data = titanic3, family = &quot;binomial&quot;)
summary(age_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ age, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##    Min      1Q  Median      3Q     Max  
## -1.220  -1.059  -0.951   1.282   1.539  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept)  0.10492    0.15887   0.660  0.50900   
## age         -0.01443    0.00487  -2.964  0.00303 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1335.8  on 987  degrees of freedom
## AIC: 1339.8
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>titanic3$discretized.age = cut(titanic3$age, c(0, 10, 20, 30, 40, 50, 60, 70))
ggplot(titanic3, aes(x = discretized.age, fill = survived)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-sibsp" class="section level1">
<h1>Relationship between survived and sibsp</h1>
<pre class="r"><code>sibsp_survived = glm(survived~ sibsp, data = titanic3, family = &quot;binomial&quot;)
summary(sibsp_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ sibsp, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3459  -0.9792  -0.9792   1.3895   1.3895  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.48598    0.07781  -6.246 4.21e-10 ***
## sibsp        0.43694    0.11759   3.716 0.000203 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1330.8  on 987  degrees of freedom
## AIC: 1334.8
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>ggplot(titanic3, aes(x = sibsp, fill = survived)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-parch" class="section level1">
<h1>Relationship between survived and parch</h1>
<pre class="r"><code>parch_survived = glm(survived~ parch, data = titanic3, family = &quot;binomial&quot;)
summary(parch_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ parch, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.0173  -0.9827  -0.9827   1.3855   1.3855  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.47706    0.07228  -6.600 4.10e-11 ***
## parch        0.39528    0.08608   4.592 4.39e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1321.3  on 987  degrees of freedom
## AIC: 1325.3
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>ggplot(titanic3, aes(x = parch, fill = survived)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
</div>
<div id="relationship-between-survived-and-fare" class="section level1">
<h1>Relationship between survived and fare</h1>
<pre class="r"><code>fare_survived = glm(survived~ fare, data = titanic3, family = &quot;binomial&quot;)
summary(fare_survived)</code></pre>
<pre><code>## 
## Call:
## glm(formula = survived ~ fare, family = &quot;binomial&quot;, data = titanic3)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -2.3625  -0.9349  -0.9087   1.3343   1.5188  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -0.774275   0.087123  -8.887  &lt; 2e-16 ***
## fare         0.013314   0.001866   7.136  9.6e-13 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1344.7  on 988  degrees of freedom
## Residual deviance: 1269.3  on 987  degrees of freedom
## AIC: 1273.3
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<pre class="r"><code>titanic3$discretized.fare = cut(titanic3$fare, c(0, 50, 100, 150, 200, 250, 300, 350, 400, 450, 500, 550))
ggplot(titanic3, aes(x = discretized.fare, fill = survived)) + geom_bar(position = position_dodge())+geom_text(stat = &#39;count&#39;, aes(label = stat(count)), position = position_dodge(width =1), vjust = -0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
</div>
<div id="data-resampling" class="section level1">
<h1>Data resampling</h1>
<pre class="r"><code>titanic_split &lt;- initial_split (titanic3, prop = 0.80, strata = survived)
titanic_training &lt;- titanic_split %&gt;%
  training()
titanic_test &lt;- titanic_split %&gt;%
  testing()</code></pre>
</div>
<div id="checking-number-of-rows-in-training-and-test-data" class="section level1">
<h1>Checking number of rows in training and test data</h1>
<pre class="r"><code>nrow(titanic_training)</code></pre>
<pre><code>## [1] 791</code></pre>
<pre class="r"><code>nrow(titanic_test)</code></pre>
<pre><code>## [1] 198</code></pre>
</div>
<div id="checking-multicollinearity-between-numerical-values-in-a-training-titanic-data-set" class="section level1">
<h1>Checking multicollinearity between numerical values in a training titanic data set</h1>
<pre class="r"><code>titanic_training %&gt;%
  select_if(is.numeric) %&gt;%
  cor()</code></pre>
<pre><code>##               age      sibsp       parch      fare
## age    1.00000000 -0.0592946 -0.05325892 0.1917420
## sibsp -0.05929460  1.0000000  0.26170521 0.1770886
## parch -0.05325892  0.2617052  1.00000000 0.2232772
## fare   0.19174203  0.1770886  0.22327719 1.0000000</code></pre>
<p>There is no multicolinearity between the independant variables</p>
</div>
<div id="model-specification-using-decision-tree" class="section level1">
<h1>Model specification using decision tree</h1>
<pre class="r"><code>titanic_dt_model&lt;- decision_tree() %&gt;%
  set_engine(&#39;rpart&#39;) %&gt;%
  set_mode(&#39;classification&#39;)</code></pre>
</div>
<div id="future-engineering" class="section level1">
<h1>Future engineering</h1>
<p>This is the step to pre-processing of data</p>
<pre class="r"><code>titanic_recipe_dt &lt;- recipe(survived ~ sex+ pclass + age + sibsp + parch + fare + embarked, data = titanic_training) %&gt;%
  step_corr(all_numeric(), threshold =0.8) %&gt;%
  step_normalize(all_numeric()) %&gt;%
  step_dummy(all_nominal(), -all_outcomes())
titanic_recipe_dt</code></pre>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor          7
## 
## Operations:
## 
## Correlation filter on all_numeric()
## Centering and scaling for all_numeric()
## Dummy variables from all_nominal(), -all_outcomes()</code></pre>
</div>
<div id="combining-models-and-recipe" class="section level1">
<h1>Combining models and recipe</h1>
<pre class="r"><code>titanic_wkfl_dt&lt;- workflow() %&gt;%
  add_model(titanic_dt_model) %&gt;%
  add_recipe(titanic_recipe_dt)
titanic_wkfl_dt</code></pre>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: decision_tree()
## 
## -- Preprocessor ----------------------------------------------------------------
## 3 Recipe Steps
## 
## * step_corr()
## * step_normalize()
## * step_dummy()
## 
## -- Model -----------------------------------------------------------------------
## Decision Tree Model Specification (classification)
## 
## Computational engine: rpart</code></pre>
</div>
<div id="model-fitting-with-workflow" class="section level1">
<h1>Model fitting with workflow</h1>
<pre class="r"><code>titanic_wkfl_fit_dt &lt;- titanic_wkfl_dt %&gt;%
  last_fit(split = titanic_split)
titanic_wkfl_fit_dt %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 2 x 4
##   .metric  .estimator .estimate .config             
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary         0.768 Preprocessor1_Model1
## 2 roc_auc  binary         0.777 Preprocessor1_Model1</code></pre>
</div>
<div id="collecting-predictions" class="section level1">
<h1>Collecting predictions</h1>
<pre class="r"><code>titanic_wkfl_preds_dt &lt;- titanic_wkfl_fit_dt %&gt;%
  collect_predictions()
titanic_wkfl_preds_dt</code></pre>
<pre><code>## # A tibble: 198 x 7
##    id               .pred_0 .pred_1  .row .pred_class survived .config          
##    &lt;chr&gt;              &lt;dbl&gt;   &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;       &lt;fct&gt;    &lt;chr&gt;            
##  1 train/test split  0.0541   0.946     3 1           0        Preprocessor1_Mo~
##  2 train/test split  0.0541   0.946     5 1           0        Preprocessor1_Mo~
##  3 train/test split  0.831    0.169    10 0           0        Preprocessor1_Mo~
##  4 train/test split  0.831    0.169    14 0           0        Preprocessor1_Mo~
##  5 train/test split  0.831    0.169    24 0           1        Preprocessor1_Mo~
##  6 train/test split  0.831    0.169    29 0           1        Preprocessor1_Mo~
##  7 train/test split  0.0541   0.946    31 1           1        Preprocessor1_Mo~
##  8 train/test split  0.0541   0.946    33 1           1        Preprocessor1_Mo~
##  9 train/test split  0.0541   0.946    34 1           1        Preprocessor1_Mo~
## 10 train/test split  0.831    0.169    36 0           0        Preprocessor1_Mo~
## # ... with 188 more rows</code></pre>
</div>
<div id="confusion-matrix" class="section level1">
<h1>Confusion matrix</h1>
<pre class="r"><code>conf_mat(titanic_wkfl_preds_dt, truth = survived, estimate = .pred_class) %&gt;%
  autoplot(type = &#39;heatmap&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-49-1.png" width="672" />
# Correct predictions
True negative is 108 people, who did not survive. True positive is 56 people survived.</p>
</div>
<div id="classification-error" class="section level1">
<h1>Classification error</h1>
<p>False positive is 7 people, who are predicted as survived but actually dead. False negative is 27 people, who are predicted as dead but actually survived.</p>
<p>More number of people died in Titanic</p>
</div>
<div id="exploring-custom-metrics" class="section level1">
<h1>Exploring custom metrics</h1>
<pre class="r"><code>titanic_metrics_dt &lt;- metric_set(roc_auc, sens, spec, accuracy)
titanic_wkfl_preds_dt %&gt;%
titanic_metrics_dt(truth = survived, estimate = .pred_class, .pred_1)</code></pre>
<pre><code>## # A tibble: 4 x 3
##   .metric  .estimator .estimate
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt;
## 1 sens     binary         0.861
## 2 spec     binary         0.639
## 3 accuracy binary         0.768
## 4 roc_auc  binary         0.223</code></pre>
</div>
<div id="creating-k-fold-cross-validation" class="section level1">
<h1>Creating k-fold cross validation</h1>
<pre class="r"><code>set.seed(212)
titanic_folds_dt &lt;- vfold_cv(titanic_training, v = 10, strata = survived)
titanic_folds_dt</code></pre>
<pre><code>## #  10-fold cross-validation using stratification 
## # A tibble: 10 x 2
##    splits           id    
##    &lt;list&gt;           &lt;chr&gt; 
##  1 &lt;split [711/80]&gt; Fold01
##  2 &lt;split [712/79]&gt; Fold02
##  3 &lt;split [712/79]&gt; Fold03
##  4 &lt;split [712/79]&gt; Fold04
##  5 &lt;split [712/79]&gt; Fold05
##  6 &lt;split [712/79]&gt; Fold06
##  7 &lt;split [712/79]&gt; Fold07
##  8 &lt;split [712/79]&gt; Fold08
##  9 &lt;split [712/79]&gt; Fold09
## 10 &lt;split [712/79]&gt; Fold10</code></pre>
</div>
<div id="model-training-with-cross-validation" class="section level1">
<h1>Model training with cross validation</h1>
<pre class="r"><code>titanic_rs_fit_dt &lt;-titanic_wkfl_dt %&gt;%
  fit_resamples(resamples = titanic_folds_dt, metrics = titanic_metrics_dt)
titanic_rs_fit_dt %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 4 x 6
##   .metric  .estimator  mean     n std_err .config             
##   &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary     0.810    10  0.0116 Preprocessor1_Model1
## 2 roc_auc  binary     0.834    10  0.0125 Preprocessor1_Model1
## 3 sens     binary     0.9      10  0.0205 Preprocessor1_Model1
## 4 spec     binary     0.686    10  0.0242 Preprocessor1_Model1</code></pre>
</div>
<div id="detailed-cross_validation-results" class="section level1">
<h1>Detailed cross_validation results</h1>
<pre class="r"><code>titanic_rs_metrics_dt &lt;-titanic_rs_fit_dt %&gt;%
  collect_metrics(summarize = FALSE)
titanic_rs_metrics_dt </code></pre>
<pre><code>## # A tibble: 40 x 5
##    id     .metric  .estimator .estimate .config             
##    &lt;chr&gt;  &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold01 sens     binary         0.826 Preprocessor1_Model1
##  2 Fold01 spec     binary         0.647 Preprocessor1_Model1
##  3 Fold01 accuracy binary         0.75  Preprocessor1_Model1
##  4 Fold01 roc_auc  binary         0.788 Preprocessor1_Model1
##  5 Fold02 sens     binary         0.978 Preprocessor1_Model1
##  6 Fold02 spec     binary         0.727 Preprocessor1_Model1
##  7 Fold02 accuracy binary         0.873 Preprocessor1_Model1
##  8 Fold02 roc_auc  binary         0.900 Preprocessor1_Model1
##  9 Fold03 sens     binary         0.826 Preprocessor1_Model1
## 10 Fold03 spec     binary         0.697 Preprocessor1_Model1
## # ... with 30 more rows</code></pre>
</div>
<div id="summarizing-cross-validation-results" class="section level1">
<h1>Summarizing cross validation results</h1>
<pre class="r"><code>titanic_rs_metrics_dt %&gt;%
  group_by(.metric) %&gt;%
  summarize(min= min(.estimate),
            median = median(.estimate),
            max = max(.estimate),
            sd = sd(.estimate))</code></pre>
<pre><code>##         min    median       max         sd
## 1 0.5757576 0.8101266 0.9782609 0.09569488</code></pre>
</div>
<div id="hyper-parameter-tuning" class="section level1">
<h1>Hyper parameter tuning</h1>
<pre class="r"><code>titanic_dt_tune_model &lt;- decision_tree(cost_complexity = tune(), tree_depth = tune(), min_n = tune()) %&gt;%
  set_engine(&#39;rpart&#39;) %&gt;%
  set_mode(&#39;classification&#39;)
titanic_dt_tune_model</code></pre>
<pre><code>## Decision Tree Model Specification (classification)
## 
## Main Arguments:
##   cost_complexity = tune()
##   tree_depth = tune()
##   min_n = tune()
## 
## Computational engine: rpart</code></pre>
</div>
<div id="creating-tuning-workflow" class="section level1">
<h1>Creating tuning workflow</h1>
<pre class="r"><code>titanic_tune_wkfl &lt;- titanic_wkfl_dt %&gt;%
  update_model(titanic_dt_tune_model)
titanic_tune_wkfl</code></pre>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: decision_tree()
## 
## -- Preprocessor ----------------------------------------------------------------
## 3 Recipe Steps
## 
## * step_corr()
## * step_normalize()
## * step_dummy()
## 
## -- Model -----------------------------------------------------------------------
## Decision Tree Model Specification (classification)
## 
## Main Arguments:
##   cost_complexity = tune()
##   tree_depth = tune()
##   min_n = tune()
## 
## Computational engine: rpart</code></pre>
</div>
<div id="identifying-hyperparameters" class="section level1">
<h1>Identifying hyperparameters</h1>
<pre class="r"><code>parameters(titanic_dt_tune_model)</code></pre>
<pre><code>## Collection of 3 parameters for tuning
## 
##       identifier            type    object
##  cost_complexity cost_complexity nparam[+]
##       tree_depth      tree_depth nparam[+]
##            min_n           min_n nparam[+]</code></pre>
</div>
<div id="generating-random-grid" class="section level1">
<h1>Generating random grid</h1>
<pre class="r"><code>set.seed(224)
titanic_dt_grid &lt;- grid_random(parameters(titanic_dt_tune_model), size = 5)
titanic_dt_grid</code></pre>
<pre><code>## # A tibble: 5 x 3
##   cost_complexity tree_depth min_n
##             &lt;dbl&gt;      &lt;int&gt; &lt;int&gt;
## 1     0.000608             8    23
## 2     0.0000191            1     7
## 3     0.000000289          7    22
## 4     0.0343              15    22
## 5     0.0000747           12     8</code></pre>
</div>
<div id="hyperparameter-tuning-with-cross-validation" class="section level1">
<h1>Hyperparameter tuning with cross validation</h1>
<pre class="r"><code>titanic_dt_tuning &lt;- titanic_tune_wkfl %&gt;%
  tune_grid(resamples= titanic_folds_dt, grid = titanic_dt_grid, metrics = titanic_metrics_dt)
titanic_dt_tuning</code></pre>
<pre><code>## # Tuning results
## # 10-fold cross-validation using stratification 
## # A tibble: 10 x 4
##    splits           id     .metrics          .notes          
##    &lt;list&gt;           &lt;chr&gt;  &lt;list&gt;            &lt;list&gt;          
##  1 &lt;split [711/80]&gt; Fold01 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  2 &lt;split [712/79]&gt; Fold02 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  3 &lt;split [712/79]&gt; Fold03 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  4 &lt;split [712/79]&gt; Fold04 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  5 &lt;split [712/79]&gt; Fold05 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  6 &lt;split [712/79]&gt; Fold06 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  7 &lt;split [712/79]&gt; Fold07 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  8 &lt;split [712/79]&gt; Fold08 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
##  9 &lt;split [712/79]&gt; Fold09 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;
## 10 &lt;split [712/79]&gt; Fold10 &lt;tibble [20 x 7]&gt; &lt;tibble [0 x 1]&gt;</code></pre>
</div>
<div id="exploring-tuning-results" class="section level1">
<h1>Exploring tuning results</h1>
<pre class="r"><code>titanic_dt_tuning %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 20 x 9
##    cost_complexity tree_depth min_n .metric  .estimator  mean     n std_err
##              &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
##  1     0.000608             8    23 accuracy binary     0.791    10  0.0129
##  2     0.000608             8    23 roc_auc  binary     0.864    10  0.0144
##  3     0.000608             8    23 sens     binary     0.841    10  0.0195
##  4     0.000608             8    23 spec     binary     0.722    10  0.0190
##  5     0.0000191            1     7 accuracy binary     0.794    10  0.0151
##  6     0.0000191            1     7 roc_auc  binary     0.781    10  0.0143
##  7     0.0000191            1     7 sens     binary     0.861    10  0.0225
##  8     0.0000191            1     7 spec     binary     0.701    10  0.0174
##  9     0.000000289          7    22 accuracy binary     0.795    10  0.0116
## 10     0.000000289          7    22 roc_auc  binary     0.853    10  0.0164
## 11     0.000000289          7    22 sens     binary     0.867    10  0.0179
## 12     0.000000289          7    22 spec     binary     0.695    10  0.0208
## 13     0.0343              15    22 accuracy binary     0.812    10  0.0147
## 14     0.0343              15    22 roc_auc  binary     0.802    10  0.0144
## 15     0.0343              15    22 sens     binary     0.85     10  0.0204
## 16     0.0343              15    22 spec     binary     0.758    10  0.0183
## 17     0.0000747           12     8 accuracy binary     0.780    10  0.0173
## 18     0.0000747           12     8 roc_auc  binary     0.836    10  0.0145
## 19     0.0000747           12     8 sens     binary     0.824    10  0.0179
## 20     0.0000747           12     8 spec     binary     0.719    10  0.0266
## # ... with 1 more variable: .config &lt;chr&gt;</code></pre>
</div>
<div id="detailed-tuning-results" class="section level1">
<h1>Detailed tuning results</h1>
<pre class="r"><code>titanic_dt_tuning %&gt;%
  collect_metrics(summarize = FALSE)</code></pre>
<pre><code>## # A tibble: 200 x 8
##    id     cost_complexity tree_depth min_n .metric  .estimator .estimate .config
##    &lt;chr&gt;            &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;  
##  1 Fold01        0.000608          8    23 sens     binary         0.804 Prepro~
##  2 Fold01        0.000608          8    23 spec     binary         0.706 Prepro~
##  3 Fold01        0.000608          8    23 accuracy binary         0.762 Prepro~
##  4 Fold01        0.000608          8    23 roc_auc  binary         0.845 Prepro~
##  5 Fold02        0.000608          8    23 sens     binary         0.957 Prepro~
##  6 Fold02        0.000608          8    23 spec     binary         0.788 Prepro~
##  7 Fold02        0.000608          8    23 accuracy binary         0.886 Prepro~
##  8 Fold02        0.000608          8    23 roc_auc  binary         0.926 Prepro~
##  9 Fold03        0.000608          8    23 sens     binary         0.848 Prepro~
## 10 Fold03        0.000608          8    23 spec     binary         0.667 Prepro~
## # ... with 190 more rows</code></pre>
</div>
<div id="exploring-tuning-results-1" class="section level1">
<h1>Exploring tuning results</h1>
<pre class="r"><code>titanic_dt_tuning %&gt;%
  collect_metrics(summarize = FALSE) %&gt;%
  filter(.metric == &#39;roc_auc&#39;) %&gt;%
  group_by (id) %&gt;%
  summarize( min_roc_auc = min(.estimate),
             median_roc_auc = median(.estimate),
             max_roc_auc = max(.estimate))</code></pre>
<pre><code>##   min_roc_auc median_roc_auc max_roc_auc
## 1   0.7039642       0.823946   0.9321476</code></pre>
</div>
<div id="viewing-the-best-performing-model" class="section level1">
<h1>Viewing the best performing model</h1>
<pre class="r"><code>titanic_dt_tuning %&gt;%
  show_best(metric = &#39;roc_auc&#39;, n =5)</code></pre>
<pre><code>## # A tibble: 5 x 9
##   cost_complexity tree_depth min_n .metric .estimator  mean     n std_err
##             &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt;
## 1     0.000608             8    23 roc_auc binary     0.864    10  0.0144
## 2     0.000000289          7    22 roc_auc binary     0.853    10  0.0164
## 3     0.0000747           12     8 roc_auc binary     0.836    10  0.0145
## 4     0.0343              15    22 roc_auc binary     0.802    10  0.0144
## 5     0.0000191            1     7 roc_auc binary     0.781    10  0.0143
## # ... with 1 more variable: .config &lt;chr&gt;</code></pre>
<p>Model 1 is the best model
# Selecting the best model</p>
<pre class="r"><code>titanic_best_dt_model &lt;- titanic_dt_tuning %&gt;%
  select_best(metric = &#39;roc_auc&#39;)
titanic_best_dt_model </code></pre>
<pre><code>## # A tibble: 1 x 4
##   cost_complexity tree_depth min_n .config             
##             &lt;dbl&gt;      &lt;int&gt; &lt;int&gt; &lt;chr&gt;               
## 1        0.000608          8    23 Preprocessor1_Model1</code></pre>
<p>The model 1 are best performing model and hyper parameter values</p>
</div>
<div id="finalizing-the-workflow" class="section level1">
<h1>Finalizing the workflow</h1>
<pre class="r"><code>final_titanic_wkfl_dt &lt;- titanic_tune_wkfl %&gt;%
  finalize_workflow(titanic_best_dt_model)
final_titanic_wkfl_dt</code></pre>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: decision_tree()
## 
## -- Preprocessor ----------------------------------------------------------------
## 3 Recipe Steps
## 
## * step_corr()
## * step_normalize()
## * step_dummy()
## 
## -- Model -----------------------------------------------------------------------
## Decision Tree Model Specification (classification)
## 
## Main Arguments:
##   cost_complexity = 0.000608424596386352
##   tree_depth = 8
##   min_n = 23
## 
## Computational engine: rpart</code></pre>
</div>
<div id="model-fitting" class="section level1">
<h1>Model fitting</h1>
<pre class="r"><code>titanic_final_fit_dt &lt;- final_titanic_wkfl_dt %&gt;%
  last_fit(split = titanic_split)
titanic_final_fit_dt %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 2 x 4
##   .metric  .estimator .estimate .config             
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary         0.773 Preprocessor1_Model1
## 2 roc_auc  binary         0.801 Preprocessor1_Model1</code></pre>
<p>We can see that there is some improvement compared to what we got from without tuning model</p>
</div>
