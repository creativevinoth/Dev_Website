---
title: Bank
author: ''
date: '2021-10-30'
slug: Bank
categories: []
tags: []
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<p>The report of logistic regression on bank data set to answer if customer will subscribe term deposit or not</p>
<div id="table-of-contents" class="section level2">
<h2>Table of contents</h2>
<p>Executive summary</p>
<p>Issues and Challanges</p>
<p>Univariate analysis on metric and nonmetric data</p>
<p>Bivariate analysis</p>
<p>Logistic regression using tidymodels</p>
<p>Workflow and model creation</p>
<p>Manual logistic regression</p>
<p>Observation and comments</p>
<p>References</p>
</div>
<div id="executive-sumamry" class="section level2">
<h2>Executive sumamry</h2>
<p>The portuguese banking institution has a product term deposit. The data was collected in a direct marketing campaign based on phone calls. They would like to know if the customers would subscribe to the term deposit or not. The age, balance, day, duration, campaign, pdays and previous are numerical data. The job, marital, education, contact, poutcome are nominal categorical values.I consider the following variables as binary categorical values such as default, housing, loan, y and assigned o and 1. Y is the outcome and response variable. I consider month as a ordinal categorical value and i assign sequential numbers from 1 to 12 respective to a month.</p>
<p>Initially, univariate analysis was performed to remove the outliers. Boxplot was graphed to find out the outliers. Bivariate analysis was performed to find out if there is any correlation between dependant and independant variable and find out the equation is significant or not. Using tidymodels, feature engineering was used to preprocess data and then used logistic regressing to fit the model and cross validation was done and used confusion matrix to validate the results. Then I used workflow model to automate and use the model for new data set. I have also done manual logistic regression model.</p>
<p>It was clear that customers will not subscribe for the term deposit. The bank has to take some steps whereby stimulate the customers such as increasing rate of interest or offering some better additional offers like providing a health insurance free for term deposit of some amount.</p>
</div>
<div id="issues-and-challanges" class="section level1">
<h1>Issues and challanges</h1>
<p>The greatest challange for the bank is to find out which all variables to be considered to arrive at an outcome that if customers will subscribe to term deposit or not. There are some categorical variables, for twhich dummy values to be assigned. There are some binary categorical values and binary to be assigned and there is some ordianal categorical values, those can be considered as a numerical values by assigning a sequential values to it. After identifying the factors which influence most for sunscribing to the term deposit, marketing efforts should be directed towards the same to rope in more term deposit.</p>
</div>
<div id="structure-of-the-data-set" class="section level1">
<h1>Structure of the data set</h1>
<pre class="r"><code>str(bank)</code></pre>
<pre><code>## &#39;data.frame&#39;:    4521 obs. of  17 variables:
##  $ age      : int  30 33 35 30 59 35 36 39 41 43 ...
##  $ job      : chr  &quot;unemployed&quot; &quot;services&quot; &quot;management&quot; &quot;management&quot; ...
##  $ marital  : chr  &quot;married&quot; &quot;married&quot; &quot;single&quot; &quot;married&quot; ...
##  $ education: chr  &quot;primary&quot; &quot;secondary&quot; &quot;tertiary&quot; &quot;tertiary&quot; ...
##  $ default  : chr  &quot;no&quot; &quot;no&quot; &quot;no&quot; &quot;no&quot; ...
##  $ balance  : int  1787 4789 1350 1476 0 747 307 147 221 -88 ...
##  $ housing  : chr  &quot;no&quot; &quot;yes&quot; &quot;yes&quot; &quot;yes&quot; ...
##  $ loan     : chr  &quot;no&quot; &quot;yes&quot; &quot;no&quot; &quot;yes&quot; ...
##  $ contact  : chr  &quot;cellular&quot; &quot;cellular&quot; &quot;cellular&quot; &quot;unknown&quot; ...
##  $ day      : int  19 11 16 3 5 23 14 6 14 17 ...
##  $ month    : chr  &quot;oct&quot; &quot;may&quot; &quot;apr&quot; &quot;jun&quot; ...
##  $ duration : int  79 220 185 199 226 141 341 151 57 313 ...
##  $ campaign : int  1 1 1 4 1 2 1 2 2 1 ...
##  $ pdays    : int  -1 339 330 -1 -1 176 330 -1 -1 147 ...
##  $ previous : int  0 4 1 0 0 3 2 0 0 2 ...
##  $ poutcome : chr  &quot;unknown&quot; &quot;failure&quot; &quot;failure&quot; &quot;unknown&quot; ...
##  $ y        : chr  &quot;no&quot; &quot;no&quot; &quot;no&quot; &quot;no&quot; ...</code></pre>
</div>
<div id="descriptive-statistics-of-numerical-independent-values" class="section level1">
<h1>Descriptive statistics of numerical independent values</h1>
<pre class="r"><code>descr(bank)</code></pre>
<pre><code>## Non-numerical variable(s) ignored: job, marital, education, default, housing, loan, contact, month, poutcome, y</code></pre>
<pre><code>## Descriptive Statistics  
## bank  
## N: 4521  
## 
##                         age    balance   campaign       day   duration     pdays   previous
## ----------------- --------- ---------- ---------- --------- ---------- --------- ----------
##              Mean     41.17    1422.66       2.79     15.92     263.96     39.77       0.54
##           Std.Dev     10.58    3009.64       3.11      8.25     259.86    100.12       1.69
##               Min     19.00   -3313.00       1.00      1.00       4.00     -1.00       0.00
##                Q1     33.00      69.00       1.00      9.00     104.00     -1.00       0.00
##            Median     39.00     444.00       2.00     16.00     185.00     -1.00       0.00
##                Q3     49.00    1480.00       3.00     21.00     329.00     -1.00       0.00
##               Max     87.00   71188.00      50.00     31.00    3025.00    871.00      25.00
##               MAD     10.38     658.27       1.48     10.38     143.81      0.00       0.00
##               IQR     16.00    1411.00       2.00     12.00     225.00      0.00       0.00
##                CV      0.26       2.12       1.11      0.52       0.98      2.52       3.12
##          Skewness      0.70       6.59       4.74      0.09       2.77      2.72       5.87
##       SE.Skewness      0.04       0.04       0.04      0.04       0.04      0.04       0.04
##          Kurtosis      0.35      88.25      37.11     -1.04      12.51      7.94      51.91
##           N.Valid   4521.00    4521.00    4521.00   4521.00    4521.00   4521.00    4521.00
##         Pct.Valid    100.00     100.00     100.00    100.00     100.00    100.00     100.00</code></pre>
</div>
<div id="summary-of-dataset" class="section level1">
<h1>Summary of dataset</h1>
<pre class="r"><code>summary(bank)</code></pre>
<pre><code>##       age            job              marital           education        
##  Min.   :19.00   Length:4521        Length:4521        Length:4521       
##  1st Qu.:33.00   Class :character   Class :character   Class :character  
##  Median :39.00   Mode  :character   Mode  :character   Mode  :character  
##  Mean   :41.17                                                           
##  3rd Qu.:49.00                                                           
##  Max.   :87.00                                                           
##    default             balance        housing              loan          
##  Length:4521        Min.   :-3313   Length:4521        Length:4521       
##  Class :character   1st Qu.:   69   Class :character   Class :character  
##  Mode  :character   Median :  444   Mode  :character   Mode  :character  
##                     Mean   : 1423                                        
##                     3rd Qu.: 1480                                        
##                     Max.   :71188                                        
##    contact               day           month              duration   
##  Length:4521        Min.   : 1.00   Length:4521        Min.   :   4  
##  Class :character   1st Qu.: 9.00   Class :character   1st Qu.: 104  
##  Mode  :character   Median :16.00   Mode  :character   Median : 185  
##                     Mean   :15.92                      Mean   : 264  
##                     3rd Qu.:21.00                      3rd Qu.: 329  
##                     Max.   :31.00                      Max.   :3025  
##     campaign          pdays           previous         poutcome        
##  Min.   : 1.000   Min.   : -1.00   Min.   : 0.0000   Length:4521       
##  1st Qu.: 1.000   1st Qu.: -1.00   1st Qu.: 0.0000   Class :character  
##  Median : 2.000   Median : -1.00   Median : 0.0000   Mode  :character  
##  Mean   : 2.794   Mean   : 39.77   Mean   : 0.5426                     
##  3rd Qu.: 3.000   3rd Qu.: -1.00   3rd Qu.: 0.0000                     
##  Max.   :50.000   Max.   :871.00   Max.   :25.0000                     
##       y            
##  Length:4521       
##  Class :character  
##  Mode  :character  
##                    
##                    
## </code></pre>
</div>
<div id="data-table-of-data-set" class="section level1">
<h1>Data table of data set</h1>
<pre class="r"><code>data.table(bank)</code></pre>
<pre><code>##       age           job marital education default balance housing loan  contact
##    1:  30    unemployed married   primary      no    1787      no   no cellular
##    2:  33      services married secondary      no    4789     yes  yes cellular
##    3:  35    management  single  tertiary      no    1350     yes   no cellular
##    4:  30    management married  tertiary      no    1476     yes  yes  unknown
##    5:  59   blue-collar married secondary      no       0     yes   no  unknown
##   ---                                                                          
## 4517:  33      services married secondary      no    -333     yes   no cellular
## 4518:  57 self-employed married  tertiary     yes   -3313     yes  yes  unknown
## 4519:  57    technician married secondary      no     295      no   no cellular
## 4520:  28   blue-collar married secondary      no    1137      no   no cellular
## 4521:  44  entrepreneur  single  tertiary      no    1136     yes  yes cellular
##       day month duration campaign pdays previous poutcome  y
##    1:  19   oct       79        1    -1        0  unknown no
##    2:  11   may      220        1   339        4  failure no
##    3:  16   apr      185        1   330        1  failure no
##    4:   3   jun      199        4    -1        0  unknown no
##    5:   5   may      226        1    -1        0  unknown no
##   ---                                                       
## 4517:  30   jul      329        5    -1        0  unknown no
## 4518:   9   may      153        1    -1        0  unknown no
## 4519:  19   aug      151       11    -1        0  unknown no
## 4520:   6   feb      129        4   211        3    other no
## 4521:   3   apr      345        2   249        7    other no</code></pre>
<div id="univariate-analysis-on-numerical-data" class="section level2">
<h2>Univariate analysis on numerical data</h2>
</div>
</div>
<div id="univariate-analysis-on-age" class="section level1">
<h1>Univariate analysis on age</h1>
<pre class="r"><code>descr(bank$age)</code></pre>
<pre><code>## Descriptive Statistics  
## bank$age  
## N: 4521  
## 
##                         age
## ----------------- ---------
##              Mean     41.17
##           Std.Dev     10.58
##               Min     19.00
##                Q1     33.00
##            Median     39.00
##                Q3     49.00
##               Max     87.00
##               MAD     10.38
##               IQR     16.00
##                CV      0.26
##          Skewness      0.70
##       SE.Skewness      0.04
##          Kurtosis      0.35
##           N.Valid   4521.00
##         Pct.Valid    100.00</code></pre>
<p>The minimum age of the customer is 19 and maximum age is 87. There is a standard deviation of 10.58, which is high in numbers. Let me dwar a box plot to find out the outliers so that data can be streamlined and standard deviation can be reduced</p>
</div>
<div id="box-plot-of-age-and-its-outliers" class="section level1">
<h1>Box plot of age and its outliers</h1>
<pre class="r"><code>age_outliers&lt;-boxplot.stats(bank$age)$out
boxplot(bank$age, main = &quot;Box plot of age&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(age_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code>age_outliers</code></pre>
<pre><code>##  [1] 78 77 78 75 75 77 81 83 80 77 75 80 83 75 79 77 86 78 77 74 80 74 80 80 75
## [26] 76 79 77 87 79 76 80 79 74 75 84 83 83</code></pre>
<p>We can see the outliers of the age lie between 74 and 87.</p>
</div>
<div id="minimum-value-of-age-outliers" class="section level1">
<h1>Minimum value of age outliers</h1>
<pre class="r"><code>min(age_outliers)</code></pre>
<pre><code>## [1] 74</code></pre>
</div>
<div id="maximum-value-of-age-outliers" class="section level1">
<h1>Maximum value of age outliers</h1>
<pre class="r"><code>max(age_outliers)</code></pre>
<pre><code>## [1] 87</code></pre>
<p>I used subset function to add the age less than 74 so that outliers can be removed</p>
<pre class="r"><code>bank&lt;- subset(bank, age &lt; 74)</code></pre>
</div>
<div id="boxplot-of-age-after-removal-of-outliers" class="section level1">
<h1>Boxplot of age after removal of outliers</h1>
<pre class="r"><code>age_withoutoutliers&lt;-boxplot.stats(bank$age)$out
boxplot(bank$age, main = &quot;Box plot of age after reomval of outliers&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(age_withoutoutliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>age_withoutoutliers</code></pre>
<pre><code>##  [1] 71 72 73 71 73 73 72 73 71 73 72 71 71 72 71 73</code></pre>
</div>
<div id="univariate-analysis-on-balance" class="section level1">
<h1>Univariate analysis on balance</h1>
<pre class="r"><code>descr(bank$balance)</code></pre>
<pre><code>## Descriptive Statistics  
## bank$balance  
## N: 4483  
## 
##                      balance
## ----------------- ----------
##              Mean    1409.82
##           Std.Dev    2987.98
##               Min   -3313.00
##                Q1      67.00
##            Median     440.00
##                Q3    1469.00
##               Max   71188.00
##               MAD     652.34
##               IQR    1401.00
##                CV       2.12
##          Skewness       6.66
##       SE.Skewness       0.04
##          Kurtosis      90.71
##           N.Valid    4483.00
##         Pct.Valid     100.00</code></pre>
<p>The minimum balance of the customer is -3313, which is a negative balance because of non maintenance charges or some other charges. The maximum balance is 71188. The standard deviation is 2987 and median is 440.</p>
</div>
<div id="box-plot-of-balance-and-its-outliers" class="section level1">
<h1>Box plot of balance and its outliers</h1>
<pre class="r"><code>balance_outliers&lt;-boxplot.stats(bank$balance)$out
boxplot(bank$balance, main = &quot;Box plot of balance&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(balance_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-14-1.png" width="672" /></p>
<pre class="r"><code>balance_outliers</code></pre>
<pre><code>##   [1]  4789  9374  4073  5883  4189  3935 11971  4629  5887 16873  6248  3616
##  [13] 14093  5426  5996  3777  4111  6313  8104  4590  9009  5181  6979  9216
##  [25]  5563  9149 11494  4030  3571  3576  7082  4012  3762  7190  5803 12186
##  [37] 11219  5776  4108  4994  3681  4531  4286  8545  6699 10924  3950  4099
##  [49]  5450  8436 11262  7290  3705  9676  6613  6101  7685  4515  4380  3825
##  [61]  4303  4508  5462 10378  8969  4608  7317  4943 12607  3872  5207  5799
##  [73]  3696 12437 11269 11555  3611 12519  7050  3704  6619  9449  8023  6269
##  [85] 23663  4063 11084  3706  4153  7708  6000  8894 14752 15311 10786  4020
##  [97]  3924  4348 13669  7066  4798  4366  4900  8167  3671 26965 15030 11303
## [109] 19358  9269  5291 10287  5235  4040 16353  7353  3913  6102  3575  8312
## [121]  5920  3723  6411  3873  5436  3913 10758  8494  5346 25824  9720  3904
## [133]  8262  7108  5278  7289  3897  5110  4820  4937  5403  4089  4567  3875
## [145]  5957  5514  4579  5106  4415  5173  6016  3694 10177 15459  4902  4229
## [157]  5050  4667  7744  5037  5845  5673  5801  9121  4170  4424  9019  4012
## [169]  7343 13494  4665  3748  3696  4103  7546  8647 27733  6421  5060  3945
## [181]  3638  3992  4760  6145  3990  7727  7702  5639  3672  6217 14533  4684
## [193]  8004  8139  4968  4761  5958  3732  4415  3672  4565  7124 17555  5172
## [205] 15520 13711 15834  6290  4075  4958 21244  4374  7179  8295  4143 10788
## [217]  4143  4157 27359 18347  7813  7195  3921  4785  4657  4365  4404  6046
## [229]  6217  7138  4758  4787  7876  7010  5137 13044  3859  4198  4760  4335
## [241]  9339  6922  4265  4659  4897  3726  3727  4089  8883 26306  3823  4343
## [253]  6766  3973  7696  4500  3782  5780 16430  5195 13342  6570  8238  6402
## [265] 16992  6072 -2082  5498  5063  7041  3927 11386  4232  5564  3636  4007
## [277]  5355  9976  4425  3573  8106  7513  5116  4148  7378  4541  4287  4895
## [289]  5543  5191 22370  5366  4906  3672  4945  3733 11417  4213  9756  9851
## [301]  5095  8309  8627  6095 22856  5314  5731  6307  7864  5715  3665  3931
## [313]  6728  9305  8627  9228 12223  7007  4446 13658 10218  7635 12531 14220
## [325] 12569  3587  4855 42045  3940  3735 26394 16957  4809  8044  4610  4030
## [337]  4646  3948  8515  9146  6164  4745 11797  4015  5086  4824  6968  6904
## [349] 13229  5739  5310 22171  3797  4438  5045 21664  5878 16264  9207  4256
## [361]  3953 13204 22546  8131 10787  6839  4664  4908  8669  9324  7735  5320
## [373]  4885  5462  6767  8876  6164  5039  5092  4280  5706  7780 16874  6483
## [385]  4209 14363  3620  6495  5774 19317  3726  6610  6704  4543  3576  4994
## [397] 16178 13893  4194  5969  5533  4022  4094  4539  5244 71188  5108  6649
## [409]  4384  4130  3975  7495 22196  5731  7020  3658  5549 27069  8038  3663
## [421]  5122  4503  4848 13683  4402  4722  3706  3809 14440  7944  5306  3676
## [433]  8902  7337  5092 10655  6836  5527 17361 21515  5902  3800  9328  3601
## [445] 14412  4441  3972  9374  6900  4086  4831  3940  4382  3939  8023  6844
## [457] 10907  6637  3792 14058  5057  4717  4039  8218  6563  5980  5597  8652
## [469]  6850  3608  8366 20453 19447 10888 13156  4210 16063  5431  4787  3854
## [481]  3653  4795 10910  7929  4945  7845  3935  4888  4460 13117 12877  6880
## [493]  5304  3953  6969  4554  4790  6945  4196 -3313</code></pre>
<p>We can see more outliers in balance. The outliers ranges between -3313 and 0 and between 267 and 71188</p>
</div>
<div id="minimum-negative-value-of-balance-outlier" class="section level1">
<h1>Minimum negative value of balance outlier</h1>
<pre class="r"><code>min(balance_outliers)</code></pre>
<pre><code>## [1] -3313</code></pre>
</div>
<div id="minimum-positive-value-of-balance-outlier" class="section level1">
<h1>Minimum positive value of balance outlier</h1>
<pre class="r"><code>which.min(balance_outliers&gt;0)</code></pre>
<pre><code>## [1] 267</code></pre>
</div>
<div id="maximum-value-of-balance-outlier" class="section level1">
<h1>Maximum value of balance outlier</h1>
<pre class="r"><code>max(balance_outliers)</code></pre>
<pre><code>## [1] 71188</code></pre>
<p>The outliers are removed by choosing the value between 0 and 273</p>
<pre class="r"><code>bank&lt;- subset(bank, balance &gt; 0 &amp; balance &lt; 273)</code></pre>
</div>
<div id="boxplot-of-balance-after-removal-of-outliers" class="section level1">
<h1>Boxplot of balance after removal of outliers</h1>
<pre class="r"><code>balance_withoutoutliers&lt;-boxplot.stats(bank$balance)$out
boxplot(bank$balance, main = &quot;Box plot of balance after removal of outliers&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(balance_withoutoutliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<pre class="r"><code>balance_withoutoutliers</code></pre>
<pre><code>## integer(0)</code></pre>
</div>
<div id="unvariate-analysis-on-day" class="section level1">
<h1>Unvariate analysis on day</h1>
<pre class="r"><code>descr(bank$day)</code></pre>
<pre><code>## Descriptive Statistics  
## bank$day  
## N: 1103  
## 
##                         day
## ----------------- ---------
##              Mean     15.69
##           Std.Dev      8.41
##               Min      1.00
##                Q1      8.00
##            Median     16.00
##                Q3     22.00
##               Max     31.00
##               MAD     10.38
##               IQR     14.00
##                CV      0.54
##          Skewness      0.15
##       SE.Skewness      0.07
##          Kurtosis     -1.12
##           N.Valid   1103.00
##         Pct.Valid    100.00</code></pre>
<p>The minimum contact day is 1 and maximum is 31. There is a standard deviation of 8.41</p>
</div>
<div id="boxplot-of-day-after-removal-of-outliers" class="section level1">
<h1>Boxplot of day after removal of outliers</h1>
<pre class="r"><code>day_outliers&lt;-boxplot.stats(bank$day)$out
boxplot(bank$day, main = &quot;Box plot of day&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(day_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<pre class="r"><code>day_outliers</code></pre>
<pre><code>## integer(0)</code></pre>
<p>There are no outliers in day</p>
</div>
<div id="univariate-analysis-on-duration" class="section level1">
<h1>Univariate analysis on duration</h1>
<pre class="r"><code>descr(bank$duration)</code></pre>
<pre><code>## Descriptive Statistics  
## bank$duration  
## N: 1103  
## 
##                     duration
## ----------------- ----------
##              Mean     238.88
##           Std.Dev     234.81
##               Min       5.00
##                Q1      96.00
##            Median     171.00
##                Q3     297.00
##               Max    2456.00
##               MAD     131.95
##               IQR     199.00
##                CV       0.98
##          Skewness       2.94
##       SE.Skewness       0.07
##          Kurtosis      14.12
##           N.Valid    1103.00
##         Pct.Valid     100.00</code></pre>
<p>The minimum contact duration was 5 seconds and maximum duration was 2456 seconds. There is a standard deviation of 234.81 seconds</p>
</div>
<div id="box-plot-of-duration-and-its-outliers" class="section level1">
<h1>Box plot of duration and its outliers</h1>
<pre class="r"><code>duration_outliers&lt;-boxplot.stats(bank$duration)$out
boxplot(bank$duration, main = &quot;Box plot of duration&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(duration_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<pre class="r"><code>duration_outliers</code></pre>
<pre><code>##  [1] 1740  676  644  783  799 1017  597 1735  792  668 1031  614  676  717 1028
## [16]  650  684  686  653  611  796 1126  635  753 1275  808  923  762  657 1309
## [31]  908 1386  955 1164  606  635 1689  732  956  836  632  701  699  672  652
## [46]  612  924 1467  990  646  998  747  650  622  836 1124  978  720 1117 1223
## [61] 1101  744  631  650  634  764  731  821  742 2456  723  688  857  921  627
## [76]  984  866  697 1151  873  599</code></pre>
<p>There are some outliers in duration, ranging between 597 and 2456 seconds</p>
</div>
<div id="minimum-value-of-duration-outlier" class="section level1">
<h1>Minimum value of duration outlier</h1>
<pre class="r"><code>min(duration_outliers)</code></pre>
<pre><code>## [1] 597</code></pre>
</div>
<div id="maximum-value-of-duration-outlier" class="section level1">
<h1>Maximum value of duration outlier</h1>
<pre class="r"><code>max(duration_outliers)</code></pre>
<pre><code>## [1] 2456</code></pre>
<p>The outliers are removed greater then 597 using subset</p>
<pre class="r"><code>bank&lt;- subset(bank, duration &lt; 597)</code></pre>
</div>
<div id="boxplot-of-duration-after-removal-of-outliers" class="section level1">
<h1>Boxplot of duration after removal of outliers</h1>
<pre class="r"><code>duration_withoutoutliers&lt;-boxplot.stats(bank$duration)$out
boxplot(bank$duration, main = &quot;Box plot of duration after outliers are removed&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(duration_withoutoutliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<pre class="r"><code>duration_withoutoutliers</code></pre>
<pre><code>##  [1] 564 588 543 587 523 568 524 503 580 590 543 574 550 577 543 546 563 505 509
## [20] 501 528 587 582 527 544 570 528 501 517 587 529 549 508</code></pre>
</div>
<div id="univariate-analysis-on-campaign" class="section level1">
<h1>UNivariate analysis on campaign</h1>
<pre class="r"><code>descr(bank$campaign)</code></pre>
<pre><code>## Descriptive Statistics  
## bank$campaign  
## N: 1022  
## 
##                     campaign
## ----------------- ----------
##              Mean       2.79
##           Std.Dev       2.88
##               Min       1.00
##                Q1       1.00
##            Median       2.00
##                Q3       3.00
##               Max      31.00
##               MAD       1.48
##               IQR       2.00
##                CV       1.03
##          Skewness       3.63
##       SE.Skewness       0.08
##          Kurtosis      19.62
##           N.Valid    1022.00
##         Pct.Valid     100.00</code></pre>
</div>
<div id="box-plot-of-campaign" class="section level1">
<h1>Box plot of Campaign</h1>
<pre class="r"><code>campaign_outliers&lt;-boxplot.stats(bank$campaign)$out
boxplot(bank$campaign, main = &quot;Box plot of campaign&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(campaign_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-29-1.png" width="672" /></p>
<pre class="r"><code>campaign_outliers</code></pre>
<pre><code>##  [1] 12  7  7 10  9  7  8 10  8 22 11  9 12  7 11 11 11 11 13 11  8 12  7  8 11
## [26]  7  8  7 17 19  7 24  8  9  9  7  8 17 20  9  9 12 10  9  9  8 11 11  7 13
## [51]  7 11 18 15  8 10 11  9  8 31  8 19 17  7  7 12  7  8  7  7  8  7  9 12 10
## [76]  7 15  9</code></pre>
<p>There are many outliers in campaign ranging between 7 and 31</p>
</div>
<div id="minimum-of-campaign-outliers" class="section level1">
<h1>Minimum of campaign outliers</h1>
<pre class="r"><code>min(campaign_outliers)</code></pre>
<pre><code>## [1] 7</code></pre>
</div>
<div id="maximum-of-campaign-outliers" class="section level1">
<h1>Maximum of campaign outliers</h1>
<pre class="r"><code>max(campaign_outliers)</code></pre>
<pre><code>## [1] 31</code></pre>
<p>The outliers are removed and data are taken less than 7</p>
<pre class="r"><code>bank&lt;- subset(bank, campaign &lt; 7)</code></pre>
</div>
<div id="box-plot-of-campaign-after-removal-of-outliers" class="section level1">
<h1>Box plot of campaign after removal of outliers</h1>
<pre class="r"><code>campaign_withoutoutliers&lt;-boxplot.stats(bank$campaign)$out
boxplot(bank$campaign, main = &quot;Box plot of campaign after removal of outliers&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(campaign_withoutoutliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-33-1.png" width="672" /></p>
<pre class="r"><code>campaign_withoutoutliers</code></pre>
<pre><code>## integer(0)</code></pre>
</div>
<div id="box-plot-of-pdays" class="section level1">
<h1>Box plot of pdays</h1>
<pre class="r"><code>pdays_outliers&lt;-boxplot.stats(bank$pdays)$out
boxplot(bank$pdays, main = &quot;Box plot of pdays&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(pdays_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<pre class="r"><code>pdays_outliers</code></pre>
<pre><code>##   [1] 152   5 170 297 196 137 207 288 436 347 271 347 351   1 347  96 358 337
##  [19] 102 212  63 247 175 382 147 199  91 342 135 278 140 268 337 271 241  85
##  [37] 349  80 345 371 246 169  69 322 169 273 112 346 808 113 378 107 360 293
##  [55] 138 364 359 363 370 339 356 191 300 280 176 337 362 368  89 183  88 127
##  [73] 365 174 169  84 193  85 461 182  96 183 171 337 342 170 126 273 368 152
##  [91] 173  92 294 167 222 435 340 196  88 244   2 227  92 260 350 266 295 120
## [109] 281 336 169 369 367 315 261 195 231 176 109 368 201 362 335 105 332 360
## [127] 261 352 161 371 367 181 345  85 357 161 148 309 358  85 266 368  78  94
## [145] 340 120  64 106 123 363 347 359 148 256 687 140 363 181 360 167 152 183
## [163] 183 253 184 317 340 299 370 246 315 361</code></pre>
<p>It is surprising to see that whole data are outliers.</p>
</div>
<div id="minimum-of-pdays-outliers" class="section level1">
<h1>Minimum of pdays outliers</h1>
<pre class="r"><code>min(pdays_outliers)</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="maximum-of-pdays-outliers" class="section level1">
<h1>Maximum of pdays outliers</h1>
<pre class="r"><code>max(pdays_outliers)</code></pre>
<pre><code>## [1] 808</code></pre>
<p>The whole coloum pdays is removed from dataset because of outliers high in numbers</p>
<pre class="r"><code>bank&lt;- subset(bank, select = -pdays)</code></pre>
</div>
<div id="box-plot-of-previous" class="section level1">
<h1>Box plot of previous</h1>
<pre class="r"><code>previous_outliers&lt;-boxplot.stats(bank$previous)$out
boxplot(bank$previous, main = &quot;Box plot of previous&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(previous_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<pre class="r"><code>previous_outliers</code></pre>
<pre><code>##   [1]  1  2  5  1  1 20  1  3  1  1  2  1 10  6  1  2  2  3  2  2  5  1  2  1  3
##  [26]  3  1  1  1  2  2  2  2  1  1 19  1  1  2  3  1  2  2  1  2  3  3  2 12  5
##  [51]  3  2  3  5  1  1  1  2  1  7  2  4  5  2  5  1  1  2  1  4  1  4  5 12  1
##  [76]  3  2  5  1  2  2  2  3  1  3  2  4  3  4  1  3  1  1  6  3  1  1  1  4  4
## [101]  3  1  1  4  1  8  1  1  1  2  3  4  2  2  1  1  2  1  4  1  1  5  2  2  1
## [126]  3  5  2  2  3  1  4  1  5  4  9  4  3  2  1  3  2  8  2  2  1  2  2  2  1
## [151]  5  1  1  3  2  1  2 14  1  1  6  4  1  1  7  3  1  3  1  1 11  5</code></pre>
<p>Even the previous data has full outliers on data. Thus, I removed it from the dataset</p>
</div>
<div id="minimum-of-previous-outliers" class="section level1">
<h1>Minimum of previous outliers</h1>
<pre class="r"><code>min(previous_outliers)</code></pre>
<pre><code>## [1] 1</code></pre>
</div>
<div id="maximum-outliers" class="section level1">
<h1>Maximum outliers</h1>
<pre class="r"><code>max(previous_outliers)</code></pre>
<pre><code>## [1] 20</code></pre>
<p>The whole column of previous is removed from the bank dataset due to more outliers</p>
<pre class="r"><code>bank&lt;- subset(bank, select = -previous)</code></pre>
<div id="univariate-analysis-on-categorical-value" class="section level2">
<h2>Univariate analysis on categorical value</h2>
</div>
</div>
<div id="frequency-distribution-of-job" class="section level1">
<h1>Frequency distribution of job</h1>
<pre class="r"><code>tab1(bank$job, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of job&quot;, xlab =&quot;Job&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<pre><code>## bank$job : 
##               Frequency Percent Cum. percent
## unknown               6     0.6          0.6
## student              18     1.9          2.5
## unemployed           19     2.0          4.6
## housemaid            29     3.1          7.6
## retired              36     3.8         11.4
## entrepreneur         48     5.1         16.5
## self-employed        52     5.5         22.0
## services            105    11.1         33.2
## admin.              107    11.3         44.5
## management          157    16.6         61.1
## technician          178    18.9         80.0
## blue-collar         189    20.0        100.0
##   Total             944   100.0        100.0</code></pre>
<p>The frequency distribution of unknown, student, unemployed, housemaid, retired, entrepreneur, self-employed, services, admin are less in numbers. Thus they are are clubbed together as others so as to reduce the number of variables and improve the prediction accuracy</p>
<pre class="r"><code>bank$job&lt;-as.character(bank$job)
bank$job[bank$job %in% c(&quot;unknown&quot;, &quot;student&quot;, &quot;housemaid&quot;, &quot;unemployed&quot;, &quot;entrepreneur&quot;, &quot;self-employed&quot;, &quot;retired&quot;, &quot;services&quot;, &quot;admin.&quot;)]&lt;- &quot;Others&quot;
bank$job&lt;-as.factor(bank$job)</code></pre>
</div>
<div id="the-frequency-distribution-after-clubing-together" class="section level1">
<h1>The frequency distribution after clubing together</h1>
<pre class="r"><code>freq_age_updated &lt;-tab1(bank$job, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of job after merging&quot;, xlab =&quot;Job&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<pre class="r"><code>freq_age_updated</code></pre>
<pre><code>## bank$job : 
##             Frequency Percent Cum. percent
## management        157    16.6         16.6
## technician        178    18.9         35.5
## blue-collar       189    20.0         55.5
## Others            420    44.5        100.0
##   Total           944   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-marital" class="section level1">
<h1>Frequency distribution of marital</h1>
<pre class="r"><code>tab1(bank$marital, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of marital&quot;, xlab =&quot;Marital&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<pre><code>## bank$marital : 
##          Frequency Percent Cum. percent
## divorced       117    12.4         12.4
## single         261    27.6         40.0
## married        566    60.0        100.0
##   Total        944   100.0        100.0</code></pre>
<p>The frequency distribution of all items are greater than 10 percent. So, we are not doing any changes</p>
</div>
<div id="frequency-distribution-of-education" class="section level1">
<h1>frequency distribution of Education</h1>
<pre class="r"><code>tab1(bank$education, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Education&quot;, xlab =&quot;Education&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<pre><code>## bank$education : 
##           Frequency Percent Cum. percent
## unknown          37     3.9          3.9
## primary         152    16.1         20.0
## tertiary        248    26.3         46.3
## secondary       507    53.7        100.0
##   Total         944   100.0        100.0</code></pre>
<p>The frequency distribution of unknown in education is less than5 percent. Thus, they are merged with primary.</p>
<pre class="r"><code>bank$education&lt;-as.character(bank$education)
bank$education[bank$education %in% c(&quot;unknown&quot;, &quot;primary&quot;)]&lt;- &quot;primary and others&quot;
bank$education&lt;-as.factor(bank$education)</code></pre>
</div>
<div id="frequency-distribution-of-education-after-merging" class="section level1">
<h1>Frequency distribution of education after merging</h1>
<pre class="r"><code>freq_education_updated&lt;- tab1(bank$education, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Education after merging&quot;, xlab =&quot;Education&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<pre class="r"><code>freq_education_updated</code></pre>
<pre><code>## bank$education : 
##                    Frequency Percent Cum. percent
## primary and others       189    20.0         20.0
## tertiary                 248    26.3         46.3
## secondary                507    53.7        100.0
##   Total                  944   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-contact" class="section level1">
<h1>Frequency distribution of Contact</h1>
<pre class="r"><code>tab1(bank$contact, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Contact&quot;, xlab =&quot;Contact&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<pre><code>## bank$contact : 
##           Frequency Percent Cum. percent
## telephone        52     5.5          5.5
## unknown         257    27.2         32.7
## cellular        635    67.3        100.0
##   Total         944   100.0        100.0</code></pre>
<p>The frequency of the telephone is only 5.5%, Thus, I add those values with unknowna and renamed it as telephone and others</p>
<pre class="r"><code>bank$contact&lt;-as.character(bank$contact)
bank$contact[bank$contact %in% c(&quot;telephone&quot;, &quot;unknown&quot;)]&lt;- &quot;telephone and others&quot;
bank$contact&lt;-as.factor(bank$contact)</code></pre>
</div>
<div id="frequency-distribution-of-contact-after-merging" class="section level1">
<h1>Frequency distribution of contact after merging</h1>
<pre class="r"><code>freq_contact_updated &lt;- tab1(bank$contact, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Contact after merging&quot;, xlab =&quot;Contact&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<pre class="r"><code>freq_contact_updated</code></pre>
<pre><code>## bank$contact : 
##                      Frequency Percent Cum. percent
## telephone and others       309    32.7         32.7
## cellular                   635    67.3        100.0
##   Total                    944   100.0        100.0</code></pre>
</div>
<div id="frequency-distribution-of-poutcome" class="section level1">
<h1>Frequency distribution of poutcome</h1>
<pre class="r"><code>tab1(bank$poutcome, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of poutcome&quot;, xlab =&quot;poutcome&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<pre><code>## bank$poutcome : 
##         Frequency Percent Cum. percent
## success        20     2.1          2.1
## other          43     4.6          6.7
## failure       109    11.5         18.2
## unknown       772    81.8        100.0
##   Total       944   100.0        100.0</code></pre>
<p>The frequency distribution of success and others are less in percentage. So, I combined both into one category and renamed it as success and others</p>
<pre class="r"><code>bank$poutcome&lt;-as.character(bank$poutcome)
bank$poutcome[bank$poutcome %in% c(&quot;success&quot;, &quot;other&quot;)]&lt;- &quot;success and others&quot;
bank$poutcome&lt;-as.factor(bank$poutcome)</code></pre>
</div>
<div id="frequenct-distribution-of-poutcome-after-merging" class="section level1">
<h1>Frequenct distribution of poutcome after merging</h1>
<pre class="r"><code>freq_poutcome_updated&lt;-tab1(bank$poutcome, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of poutcome after merging&quot;, xlab =&quot;poutcome&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<pre class="r"><code>freq_poutcome_updated</code></pre>
<pre><code>## bank$poutcome : 
##                    Frequency Percent Cum. percent
## success and others        63     6.7          6.7
## failure                  109    11.5         18.2
## unknown                  772    81.8        100.0
##   Total                  944   100.0        100.0</code></pre>
<p>considering the below as a Binary variables and binary numbers o and 1 are assigned</p>
<p>Assigning binary numbers to default</p>
<pre class="r"><code>bank$default[bank$default == &quot;no&quot; ] &lt;-&quot;0&quot;</code></pre>
<pre class="r"><code>bank$default[bank$default == &quot;yes&quot; ] &lt;-&quot;1&quot;</code></pre>
<p>Assigning binary numbers to Housing</p>
<pre class="r"><code>bank$housing[bank$housing == &quot;no&quot; ] &lt;-&quot;0&quot;
bank$housing[bank$housing == &quot;yes&quot; ] &lt;-&quot;1&quot;</code></pre>
<p>Assigning binary numbers to loan</p>
<pre class="r"><code>bank$loan[bank$loan == &quot;no&quot; ] &lt;-&quot;0&quot;
bank$loan[bank$loan == &quot;yes&quot; ] &lt;-&quot;1&quot;</code></pre>
<p>Assigning binary numbers to y</p>
<pre class="r"><code>bank$y[bank$y == &quot;no&quot; ] &lt;-&quot;0&quot;
bank$y[bank$y == &quot;yes&quot; ] &lt;-&quot;1&quot;</code></pre>
<p>COnsidering the month as a ordinal categorical variable, I assign the numbers in a sequantial order</p>
<pre class="r"><code>bank$month[bank$month == &quot;jan&quot; ] &lt;-&quot;1&quot;
bank$month[bank$month == &quot;feb&quot; ] &lt;-&quot;2&quot;
bank$month[bank$month == &quot;mar&quot; ] &lt;-&quot;3&quot;
bank$month[bank$month == &quot;apr&quot; ] &lt;-&quot;4&quot;
bank$month[bank$month == &quot;may&quot; ] &lt;-&quot;5&quot;
bank$month[bank$month == &quot;jun&quot; ] &lt;-&quot;6&quot;
bank$month[bank$month == &quot;jul&quot; ] &lt;-&quot;7&quot;
bank$month[bank$month == &quot;aug&quot; ] &lt;-&quot;8&quot;
bank$month[bank$month == &quot;sep&quot; ] &lt;-&quot;9&quot;
bank$month[bank$month == &quot;oct&quot; ] &lt;-&quot;10&quot;
bank$month[bank$month == &quot;nov&quot; ] &lt;-&quot;11&quot;
bank$month[bank$month == &quot;dec&quot; ] &lt;-&quot;12&quot;</code></pre>
<p>Converting binary and ordinal categorical variable to numeric to perform univariate analysis as a numerical variable</p>
<pre class="r"><code>bank$default &lt;- as.numeric (bank$default)
bank$housing &lt;- as.numeric (bank$housing)
bank$loan &lt;- as.numeric (bank$loan)
bank$y &lt;- as.numeric (bank$y)
bank$month &lt;- as.numeric (bank$month)</code></pre>
<div id="univariate-analysis-on-the-binary-variables" class="section level2">
<h2>Univariate analysis on the binary variables</h2>
</div>
</div>
<div id="frequency-distribution-of-default" class="section level1">
<h1>Frequency distribution of Default</h1>
<pre class="r"><code>tab1(bank$default, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Default&quot;, xlab =&quot;Default&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<pre><code>## bank$default : 
##         Frequency Percent Cum. percent
## 1              18     1.9          1.9
## 0             926    98.1        100.0
##   Total       944   100.0        100.0</code></pre>
<p>There are only 2 percentage of customers did default on loan and the rest 98 percent of customers are not defaulters</p>
</div>
<div id="frequency-distribution-of-housing" class="section level1">
<h1>Frequency distribution of housing</h1>
<pre class="r"><code>tab1(bank$housing, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Housing&quot;, xlab =&quot;Housing&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
<pre><code>## bank$housing : 
##         Frequency Percent Cum. percent
## 0             438    46.4         46.4
## 1             506    53.6        100.0
##   Total       944   100.0        100.0</code></pre>
<p>The customers who have taken housing loan are 53.8 percentage and the other 46.2 percentage of customers did not take any housing loan</p>
</div>
<div id="frequency-distribution-of-loan" class="section level1">
<h1>Frequency distribution of Loan</h1>
<pre class="r"><code>tab1(bank$loan, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Loan&quot;, xlab =&quot;Loan&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<pre><code>## bank$loan : 
##         Frequency Percent Cum. percent
## 1             159    16.8         16.8
## 0             785    83.2        100.0
##   Total       944   100.0        100.0</code></pre>
<p>Only 16.7 % of customer took a personal loan and the remaining 83.3 % of customer did not avail any personal loan</p>
</div>
<div id="frequency-distribution-of-y" class="section level1">
<h1>Frequency distribution of y</h1>
<pre class="r"><code>tab1(bank$y, sort.group = &quot;increasing&quot;, cum.percent = TRUE, main = &quot;Frequency distribution of Y&quot;, xlab =&quot;Y&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<pre><code>## bank$y : 
##         Frequency Percent Cum. percent
## 1              63     6.7          6.7
## 0             881    93.3        100.0
##   Total       944   100.0        100.0</code></pre>
<p>The majority of the customer, around 93.2 %, said that they would not subscribe to term deposit. Only 6.8 % of customers confirmed that they would subscribe it.</p>
</div>
<div id="box-plot-of-month" class="section level1">
<h1>Box plot of Month</h1>
<pre class="r"><code>month_outliers&lt;-boxplot.stats(bank$month)$out
boxplot(bank$month, main = &quot;Box plot of Month&quot;, boxwex = 0.6)
mtext(paste(&quot;Outliers: &quot;, paste(month_outliers, collapse =&quot;, &quot;)), cex = 0.6)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<pre class="r"><code>month_outliers</code></pre>
<pre><code>##  [1] 11 11 11 11  1 11  1  1  1 11 11 11 11  1  1 11 11  1 11 11  1  1 11  1 11
## [26] 11 11 11 11 11  1  1 11  1  1  1  1 11  1 11 11  1 11  1  1  1 11 11 11 11
## [51] 11  1  1 11  1  1  1 11 11 11 11 11 11  1 11  1  1 11 11 11 11 11 11  1 11
## [76] 11 11 11  1 11  1 11 11  1  1 11 11 11 11  1  1  1 11  1  1 11</code></pre>
<div id="bivariate-analysis" class="section level2">
<h2>Bivariate analysis</h2>
<p>Let us see the relationship between indendent and dependent variable</p>
</div>
</div>
<div id="relationship-between-y-and-age" class="section level1">
<h1>Relationship between y and age</h1>
</div>
<div id="correlation-test" class="section level1">
<h1>Correlation test</h1>
<pre class="r"><code>cor.test(bank$y, bank$age)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$age
## t = -1.5674, df = 942, p-value = 0.1173
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.11443724  0.01284453
## sample estimates:
##         cor 
## -0.05100346</code></pre>
<p>There is a negative correlation between y and age. It means more the age, less the people will subscribe to fixed deposit and less the age of the customer and there is a more likely that they will subscribe to term deposit. The correlation coefficient is -0.051</p>
</div>
<div id="logistic-regression-on-y-and-age" class="section level1">
<h1>Logistic regression on y and age</h1>
<pre class="r"><code>age_y = glm(y~ age, data = bank, family = &quot;binomial&quot;)
summary(age_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ age, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4495  -0.3963  -0.3720  -0.3309   2.5562  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)   
## (Intercept) -1.78130    0.55229  -3.225  0.00126 **
## age         -0.02192    0.01404  -1.561  0.11847   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 460.24  on 942  degrees of freedom
## AIC: 464.24
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The above equation is not significant</p>
</div>
<div id="jitter-and-box-plot-of-y-and-age" class="section level1">
<h1>Jitter and box plot of y and age</h1>
<pre class="r"><code>bank %&gt;%
  ggplot(aes(x= age, y= &quot;subscribe or not&quot;, color = age))+geom_jitter()+geom_boxplot()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and age&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-69-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-job" class="section level1">
<h1>Relationship between y and job</h1>
<p>Logistic regression on y and job</p>
<pre class="r"><code>job_y = glm(y~ job, data = bank, family = &quot;binomial&quot;)
summary(job_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ job, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4196  -0.4109  -0.4109  -0.2316   2.6953  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -3.6055     0.4532  -7.955 1.79e-15 ***
## jobmanagement   0.8055     0.5686   1.417   0.1566    
## jobOthers       1.1760     0.4873   2.413   0.0158 *  
## jobtechnician   1.2198     0.5275   2.313   0.0207 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 454.15  on 940  degrees of freedom
## AIC: 462.15
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The above equation is not good enough to predict the y by job as some of the coefficients are not significant</p>
</div>
<div id="bar-chart-of-y-and-job" class="section level1">
<h1>Bar chart of y and job</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= job, y= &quot;subscribe or not&quot;, color = job))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and job&quot;)+coord_flip()</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-71-1.png" width="672" /></p>
<div id="relationship-between-y-and-marital" class="section level2">
<h2>Relationship between y and marital</h2>
<p>Logistic regression on y and marital</p>
<pre class="r"><code>marital_y = glm(y~ marital, data = bank, family = &quot;binomial&quot;)
summary(marital_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ marital, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4673  -0.3300  -0.3300  -0.3300   2.4374  
## 
## Coefficients:
##                Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)    -2.91777    0.41912  -6.962 3.36e-12 ***
## maritalmarried  0.03483    0.45919   0.076    0.940    
## maritalsingle   0.75829    0.46580   1.628    0.104    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 455.57  on 941  degrees of freedom
## AIC: 461.57
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>the above equation is not good as well because of all the coefficients are not significant</p>
</div>
</div>
<div id="bar-chart-of-y-and-marital" class="section level1">
<h1>Bar chart of y and marital</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= marital, y= &quot;subscribe or not&quot;, color = marital))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and marital&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-73-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-education" class="section level1">
<h1>Relationship between y and Education</h1>
<p>Logistic regression on y and education</p>
<pre class="r"><code>education_y = glm(y~ education, data = bank, family = &quot;binomial&quot;)
summary(education_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ education, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4101  -0.3838  -0.3838  -0.2747   2.5674  
## 
## Coefficients:
##                    Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)         -3.2581     0.3852  -8.459   &lt;2e-16 ***
## educationsecondary   0.6868     0.4222   1.627   0.1038    
## educationtertiary    0.8245     0.4503   1.831   0.0671 .  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 458.75  on 941  degrees of freedom
## AIC: 464.75
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The intercept is only significant but all the coefficients are not significant. Thus, the above equation is not good to predict the y</p>
</div>
<div id="bar-chart-of-y-and-education" class="section level1">
<h1>Bar chart of y and education</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= education, y= &quot;subscribe or not&quot;, color =education))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and education&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-75-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-default" class="section level1">
<h1>Relationship between y and default</h1>
<p>Correlation between y and default</p>
<pre class="r"><code>cor.test(bank$y, bank$default)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$default
## t = 1.7161, df = 942, p-value = 0.08647
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.008008571  0.119207728
## sample estimates:
##        cor 
## 0.05582615</code></pre>
<p>There is some correlation between y and default. The correlation coefficient is 0.056</p>
</div>
<div id="logistic-regression-on-y-and-default" class="section level1">
<h1>Logistic regression on y and default</h1>
<pre class="r"><code>default_y = glm(y~ default, data = bank, family = &quot;binomial&quot;)
summary(default_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ default, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.6039  -0.3660  -0.3660  -0.3660   2.3395  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.6695     0.1335  -20.00   &lt;2e-16 ***
## default       1.0601     0.6464    1.64    0.101    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 460.63  on 942  degrees of freedom
## AIC: 464.63
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Though there is some correlation between y and default, the coefficient of the above equation is not significant.</p>
</div>
<div id="bar-chart-of-y-and-default" class="section level1">
<h1>Bar chart of y and default</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= default, y= &quot;subscribe or not&quot;, colour= default))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;, maxit =100))+labs(title =&quot;Relationship between y and default&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-78-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-balance" class="section level1">
<h1>Relationship between y and balance</h1>
<pre class="r"><code>cor.test(bank$y, bank$balance)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$balance
## t = 0.48702, df = 942, p-value = 0.6264
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.04798865  0.07959176
## sample estimates:
##        cor 
## 0.01586613</code></pre>
<p>There is some positive correlation between y and balance. The correlation coefficient is 0.016</p>
</div>
<div id="logistice-regression-on-y-and-balance" class="section level1">
<h1>Logistice regression on y and balance</h1>
<pre class="r"><code>balance_y = glm(y~ balance, data = bank, family = &quot;binomial&quot;)
summary(balance_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ balance, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.3936  -0.3801  -0.3687  -0.3598   2.3636  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.7308545  0.2340080 -11.670   &lt;2e-16 ***
## balance      0.0007782  0.0015971   0.487    0.626    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 462.54  on 942  degrees of freedom
## AIC: 466.54
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Even though there is a positive correlation between y and balance, that above equation is not good as the coefficient is not significant</p>
</div>
<div id="jitter-and-box-plot-of-y-and-balance" class="section level1">
<h1>JItter and box plot of y and balance</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= balance, y= &quot;subscribe or not&quot;, color =balance))+geom_jitter()+geom_boxplot()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and balance&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-81-1.png" width="672" /></p>
<div id="relationship-between-y-and-housing" class="section level2">
<h2>Relationship between y and housing</h2>
<p>Correlation test between y and housing</p>
<pre class="r"><code>cor.test(bank$y, bank$housing)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$housing
## t = -2.5609, df = 942, p-value = 0.0106
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.1461792 -0.0194455
## sample estimates:
##         cor 
## -0.08314853</code></pre>
<p>There is a negative correlation between y and housing. The correlation coefficient is -0.083</p>
</div>
</div>
<div id="logistic-regression-of-y-and-housing" class="section level1">
<h1>Logistic regression of y and housing</h1>
<pre class="r"><code>housing_y = glm(y~ housing, data = bank, family = &quot;binomial&quot;)
summary(housing_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ housing, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4319  -0.4319  -0.3118  -0.3118   2.4692  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.3254     0.1678 -13.861   &lt;2e-16 ***
## housing      -0.6745     0.2681  -2.516   0.0119 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 456.25  on 942  degrees of freedom
## AIC: 460.25
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The above equation is significant to predict y but it is a negative correlation. If the customer takes more housing loan, it is less likely that he will subscribe to term deposit because he would have already a commitment to oay a monthly EMI. On the contrary, if the customer does not have any housing loan, it is more likely that he will subscribe to term deposit</p>
</div>
<div id="bar-chart-of-y-and-housing" class="section level1">
<h1>Bar chart of y and housing</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= housing, y= &quot;subscribe or not&quot;, colour = housing))+geom_col()+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;, maxit =100))+labs(title =&quot;Relationship between y and housing&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-84-1.png" width="672" />
In the above chart, o represents no housing loan and 1 represents customer having housing loan.</p>
</div>
<div id="relationship-between-y-and-loan" class="section level1">
<h1>Relationship between y and loan</h1>
<p>Correlation test of y and loan</p>
<pre class="r"><code>cor.test(bank$y, bank$loan)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$loan
## t = -2.6594, df = 942, p-value = 0.007961
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.14930851 -0.02264324
## sample estimates:
##         cor 
## -0.08632471</code></pre>
<p>There is a negative correlation between y and loan. It is just like the case of housing loan. When the customers have an obligation towards personal loan, they will not have the sufficients funds to subscribe to term deposit. That is the reason, there is a negative correlation. When the customer does not have personal loan, there is a likely chance that they will subscribe to term deposit.</p>
</div>
<div id="logistic-regression-of-y-and-loan" class="section level1">
<h1>Logistic regression of y and loan</h1>
<pre class="r"><code>loan_y = glm(y~ loan, data = bank, family = &quot;binomial&quot;)
summary(loan_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ loan, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.3988  -0.3988  -0.3988  -0.3988   2.8179  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -2.4918     0.1343  -18.55   &lt;2e-16 ***
## loan         -1.4594     0.5981   -2.44   0.0147 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 453.62  on 942  degrees of freedom
## AIC: 457.62
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The above equation is to significant to predict the y. The AIC is 457.62</p>
</div>
<div id="bar-chart-of-y-and-loan" class="section level1">
<h1>Bar chart of y and loan</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= loan, y= &quot;subscribe or not&quot;, colour =loan))+geom_col()+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;, maxit =100))+labs(title =&quot;Relationship between y and loan&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-87-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-contact" class="section level1">
<h1>Relationship between y and contact</h1>
<p>Logistic regression of y and contact</p>
<pre class="r"><code>contact_y = glm(y~ contact, data = bank, family = &quot;binomial&quot;)
summary(contact_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ contact, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4377  -0.4377  -0.4377  -0.1806   2.8719  
## 
## Coefficients:
##                             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                  -2.2974     0.1377 -16.678  &lt; 2e-16 ***
## contacttelephone and others  -1.8102     0.4713  -3.841 0.000123 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 439.30  on 942  degrees of freedom
## AIC: 443.3
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The above equation is significant to predict y. The AIC is 443.3</p>
</div>
<div id="bar-chart-of-y-and-contact" class="section level1">
<h1>Bar chart of y and contact</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= contact, y= &quot;subscribe or not&quot;, colour =contact))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and contact&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-day" class="section level1">
<h1>Relationship between y and day</h1>
<p>Correlation test of y and day</p>
<pre class="r"><code>cor.test(bank$y, bank$day)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$day
## t = 0.11781, df = 942, p-value = 0.9062
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.05998249  0.06762804
## sample estimates:
##         cor 
## 0.003838402</code></pre>
<p>There is a positive correaltion between y and day</p>
</div>
<div id="logistic-regression-of-y-and-day" class="section level1">
<h1>Logistic regression of y and day</h1>
<pre class="r"><code>day_y = glm(y~ day, data = bank, family = &quot;binomial&quot;)
summary(day_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ day, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.3769  -0.3735  -0.3712  -0.3689   2.3373  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.666012   0.272307  -9.790   &lt;2e-16 ***
## day          0.001832   0.015534   0.118    0.906    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 462.77  on 942  degrees of freedom
## AIC: 466.77
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>Though there is a correlation between y and day, the above equation is not significant.</p>
</div>
<div id="jitter-and-box-plot-of-y-and-day" class="section level1">
<h1>Jitter and box plot of y and day</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= day, y= &quot;subscribe or not&quot;, color =day))+geom_jitter()+geom_boxplot()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and day&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-92-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-month" class="section level1">
<h1>Relationship between y and month</h1>
<p>Correlation between y and month</p>
<pre class="r"><code>cor.test(bank$y, bank$month)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$month
## t = -0.14919, df = 942, p-value = 0.8814
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.06864575  0.05896364
## sample estimates:
##          cor 
## -0.004860841</code></pre>
<p>There is a negative correlation. The correlation coefficient is - 0.004</p>
</div>
<div id="logistic-regression-on-y-and-month" class="section level1">
<h1>Logistic regression on y and month</h1>
<pre class="r"><code>month_y = glm(y~ month, data = bank, family = &quot;binomial&quot;)
summary(month_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ month, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.3794  -0.3731  -0.3716  -0.3685   2.3441  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.586743   0.365642  -7.075  1.5e-12 ***
## month       -0.008589   0.057512  -0.149    0.881    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 462.76  on 942  degrees of freedom
## AIC: 466.76
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>The above equation is not good as the coefficient is not significant</p>
</div>
<div id="bar-chart-of-y-and-month" class="section level1">
<h1>Bar chart of y and month</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= month, y= &quot;subscribe or not&quot;, color =month))+geom_col()+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;,maxit =100))+labs(title =&quot;Relationship between y and month&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-95-1.png" width="672" /></p>
<div id="relationship-between-y-and-duration" class="section level2">
<h2>Relationship between y and duration</h2>
<p>Correlation test of y and duration</p>
<pre class="r"><code>cor.test(bank$y, bank$duration)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$duration
## t = 7.4172, df = 942, p-value = 2.666e-13
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  0.1736999 0.2942979
## sample estimates:
##       cor 
## 0.2349027</code></pre>
<p>There is a positive correlation between y and duration. The correlation coefficient is 0.23</p>
</div>
</div>
<div id="logistic-regression-of-y-and-duration" class="section level1">
<h1>Logistic regression of y and duration</h1>
<pre class="r"><code>duration_y = glm(y~ duration, data = bank, family = &quot;binomial&quot;)
summary(duration_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ duration, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.9607  -0.3715  -0.2863  -0.2346   2.6899  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -4.0426075  0.2859768 -14.136  &lt; 2e-16 ***
## duration     0.0059473  0.0008884   6.695 2.16e-11 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 419.13  on 942  degrees of freedom
## AIC: 423.13
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The above equation is significant to predict y. The AIC is 423.13</p>
</div>
<div id="box-plot-of-y-and-duration" class="section level1">
<h1>Box plot of y and duration</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= duration, y= &quot;subscribe or not&quot;, color =duration))+geom_boxplot()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and duration&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-98-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-campaign" class="section level1">
<h1>Relationship between y and campaign</h1>
<p>Correlation test between y and campaign</p>
<pre class="r"><code>cor.test(bank$y, bank$campaign)</code></pre>
<pre><code>## 
##  Pearson&#39;s product-moment correlation
## 
## data:  bank$y and bank$campaign
## t = -2.6585, df = 942, p-value = 0.007982
## alternative hypothesis: true correlation is not equal to 0
## 95 percent confidence interval:
##  -0.14927934 -0.02261342
## sample estimates:
##        cor 
## -0.0862951</code></pre>
<p>It is surprising to see that there is a negative correlation between y and campaign. Generally, more the campaign, more should be a new subscription of term deposit but it is opposite here</p>
</div>
<div id="logistic-regression-between-y-and-campaign" class="section level1">
<h1>Logistic regression between y and campaign</h1>
<pre class="r"><code>campaign_y = glm(y~ campaign, data = bank, family = &quot;binomial&quot;)
summary(campaign_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ campaign, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.4312  -0.4312  -0.3670  -0.3118   2.8370  
## 
## Coefficients:
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  -1.9932     0.2591  -7.693 1.44e-14 ***
## campaign     -0.3355     0.1290  -2.602  0.00927 ** 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 454.53  on 942  degrees of freedom
## AIC: 458.53
## 
## Number of Fisher Scoring iterations: 6</code></pre>
<p>The above equation is significant to predict the y because both the intercept and coefficient are significant. The AIC is 458.53</p>
</div>
<div id="box-plot-of-campaign-1" class="section level1">
<h1>box plot of Campaign</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= campaign, y= &quot;subscribe or not&quot;, color =campaign))+geom_boxplot()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and campaign&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<pre><code>## Warning: glm.fit: algorithm did not converge</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-101-1.png" width="672" /></p>
</div>
<div id="relationship-between-y-and-poutcome" class="section level1">
<h1>Relationship between y and poutcome</h1>
<p>Logistic regression of y and poutcome</p>
<pre class="r"><code>poutcome_y = glm(y~ poutcome, data = bank, family = &quot;binomial&quot;)
summary(poutcome_y)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ poutcome, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -0.7655  -0.3345  -0.3345  -0.3345   2.4827  
## 
## Coefficients:
##                            Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -3.0350     0.4578  -6.630 3.37e-11 ***
## poutcomesuccess and others   1.9574     0.5416   3.614 0.000302 ***
## poutcomeunknown              0.1796     0.4845   0.371 0.710908    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 438.21  on 941  degrees of freedom
## AIC: 444.21
## 
## Number of Fisher Scoring iterations: 5</code></pre>
<p>In the above equation, one of the coefficient is not significant. We can take this in to our model since unknow result are more compared to known factors such as success or failure. There is a great chance to convert those customers in to subscribe the term deposit</p>
</div>
<div id="bar-chart-of-y-and-poutcome" class="section level1">
<h1>Bar chart of y and poutcome</h1>
<pre class="r"><code>bank %&gt;%
ggplot(aes(x= poutcome, y= &quot;subscribe or not&quot;, color =poutcome))+geom_col()+expand_limits(y=0)+geom_smooth(method =&quot;glm&quot;, se =FALSE, method.args = list(family = &quot;binomial&quot;))+labs(title =&quot;Relationship between y and poutcome&quot;)</code></pre>
<pre><code>## `geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-103-1.png" width="672" /></p>
<p>First, I would use tidymodels to build a logistic regression. In order to do, I have to convert the following as a character variable</p>
<pre class="r"><code>bank$default &lt;- as.character (bank$default)
bank$housing &lt;-  as.character (bank$housing)
bank$loan &lt;-  as.character (bank$loan)
bank$y &lt;-  as.character (bank$y)
bank$month &lt;-  as.character (bank$month)</code></pre>
</div>
<div id="data-resampling" class="section level1">
<h1>Data resampling</h1>
<p>I have split the bank data in to trainig and test data with a split of 75:25</p>
<pre class="r"><code>bank_split&lt;- initial_split(bank, prop = 0.75, strata = y)
bank_training &lt;- bank_split %&gt;%
  training()
bank_test&lt;- bank_split %&gt;%
  testing()</code></pre>
</div>
<div id="checking-number-of-rows-in-training-and-test-data" class="section level1">
<h1>Checking number of rows in training and test data</h1>
<pre class="r"><code>nrow(bank_training)</code></pre>
<pre><code>## [1] 708</code></pre>
<pre class="r"><code>nrow(bank_test)</code></pre>
<pre><code>## [1] 236</code></pre>
</div>
<div id="checking-multicollinearity-between-numerical-values-in-a-training-bank-data-set" class="section level1">
<h1>Checking multicollinearity between numerical values in a training bank data set</h1>
<pre class="r"><code>bank_training %&gt;%
  select_if(is.numeric) %&gt;%
  cor()</code></pre>
<pre><code>##                   age      balance          day     duration    campaign
## age       1.000000000  0.049885760 -0.007863495 -0.034544631  0.03216495
## balance   0.049885760  1.000000000 -0.037180870  0.008061836 -0.03137514
## day      -0.007863495 -0.037180870  1.000000000 -0.061925881  0.07744792
## duration -0.034544631  0.008061836 -0.061925881  1.000000000 -0.07537217
## campaign  0.032164949 -0.031375140  0.077447918 -0.075372175  1.00000000</code></pre>
<p>We can notice that there is no much corellation the independent variable</p>
</div>
<div id="model-specification" class="section level1">
<h1>Model specification</h1>
<p>I specify the logistic regression model here</p>
<pre class="r"><code>logistic_model&lt;- logistic_reg() %&gt;%
  set_engine(&#39;glm&#39;) %&gt;%
  set_mode(&#39;classification&#39;)</code></pre>
</div>
<div id="feature-engineering" class="section level1">
<h1>Feature engineering</h1>
<p>This is step to do pre-processing of data</p>
<pre class="r"><code>bank_recipe &lt;- recipe(y ~., data = bank_training) %&gt;%
  step_corr(all_numeric(), threshold =0.8) %&gt;%
  step_normalize(all_numeric()) %&gt;%
  step_dummy(all_nominal(), -all_outcomes())
bank_recipe</code></pre>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor         14
## 
## Operations:
## 
## Correlation filter on all_numeric()
## Centering and scaling for all_numeric()
## Dummy variables from all_nominal(), -all_outcomes()</code></pre>
<p>I have given instruction above in the model that to check the correlation for all numeric variables and keep the thresholding limit as 0.8. I have also given instruction in the model to normalize all the numeric variables and set dummy to all nominal or character variables except the outcome variables because outcome is in factor</p>
</div>
<div id="recipe-training" class="section level1">
<h1>Recipe training</h1>
<pre class="r"><code>bank_recipe_prep&lt;- bank_recipe %&gt;%
  prep(training = bank_training)
bank_recipe_prep</code></pre>
<pre><code>## Recipe
## 
## Inputs:
## 
##       role #variables
##    outcome          1
##  predictor         14
## 
## Training data contained 708 data points and no missing data.
## 
## Operations:
## 
## Correlation filter removed no terms [trained]
## Centering and scaling for age, balance, day, duration, campaign [trained]
## Dummy variables from job, marital, education, default, housing, loan, contact,... [trained]</code></pre>
<div id="preprocess-training-data" class="section level2">
<h2>Preprocess training data</h2>
<p>Applying the trained recipe to the training data</p>
<pre class="r"><code>bank_training_prep &lt;- bank_recipe_prep %&gt;%
  bake (new_data = NULL)
bank_training_prep</code></pre>
<pre><code>## # A tibble: 708 x 29
##         age balance    day duration campaign y     job_management job_Others
##       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;      &lt;dbl&gt;
##  1 -0.105     0.385 -1.14  -0.306     -0.128 0                  0          0
##  2  0.306     1.81   0.170 -0.608     -0.128 0                  0          1
##  3 -0.00247   0.958  1.60  -0.00303   -0.128 0                  1          0
##  4 -0.929     0.203 -1.03  -0.329     -0.881 0                  0          1
##  5  0.203    -1.21   0.409 -0.393      0.626 0                  1          0
##  6  0.409    -0.272 -1.03  -0.513     -0.128 0                  0          1
##  7  1.95     -0.893  0.647 -1.19      -0.881 0                  1          0
##  8  1.54      0.361 -1.62  -1.04       0.626 0                  0          0
##  9 -0.208    -0.796  1.60  -0.728     -0.128 0                  0          0
## 10  1.75     -0.406 -1.38  -0.393     -0.881 0                  1          0
## # ... with 698 more rows, and 21 more variables: job_technician &lt;dbl&gt;,
## #   marital_married &lt;dbl&gt;, marital_single &lt;dbl&gt;, education_secondary &lt;dbl&gt;,
## #   education_tertiary &lt;dbl&gt;, default_X1 &lt;dbl&gt;, housing_X1 &lt;dbl&gt;,
## #   loan_X1 &lt;dbl&gt;, contact_telephone.and.others &lt;dbl&gt;, month_X10 &lt;dbl&gt;,
## #   month_X11 &lt;dbl&gt;, month_X2 &lt;dbl&gt;, month_X3 &lt;dbl&gt;, month_X4 &lt;dbl&gt;,
## #   month_X5 &lt;dbl&gt;, month_X6 &lt;dbl&gt;, month_X7 &lt;dbl&gt;, month_X8 &lt;dbl&gt;,
## #   month_X9 &lt;dbl&gt;, poutcome_success.and.others &lt;dbl&gt;, ...</code></pre>
</div>
<div id="preprocess-test-data" class="section level2">
<h2>Preprocess test data</h2>
<p>Applying trained recipe to the test data</p>
<pre class="r"><code>bank_test_prep &lt;- bank_recipe_prep %&gt;%
  bake (new_data = bank_test)
bank_test_prep</code></pre>
<pre><code>## # A tibble: 236 x 29
##       age balance    day duration campaign y     job_management job_Others
##     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;      &lt;dbl&gt;
##  1  0.101  1.29   -0.189  -1.05     -0.128 0                  0          1
##  2  0.409 -0.114  -0.428  -0.640    -0.128 0                  0          1
##  3  1.34  -0.126   0.647  -0.919    -0.128 0                  0          1
##  4 -0.929  0.678   1.36   -0.863     0.626 0                  0          0
##  5  1.13   1.07   -0.906  -0.441    -0.881 0                  0          0
##  6  0.615  0.775   1.60    0.0368    1.38  0                  0          1
##  7 -0.311 -1.15   -1.62   -0.744    -0.881 0                  0          1
##  8 -0.414 -1.12   -0.906  -0.298    -0.128 0                  0          0
##  9 -0.414  0.0932  0.289  -1.44     -0.881 0                  0          0
## 10  0.821 -1.16    1.36   -0.353     0.626 0                  0          0
## # ... with 226 more rows, and 21 more variables: job_technician &lt;dbl&gt;,
## #   marital_married &lt;dbl&gt;, marital_single &lt;dbl&gt;, education_secondary &lt;dbl&gt;,
## #   education_tertiary &lt;dbl&gt;, default_X1 &lt;dbl&gt;, housing_X1 &lt;dbl&gt;,
## #   loan_X1 &lt;dbl&gt;, contact_telephone.and.others &lt;dbl&gt;, month_X10 &lt;dbl&gt;,
## #   month_X11 &lt;dbl&gt;, month_X2 &lt;dbl&gt;, month_X3 &lt;dbl&gt;, month_X4 &lt;dbl&gt;,
## #   month_X5 &lt;dbl&gt;, month_X6 &lt;dbl&gt;, month_X7 &lt;dbl&gt;, month_X8 &lt;dbl&gt;,
## #   month_X9 &lt;dbl&gt;, poutcome_success.and.others &lt;dbl&gt;, ...</code></pre>
</div>
</div>
<div id="model-fitting" class="section level1">
<h1>Model fitting</h1>
<pre class="r"><code>logistic_fit &lt;- logistic_model %&gt;%
  fit(y ~., data = bank_training_prep)
logistic_fit</code></pre>
<pre><code>## parsnip model object
## 
## Fit time:  31ms 
## 
## Call:  stats::glm(formula = y ~ ., family = stats::binomial, data = data)
## 
## Coefficients:
##                  (Intercept)                           age  
##                    -20.10676                      -0.37236  
##                      balance                           day  
##                      0.09017                      -0.13091  
##                     duration                      campaign  
##                      0.67995                      -0.28363  
##               job_management                    job_Others  
##                      0.91603                       1.40656  
##               job_technician               marital_married  
##                      1.22152                      -0.15632  
##               marital_single           education_secondary  
##                      0.35073                      -0.33600  
##           education_tertiary                    default_X1  
##                     -0.05827                       1.89367  
##                   housing_X1                       loan_X1  
##                     -0.33638                      -1.38301  
## contact_telephone.and.others                     month_X10  
##                     -1.67252                      17.86536  
##                    month_X11                      month_X2  
##                     15.32797                      14.73110  
##                     month_X3                      month_X4  
##                     18.21843                      17.52113  
##                     month_X5                      month_X6  
##                     15.26592                      16.83368  
##                     month_X7                      month_X8  
##                     14.73347                      15.69286  
##                     month_X9   poutcome_success.and.others  
##                     15.93209                       2.48193  
##             poutcome_unknown  
##                      0.82254  
## 
## Degrees of Freedom: 707 Total (i.e. Null);  679 Residual
## Null Deviance:       366.6 
## Residual Deviance: 226.6     AIC: 284.6</code></pre>
<p>The above is the significant equation to predict the outcome variable. The AIC is 289.2, which is quite good compared to our manual method</p>
</div>
<div id="predicting-outcome-categories" class="section level1">
<h1>Predicting outcome categories</h1>
<pre class="r"><code>class_preds &lt;- predict (logistic_fit, new_data = bank_test_prep, type =&quot;class&quot;)
class_preds</code></pre>
<pre><code>## # A tibble: 236 x 1
##    .pred_class
##    &lt;fct&gt;      
##  1 0          
##  2 0          
##  3 0          
##  4 0          
##  5 0          
##  6 0          
##  7 0          
##  8 0          
##  9 0          
## 10 0          
## # ... with 226 more rows</code></pre>
<p>The above .pred class is the outcome of our results. That is if the customer is to subscribe to term deposit or not. The number o means no and 1 means yes to subscriptions</p>
</div>
<div id="estimated-probabilities" class="section level1">
<h1>Estimated probabilities</h1>
<pre class="r"><code>prob_preds &lt;- predict (logistic_fit, new_data = bank_test_prep, type =&quot;prob&quot;)
prob_preds</code></pre>
<pre><code>## # A tibble: 236 x 2
##    .pred_0      .pred_1
##      &lt;dbl&gt;        &lt;dbl&gt;
##  1   0.996 0.00444     
##  2   0.961 0.0389      
##  3   0.995 0.00526     
##  4   0.968 0.0324      
##  5   0.997 0.00311     
##  6   1.00  0.0000000189
##  7   0.863 0.137       
##  8   0.988 0.0116      
##  9   0.994 0.00598     
## 10   0.860 0.140       
## # ... with 226 more rows</code></pre>
<p>The above prediction is the probability of outcome occurences.</p>
<p>In tidymodels, outcome variable needs to be a factor</p>
<pre class="r"><code>bank$y &lt;- as.factor (bank$y)</code></pre>
</div>
<div id="combining-results" class="section level1">
<h1>Combining results</h1>
<pre class="r"><code>results &lt;- bank_test_prep %&gt;%
  bind_cols(class_preds, prob_preds)
results</code></pre>
<pre><code>## # A tibble: 236 x 32
##       age balance    day duration campaign y     job_management job_Others
##     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;    &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;      &lt;dbl&gt;
##  1  0.101  1.29   -0.189  -1.05     -0.128 0                  0          1
##  2  0.409 -0.114  -0.428  -0.640    -0.128 0                  0          1
##  3  1.34  -0.126   0.647  -0.919    -0.128 0                  0          1
##  4 -0.929  0.678   1.36   -0.863     0.626 0                  0          0
##  5  1.13   1.07   -0.906  -0.441    -0.881 0                  0          0
##  6  0.615  0.775   1.60    0.0368    1.38  0                  0          1
##  7 -0.311 -1.15   -1.62   -0.744    -0.881 0                  0          1
##  8 -0.414 -1.12   -0.906  -0.298    -0.128 0                  0          0
##  9 -0.414  0.0932  0.289  -1.44     -0.881 0                  0          0
## 10  0.821 -1.16    1.36   -0.353     0.626 0                  0          0
## # ... with 226 more rows, and 24 more variables: job_technician &lt;dbl&gt;,
## #   marital_married &lt;dbl&gt;, marital_single &lt;dbl&gt;, education_secondary &lt;dbl&gt;,
## #   education_tertiary &lt;dbl&gt;, default_X1 &lt;dbl&gt;, housing_X1 &lt;dbl&gt;,
## #   loan_X1 &lt;dbl&gt;, contact_telephone.and.others &lt;dbl&gt;, month_X10 &lt;dbl&gt;,
## #   month_X11 &lt;dbl&gt;, month_X2 &lt;dbl&gt;, month_X3 &lt;dbl&gt;, month_X4 &lt;dbl&gt;,
## #   month_X5 &lt;dbl&gt;, month_X6 &lt;dbl&gt;, month_X7 &lt;dbl&gt;, month_X8 &lt;dbl&gt;,
## #   month_X9 &lt;dbl&gt;, poutcome_success.and.others &lt;dbl&gt;, ...</code></pre>
<p>I was trying to select only y and show the .pred_class and .pred probability to show how much actual and prediction class and its probability but when i used select (y) %&gt;%, I was getting error, so I show here the whole model with .pred class and its probability at the end of the table</p>
</div>
<div id="assessing-the-model-fit-using-confusion-matrix" class="section level1">
<h1>Assessing the model fit using Confusion matrix</h1>
<pre class="r"><code>results %&gt;%
  conf_mat(truth = y, estimate = .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction   0   1
##          0 220  11
##          1   4   1</code></pre>
</div>
<div id="correct-predictions" class="section level1">
<h1>Correct predictions</h1>
<p>True negative is 220, which is the customer did not subscibe to term deposit
True positive is 2, which is the customers subscripe to term deposit</p>
</div>
<div id="classification-error" class="section level1">
<h1>Classification error</h1>
<p>False negative is 5, which is the customer did not subscribe to term deposit but wrongly predicted as subscriped
False positive is 9, which is the customer subscribed to term deposit but wronly predicted as not subscribed</p>
<p>It is clear that the customers will not subscribe to the term deposit</p>
<p>In order to automate this logistic regression model in machine learning, I have created the following workflow models</p>
</div>
<div id="creating-workflow" class="section level1">
<h1>Creating workflow</h1>
<pre class="r"><code>bank_wkfl&lt;- workflow() %&gt;%
add_model(logistic_model) %&gt;%
add_recipe(bank_recipe)
bank_wkfl</code></pre>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: logistic_reg()
## 
## -- Preprocessor ----------------------------------------------------------------
## 3 Recipe Steps
## 
## * step_corr()
## * step_normalize()
## * step_dummy()
## 
## -- Model -----------------------------------------------------------------------
## Logistic Regression Model Specification (classification)
## 
## Computational engine: glm</code></pre>
<p>I have given instruction above in the model that to check the correlation for all numeric variables and keep the thresholding limit as 0.8. I have also given instruction in the model to normalize all the numeric variables and set dummy to all nominal or character variables except the outcome variables because outcome is in factor</p>
</div>
<div id="train-the-workflow" class="section level1">
<h1>Train the workflow</h1>
<pre class="r"><code>bank_wkfl_fit &lt;- bank_wkfl %&gt;%
  last_fit( split = bank_split)
bank_wkfl_fit</code></pre>
<pre><code>## # Resampling results
## # Manual resampling 
## # A tibble: 1 x 6
##   splits            id               .metrics   .notes   .predictions  .workflow
##   &lt;list&gt;            &lt;chr&gt;            &lt;list&gt;     &lt;list&gt;   &lt;list&gt;        &lt;list&gt;   
## 1 &lt;split [708/236]&gt; train/test split &lt;tibble [~ &lt;tibble~ &lt;tibble [236~ &lt;workflo~</code></pre>
</div>
<div id="calculating-performance-metrics-on-test-data" class="section level1">
<h1>Calculating performance metrics on test data</h1>
<pre class="r"><code>bank_wkfl_fit %&gt;%
   collect_metrics() </code></pre>
<pre><code>## # A tibble: 2 x 4
##   .metric  .estimator .estimate .config             
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary         0.936 Preprocessor1_Model1
## 2 roc_auc  binary         0.844 Preprocessor1_Model1</code></pre>
</div>
<div id="collecting-predictions" class="section level1">
<h1>collecting predictions</h1>
<pre class="r"><code>bank_wkfl_fit_results&lt;- bank_wkfl_fit %&gt;%
  collect_predictions()
bank_wkfl_fit_results</code></pre>
<pre><code>## # A tibble: 236 x 7
##    id               .pred_0      .pred_1  .row .pred_class y     .config        
##    &lt;chr&gt;              &lt;dbl&gt;        &lt;dbl&gt; &lt;int&gt; &lt;fct&gt;       &lt;fct&gt; &lt;chr&gt;          
##  1 train/test split   0.996 0.00444          2 0           0     Preprocessor1_~
##  2 train/test split   0.961 0.0389           7 0           0     Preprocessor1_~
##  3 train/test split   0.995 0.00526          9 0           0     Preprocessor1_~
##  4 train/test split   0.968 0.0324          10 0           0     Preprocessor1_~
##  5 train/test split   0.997 0.00311         16 0           0     Preprocessor1_~
##  6 train/test split   1.00  0.0000000189    32 0           0     Preprocessor1_~
##  7 train/test split   0.863 0.137           40 0           0     Preprocessor1_~
##  8 train/test split   0.988 0.0116          41 0           0     Preprocessor1_~
##  9 train/test split   0.994 0.00598         44 0           0     Preprocessor1_~
## 10 train/test split   0.860 0.140           47 0           0     Preprocessor1_~
## # ... with 226 more rows</code></pre>
</div>
<div id="creating-custom-metrics" class="section level1">
<h1>Creating custom metrics</h1>
<pre class="r"><code>bank_metrics &lt;- metric_set(roc_auc,sens,spec)
bank_metrics</code></pre>
<pre><code>## # A tibble: 3 x 3
##   metric  class        direction
##   &lt;chr&gt;   &lt;chr&gt;        &lt;chr&gt;    
## 1 roc_auc prob_metric  maximize 
## 2 sens    class_metric maximize 
## 3 spec    class_metric maximize</code></pre>
<pre class="r"><code>bank_wkfl_fit_results %&gt;%
  bank_metrics(truth = y, estimate = .pred_class, .pred_1)</code></pre>
<pre><code>## # A tibble: 3 x 3
##   .metric .estimator .estimate
##   &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt;
## 1 sens    binary        0.982 
## 2 spec    binary        0.0833
## 3 roc_auc binary        0.156</code></pre>
</div>
<div id="creating-cross-validation-folds" class="section level1">
<h1>Creating cross validation folds</h1>
<p>Bank training data has been splited into 5 fold using cross validation</p>
<pre class="r"><code>set.seed(315)
bank_folds&lt;- vfold_cv(bank_training, v = 5, strata = y)
bank_folds</code></pre>
<pre><code>## #  5-fold cross-validation using stratification 
## # A tibble: 5 x 2
##   splits            id   
##   &lt;list&gt;            &lt;chr&gt;
## 1 &lt;split [566/142]&gt; Fold1
## 2 &lt;split [566/142]&gt; Fold2
## 3 &lt;split [566/142]&gt; Fold3
## 4 &lt;split [567/141]&gt; Fold4
## 5 &lt;split [567/141]&gt; Fold5</code></pre>
</div>
<div id="fit-resamples" class="section level1">
<h1>Fit resamples</h1>
<pre class="r"><code>bank_rs &lt;- bank_wkfl %&gt;%
  fit_resamples(resamples = bank_folds, metrics = bank_metrics)
bank_rs %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 3 x 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 roc_auc binary     0.802     5 0.0426  Preprocessor1_Model1
## 2 sens    binary     0.983     5 0.00380 Preprocessor1_Model1
## 3 spec    binary     0.342     5 0.0387  Preprocessor1_Model1</code></pre>
<p>The roc_auc is 0.76
The sensitivity is 0.98, which is the proportion of positive cases that were correctly classified
The secificity is 0.19, which is the proportion of negative cases that were correctly classified</p>
</div>
<div id="detailed-cross-validation-results" class="section level1">
<h1>Detailed cross validation results</h1>
<pre class="r"><code>bank_detailed_results &lt;- bank_rs %&gt;%
  collect_metrics(summarize = FALSE)
bank_detailed_results</code></pre>
<pre><code>## # A tibble: 15 x 5
##    id    .metric .estimator .estimate .config             
##    &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
##  1 Fold1 sens    binary         0.976 Preprocessor1_Model1
##  2 Fold1 spec    binary         0.333 Preprocessor1_Model1
##  3 Fold1 roc_auc binary         0.875 Preprocessor1_Model1
##  4 Fold2 sens    binary         0.978 Preprocessor1_Model1
##  5 Fold2 spec    binary         0.375 Preprocessor1_Model1
##  6 Fold2 roc_auc binary         0.815 Preprocessor1_Model1
##  7 Fold3 sens    binary         0.993 Preprocessor1_Model1
##  8 Fold3 spec    binary         0.375 Preprocessor1_Model1
##  9 Fold3 roc_auc binary         0.853 Preprocessor1_Model1
## 10 Fold4 sens    binary         0.992 Preprocessor1_Model1
## 11 Fold4 spec    binary         0.2   Preprocessor1_Model1
## 12 Fold4 roc_auc binary         0.637 Preprocessor1_Model1
## 13 Fold5 sens    binary         0.978 Preprocessor1_Model1
## 14 Fold5 spec    binary         0.429 Preprocessor1_Model1
## 15 Fold5 roc_auc binary         0.833 Preprocessor1_Model1</code></pre>
</div>
<div id="summarizing-cross-validation-results" class="section level1">
<h1>Summarizing cross validation results</h1>
<pre class="r"><code>bank_detailed_results %&gt;%
   group_by(id) %&gt;%
  filter(.metric == &#39;roc_auc&#39;) %&gt;%
 summarize(min = min(.estimate),
            median = median(.estimate),
            max = max(.estimate), mean = mean (.estimate),
            sd = sd(.estimate)
           )</code></pre>
<pre><code>##         min    median   max      mean         sd
## 1 0.6366412 0.8326226 0.875 0.8024349 0.09532542</code></pre>
</div>
<div id="viewing-the-best-performing-models" class="section level1">
<h1>Viewing the best performing models</h1>
<pre class="r"><code>bank_rs %&gt;%
  show_best(metric = &#39;roc_auc&#39;, n=5)</code></pre>
<pre><code>## # A tibble: 1 x 6
##   .metric .estimator  mean     n std_err .config             
##   &lt;chr&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;int&gt;   &lt;dbl&gt; &lt;chr&gt;               
## 1 roc_auc binary     0.802     5  0.0426 Preprocessor1_Model1</code></pre>
<pre class="r"><code>best_bank_model &lt;- bank_rs %&gt;%
  select_best(metric = &#39;roc_auc&#39;)
best_bank_model </code></pre>
<pre><code>## # A tibble: 1 x 1
##   .config             
##   &lt;chr&gt;               
## 1 Preprocessor1_Model1</code></pre>
<p>We have got the best model as Preprocessor1_Model1</p>
</div>
<div id="finalizing-the-workflow" class="section level1">
<h1>Finalizing the workflow</h1>
<pre class="r"><code>final_bank_wkfl &lt;- bank_wkfl %&gt;%
finalize_workflow(best_bank_model)
final_bank_wkfl</code></pre>
<pre><code>## == Workflow ====================================================================
## Preprocessor: Recipe
## Model: logistic_reg()
## 
## -- Preprocessor ----------------------------------------------------------------
## 3 Recipe Steps
## 
## * step_corr()
## * step_normalize()
## * step_dummy()
## 
## -- Model -----------------------------------------------------------------------
## Logistic Regression Model Specification (classification)
## 
## Computational engine: glm</code></pre>
</div>
<div id="model-fitting-1" class="section level1">
<h1>Model fitting</h1>
<pre class="r"><code>bank_final_fit &lt;- final_bank_wkfl %&gt;%
  last_fit(split = bank_split)
bank_final_fit %&gt;%
  collect_metrics()</code></pre>
<pre><code>## # A tibble: 2 x 4
##   .metric  .estimator .estimate .config             
##   &lt;chr&gt;    &lt;chr&gt;          &lt;dbl&gt; &lt;chr&gt;               
## 1 accuracy binary         0.936 Preprocessor1_Model1
## 2 roc_auc  binary         0.844 Preprocessor1_Model1</code></pre>
<p>We can see here this model is good to predict and ready to use the same model to predic anynew data set. Its accuracy is 0.94 and roc_auc is 0.88</p>
</div>
<div id="model-evaluation" class="section level1">
<h1>Model evaluation</h1>
<pre class="r"><code>bank_wkfl_fit_results  %&gt;%
  conf_mat(truth = y, estimate = .pred_class)</code></pre>
<pre><code>##           Truth
## Prediction   0   1
##          0 220  11
##          1   4   1</code></pre>
</div>
<div id="correct-predictions-1" class="section level1">
<h1>Correct predictions</h1>
<p>True negative is 220, which is the customer did not subscibe to term deposit
True positive is 3, which is the customers subscripe to term deposit</p>
</div>
<div id="classification-error-1" class="section level1">
<h1>Classification error</h1>
<p>False negative is 3, which is the customer did not subscribe to term deposit but wrongly predicted as subscriped
False positive is 10, which is the customer subscribed to term deposit but wronly predicted as not subscribed</p>
<p>It is clear that the customers will not subscribe to the term deposit</p>
<p>Converting character to factor to run logistic regression so that I can run below the manual logistic regression using glm function</p>
<pre class="r"><code>bank$default &lt;- as.factor (bank$default)
bank$housing &lt;- as.factor (bank$housing)
bank$loan &lt;- as.factor (bank$loan)
bank$y &lt;-  as.factor (bank$y)
bank$month &lt;- as.factor (bank$month)
bank$job &lt;- as.factor (bank$job)
bank$marital &lt;- as.factor (bank$marital)
bank$education &lt;- as.factor (bank$education)
bank$poutcome &lt;- as.factor (bank$poutcome)
bank$contact &lt;- as.factor (bank$contact)</code></pre>
</div>
<div id="structure-of-bank-after-applying-factor" class="section level1">
<h1>Structure of bank after applying factor</h1>
<pre class="r"><code>str(bank)</code></pre>
<pre><code>## &#39;data.frame&#39;:    944 obs. of  15 variables:
##  $ age      : int  39 41 43 40 31 42 44 44 53 31 ...
##  $ job      : Factor w/ 4 levels &quot;blue-collar&quot;,..: 4 3 3 2 3 2 3 3 3 4 ...
##  $ marital  : Factor w/ 3 levels &quot;divorced&quot;,&quot;married&quot;,..: 2 2 2 2 2 1 3 2 2 2 ...
##  $ education: Factor w/ 3 levels &quot;primary and others&quot;,..: 2 3 2 3 2 3 2 2 2 2 ...
##  $ default  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ balance  : int  147 221 264 194 132 16 106 93 105 171 ...
##  $ housing  : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 2 2 2 1 1 1 1 1 1 1 ...
##  $ loan     : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 2 1 1 1 1 2 1 ...
##  $ contact  : Factor w/ 2 levels &quot;cellular&quot;,&quot;telephone and others&quot;: 1 2 1 1 1 1 2 1 1 1 ...
##  $ day      : int  6 14 17 29 7 19 12 7 21 27 ...
##  $ month    : Factor w/ 11 levels &quot;1&quot;,&quot;10&quot;,&quot;11&quot;,..: 7 7 6 10 9 3 8 9 10 10 ...
##  $ duration : int  151 57 113 189 148 140 109 125 74 81 ...
##  $ campaign : int  2 2 2 2 1 3 2 2 2 3 ...
##  $ poutcome : Factor w/ 3 levels &quot;failure&quot;,&quot;success and others&quot;,..: 3 3 3 3 2 3 3 3 3 3 ...
##  $ y        : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="summary-after-changing-the-factor-variable" class="section level1">
<h1>Summary after changing the factor variable</h1>
<pre class="r"><code>summary(bank)</code></pre>
<pre><code>##       age                 job          marital                 education  
##  Min.   :19.00   blue-collar:189   divorced:117   primary and others:189  
##  1st Qu.:32.00   management :157   married :566   secondary         :507  
##  Median :38.00   Others     :420   single  :261   tertiary          :248  
##  Mean   :39.96   technician :178                                          
##  3rd Qu.:47.00                                                            
##  Max.   :73.00                                                            
##                                                                           
##  default    balance       housing loan                    contact   
##  0:926   Min.   :  1.00   0:438   0:785   cellular            :635  
##  1: 18   1st Qu.: 43.75   1:506   1:159   telephone and others:309  
##          Median :108.50                                             
##          Mean   :117.18                                             
##          3rd Qu.:186.00                                             
##          Max.   :272.00                                             
##                                                                     
##       day            month        duration      campaign    
##  Min.   : 1.00   5      :325   Min.   :  5   Min.   :1.000  
##  1st Qu.: 8.00   7      :154   1st Qu.: 95   1st Qu.:1.000  
##  Median :15.00   8      :151   Median :161   Median :2.000  
##  Mean   :15.28   6      : 88   Mean   :190   Mean   :2.144  
##  3rd Qu.:21.00   11     : 57   3rd Qu.:253   3rd Qu.:3.000  
##  Max.   :31.00   2      : 51   Max.   :590   Max.   :6.000  
##                  (Other):118                                
##                poutcome   y      
##  failure           :109   0:881  
##  success and others: 63   1: 63  
##  unknown           :772          
##                                  
##                                  
##                                  
## </code></pre>
</div>
<div id="best-subset-regression" class="section level1">
<h1>Best subset regression</h1>
<pre class="r"><code>best&lt;-regsubsets(y~ ., data= bank, nvmax= 14)
summary(best)</code></pre>
<pre><code>## Subset selection object
## Call: regsubsets.formula(y ~ ., data = bank, nvmax = 14)
## 28 Variables  (and intercept)
##                             Forced in Forced out
## age                             FALSE      FALSE
## jobmanagement                   FALSE      FALSE
## jobOthers                       FALSE      FALSE
## jobtechnician                   FALSE      FALSE
## maritalmarried                  FALSE      FALSE
## maritalsingle                   FALSE      FALSE
## educationsecondary              FALSE      FALSE
## educationtertiary               FALSE      FALSE
## default1                        FALSE      FALSE
## balance                         FALSE      FALSE
## housing1                        FALSE      FALSE
## loan1                           FALSE      FALSE
## contacttelephone and others     FALSE      FALSE
## day                             FALSE      FALSE
## month10                         FALSE      FALSE
## month11                         FALSE      FALSE
## month2                          FALSE      FALSE
## month3                          FALSE      FALSE
## month4                          FALSE      FALSE
## month5                          FALSE      FALSE
## month6                          FALSE      FALSE
## month7                          FALSE      FALSE
## month8                          FALSE      FALSE
## month9                          FALSE      FALSE
## duration                        FALSE      FALSE
## campaign                        FALSE      FALSE
## poutcomesuccess and others      FALSE      FALSE
## poutcomeunknown                 FALSE      FALSE
## 1 subsets of each size up to 14
## Selection Algorithm: exhaustive
##           age jobmanagement jobOthers jobtechnician maritalmarried
## 1  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 2  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 3  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 4  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 5  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 6  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 7  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 8  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 9  ( 1 )  &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 10  ( 1 ) &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 11  ( 1 ) &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 12  ( 1 ) &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 13  ( 1 ) &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
## 14  ( 1 ) &quot; &quot; &quot; &quot;           &quot; &quot;       &quot; &quot;           &quot; &quot;           
##           maritalsingle educationsecondary educationtertiary default1 balance
## 1  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 2  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 3  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 4  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 5  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 6  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 7  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 8  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 9  ( 1 )  &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot; &quot;      &quot; &quot;    
## 10  ( 1 ) &quot; &quot;           &quot; &quot;                &quot; &quot;               &quot;*&quot;      &quot; &quot;    
## 11  ( 1 ) &quot;*&quot;           &quot; &quot;                &quot; &quot;               &quot;*&quot;      &quot; &quot;    
## 12  ( 1 ) &quot;*&quot;           &quot; &quot;                &quot; &quot;               &quot;*&quot;      &quot; &quot;    
## 13  ( 1 ) &quot;*&quot;           &quot; &quot;                &quot; &quot;               &quot;*&quot;      &quot; &quot;    
## 14  ( 1 ) &quot;*&quot;           &quot; &quot;                &quot; &quot;               &quot;*&quot;      &quot; &quot;    
##           housing1 loan1 contacttelephone and others day month10 month11 month2
## 1  ( 1 )  &quot; &quot;      &quot; &quot;   &quot; &quot;                         &quot; &quot; &quot; &quot;     &quot; &quot;     &quot; &quot;   
## 2  ( 1 )  &quot; &quot;      &quot; &quot;   &quot; &quot;                         &quot; &quot; &quot; &quot;     &quot; &quot;     &quot; &quot;   
## 3  ( 1 )  &quot; &quot;      &quot; &quot;   &quot; &quot;                         &quot; &quot; &quot; &quot;     &quot; &quot;     &quot; &quot;   
## 4  ( 1 )  &quot; &quot;      &quot; &quot;   &quot; &quot;                         &quot; &quot; &quot; &quot;     &quot; &quot;     &quot; &quot;   
## 5  ( 1 )  &quot; &quot;      &quot; &quot;   &quot; &quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 6  ( 1 )  &quot; &quot;      &quot; &quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 7  ( 1 )  &quot; &quot;      &quot; &quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 8  ( 1 )  &quot; &quot;      &quot; &quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 9  ( 1 )  &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 10  ( 1 ) &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 11  ( 1 ) &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 12  ( 1 ) &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 13  ( 1 ) &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
## 14  ( 1 ) &quot; &quot;      &quot;*&quot;   &quot;*&quot;                         &quot; &quot; &quot;*&quot;     &quot; &quot;     &quot; &quot;   
##           month3 month4 month5 month6 month7 month8 month9 duration campaign
## 1  ( 1 )  &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 2  ( 1 )  &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 3  ( 1 )  &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 4  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 5  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 6  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 7  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;      &quot; &quot;     
## 8  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;      &quot; &quot;     
## 9  ( 1 )  &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;      &quot; &quot;     
## 10  ( 1 ) &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;      &quot; &quot;     
## 11  ( 1 ) &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;      &quot; &quot;     
## 12  ( 1 ) &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;      &quot; &quot;     
## 13  ( 1 ) &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;    &quot;*&quot;      &quot;*&quot;     
## 14  ( 1 ) &quot;*&quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot; &quot;    &quot;*&quot;    &quot;*&quot;    &quot;*&quot;      &quot;*&quot;     
##           poutcomesuccess and others poutcomeunknown
## 1  ( 1 )  &quot; &quot;                        &quot; &quot;            
## 2  ( 1 )  &quot; &quot;                        &quot; &quot;            
## 3  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 4  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 5  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 6  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 7  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 8  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 9  ( 1 )  &quot;*&quot;                        &quot; &quot;            
## 10  ( 1 ) &quot;*&quot;                        &quot; &quot;            
## 11  ( 1 ) &quot;*&quot;                        &quot; &quot;            
## 12  ( 1 ) &quot;*&quot;                        &quot;*&quot;            
## 13  ( 1 ) &quot;*&quot;                        &quot; &quot;            
## 14  ( 1 ) &quot;*&quot;                        &quot;*&quot;</code></pre>
</div>
<div id="logistic-regression-on-full-model" class="section level1">
<h1>Logistic regression on full model</h1>
<pre class="r"><code>fullmodel = glm(y~., data = bank, family = &quot;binomial&quot;)
summary(fullmodel)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ ., family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.29979  -0.27914  -0.16943  -0.08596   3.09433  
## 
## Coefficients:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -2.089e+01  9.786e+02  -0.021  0.98297    
## age                         -1.254e-02  2.016e-02  -0.622  0.53380    
## jobmanagement                5.743e-01  7.577e-01   0.758  0.44845    
## jobOthers                    9.508e-01  5.885e-01   1.616  0.10617    
## jobtechnician                9.533e-01  6.572e-01   1.451  0.14690    
## maritalmarried               2.258e-01  5.553e-01   0.407  0.68426    
## maritalsingle                5.491e-01  6.174e-01   0.889  0.37382    
## educationsecondary           8.794e-02  5.411e-01   0.163  0.87090    
## educationtertiary            2.786e-01  6.181e-01   0.451  0.65213    
## default1                     1.255e+00  8.568e-01   1.464  0.14306    
## balance                      2.947e-04  1.946e-03   0.151  0.87963    
## housing1                    -1.667e-01  3.854e-01  -0.433  0.66535    
## loan1                       -1.210e+00  6.441e-01  -1.879  0.06023 .  
## contacttelephone and others -1.890e+00  6.157e-01  -3.069  0.00215 ** 
## day                          1.438e-02  2.306e-02   0.624  0.53290    
## month10                      1.818e+01  9.786e+02   0.019  0.98518    
## month11                      1.551e+01  9.786e+02   0.016  0.98736    
## month2                       1.586e+01  9.786e+02   0.016  0.98707    
## month3                       1.894e+01  9.786e+02   0.019  0.98456    
## month4                       1.730e+01  9.786e+02   0.018  0.98589    
## month5                       1.562e+01  9.786e+02   0.016  0.98727    
## month6                       1.736e+01  9.786e+02   0.018  0.98585    
## month7                       1.479e+01  9.786e+02   0.015  0.98794    
## month8                       1.588e+01  9.786e+02   0.016  0.98706    
## month9                       1.666e+01  9.786e+02   0.017  0.98642    
## duration                     5.833e-03  1.084e-03   5.383 7.34e-08 ***
## campaign                    -2.178e-01  1.589e-01  -1.371  0.17036    
## poutcomesuccess and others   2.071e+00  6.686e-01   3.097  0.00195 ** 
## poutcomeunknown              6.297e-01  5.851e-01   1.076  0.28177    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 299.15  on 915  degrees of freedom
## AIC: 357.15
## 
## Number of Fisher Scoring iterations: 17</code></pre>
<p>The full model is not good as many of the coefficients are not significant</p>
<p>After a many trials, the following is the best model</p>
</div>
<div id="backward-regression" class="section level1">
<h1>Backward regression</h1>
<p>The following is the best model by backward regression</p>
<pre class="r"><code>mod_step&lt;- stepAIC(fullmodel, direction = &#39;backward&#39;, trace = FALSE)
mod_step</code></pre>
<pre><code>## 
## Call:  glm(formula = y ~ default + loan + contact + month + duration + 
##     campaign + poutcome, family = &quot;binomial&quot;, data = bank)
## 
## Coefficients:
##                 (Intercept)                     default1  
##                  -19.610827                     1.271180  
##                       loan1  contacttelephone and others  
##                   -1.202972                    -1.961554  
##                     month10                      month11  
##                   18.046599                    15.121627  
##                      month2                       month3  
##                   15.574634                    18.660513  
##                      month4                       month5  
##                   17.025514                    15.127680  
##                      month6                       month7  
##                   16.971346                    14.538569  
##                      month8                       month9  
##                   15.682285                    17.041161  
##                    duration                     campaign  
##                    0.005898                    -0.249001  
##  poutcomesuccess and others              poutcomeunknown  
##                    1.897647                     0.620638  
## 
## Degrees of Freedom: 943 Total (i.e. Null);  926 Residual
## Null Deviance:       462.8 
## Residual Deviance: 307.3     AIC: 343.3</code></pre>
</div>
<div id="bootstrap" class="section level1">
<h1>Bootstrap</h1>
<p>Using bootstrap resampling with relacement method to access the consistency predictors selected with stepwise</p>
<pre class="r"><code>print(mod_boot)</code></pre>
<pre><code>## 
## Summary of Bootstrapping the &#39;stepAIC()&#39; procedure for
## 
## Call:
## glm(formula = y ~ ., family = &quot;binomial&quot;, data = bank)
## 
## Bootstrap samples: 50 
## Direction: backward 
## Penalty: 2 * df
## 
## Covariates selected
##           (%)
## duration  100
## month     100
## contact    98
## loan       88
## poutcome   84
## job        64
## campaign   48
## housing    48
## default    40
## age        34
## marital    30
## day        28
## education  24
## balance    18
## 
## Coefficients Sign
##                              + (%)  - (%)
## duration                    100.00   0.00
## jobOthers                   100.00   0.00
## month10                     100.00   0.00
## month2                      100.00   0.00
## month4                      100.00   0.00
## month5                      100.00   0.00
## month6                      100.00   0.00
## month7                      100.00   0.00
## month8                      100.00   0.00
## poutcomesuccess and others  100.00   0.00
## month3                       98.00   2.00
## month11                      96.00   4.00
## default1                     95.00   5.00
## jobtechnician                93.75   6.25
## month9                       90.00  10.00
## maritalsingle                86.67  13.33
## educationtertiary            83.33  16.67
## jobmanagement                81.25  18.75
## poutcomeunknown              80.95  19.05
## day                          78.57  21.43
## maritalmarried               73.33  26.67
## educationsecondary           66.67  33.33
## balance                      44.44  55.56
## housing1                     20.83  79.17
## age                          17.65  82.35
## campaign                      0.00 100.00
## contacttelephone and others   0.00 100.00
## loan1                         0.00 100.00
## 
## Stat Significance
##                                (%)
## duration                    100.00
## contacttelephone and others  93.88
## poutcomesuccess and others   90.48
## jobOthers                    75.00
## age                          70.59
## jobtechnician                62.50
## default1                     60.00
## maritalsingle                60.00
## loan1                        56.82
## day                          50.00
## campaign                     41.67
## educationtertiary            41.67
## housing1                     41.67
## jobmanagement                40.62
## balance                      33.33
## educationsecondary           16.67
## poutcomeunknown              16.67
## maritalmarried               13.33
## month10                       0.00
## month11                       0.00
## month2                        0.00
## month3                        0.00
## month4                        0.00
## month5                        0.00
## month6                        0.00
## month7                        0.00
## month8                        0.00
## month9                        0.00
## 
## 
## The stepAIC() for the original data-set gave
## 
## Call:  glm(formula = y ~ default + loan + contact + month + duration + 
##     campaign + poutcome, family = &quot;binomial&quot;, data = bank)
## 
## Coefficients:
##                 (Intercept)                     default1  
##                  -19.610827                     1.271180  
##                       loan1  contacttelephone and others  
##                   -1.202972                    -1.961554  
##                     month10                      month11  
##                   18.046599                    15.121627  
##                      month2                       month3  
##                   15.574634                    18.660513  
##                      month4                       month5  
##                   17.025514                    15.127680  
##                      month6                       month7  
##                   16.971346                    14.538569  
##                      month8                       month9  
##                   15.682285                    17.041161  
##                    duration                     campaign  
##                    0.005898                    -0.249001  
##  poutcomesuccess and others              poutcomeunknown  
##                    1.897647                     0.620638  
## 
## Degrees of Freedom: 943 Total (i.e. Null);  926 Residual
## Null Deviance:       462.8 
## Residual Deviance: 307.3     AIC: 343.3
## 
## Stepwise Model Path 
## Analysis of Deviance Table
## 
## Initial Model:
## y ~ age + job + marital + education + default + balance + housing + 
##     loan + contact + day + month + duration + campaign + poutcome
## 
## Final Model:
## y ~ default + loan + contact + month + duration + campaign + 
##     poutcome
## 
## 
##          Step Df  Deviance Resid. Df Resid. Dev      AIC
## 1                                915   299.1494 357.1494
## 2 - education  2 0.2662136       917   299.4156 353.4156
## 3   - marital  2 0.9848868       919   300.4005 350.4005
## 4   - balance  1 0.0127710       920   300.4132 348.4132
## 5   - housing  1 0.3485095       921   300.7617 346.7617
## 6       - job  3 4.4161489       924   305.1779 345.1779
## 7       - day  1 0.6648733       925   305.8428 343.8428
## 8       - age  1 1.4999372       926   307.3427 343.3427</code></pre>
<pre class="r"><code>best_bootmodel &lt;- glm(y ~ default + loan + contact + month + duration + campaign + poutcome, data = bank, family = &quot;binomial&quot;)
summary(best_bootmodel)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ default + loan + contact + month + duration + 
##     campaign + poutcome, family = &quot;binomial&quot;, data = bank)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.08779  -0.28936  -0.18286  -0.09143   3.04509  
## 
## Coefficients:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -19.610827 992.438640  -0.020  0.98423    
## default1                      1.271180   0.796819   1.595  0.11064    
## loan1                        -1.202972   0.630718  -1.907  0.05648 .  
## contacttelephone and others  -1.961554   0.599162  -3.274  0.00106 ** 
## month10                      18.046599 992.438716   0.018  0.98549    
## month11                      15.121627 992.438662   0.015  0.98784    
## month2                       15.574634 992.438606   0.016  0.98748    
## month3                       18.660513 992.438811   0.019  0.98500    
## month4                       17.025514 992.438538   0.017  0.98631    
## month5                       15.127680 992.438533   0.015  0.98784    
## month6                       16.971346 992.438602   0.017  0.98636    
## month7                       14.538569 992.438648   0.015  0.98831    
## month8                       15.682285 992.438528   0.016  0.98739    
## month9                       17.041161 992.438920   0.017  0.98630    
## duration                      0.005898   0.001061   5.556 2.76e-08 ***
## campaign                     -0.249001   0.159972  -1.557  0.11958    
## poutcomesuccess and others    1.897647   0.634094   2.993  0.00277 ** 
## poutcomeunknown               0.620638   0.557923   1.112  0.26596    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 307.34  on 926  degrees of freedom
## AIC: 343.34
## 
## Number of Fisher Scoring iterations: 17</code></pre>
</div>
<div id="odds-ratio" class="section level1">
<h1>Odds ratio</h1>
<pre class="r"><code>bank_or &lt;- data.frame(exp(best_bootmodel$coefficients))
bank_or</code></pre>
<pre><code>##                             exp.best_bootmodel.coefficients.
## (Intercept)                                     3.041766e-09
## default1                                        3.565058e+00
## loan1                                           3.003004e-01
## contacttelephone and others                     1.406396e-01
## month10                                         6.879206e+07
## month11                                         3.691809e+06
## month2                                          5.807343e+06
## month3                                          1.271035e+08
## month4                                          2.477917e+07
## month5                                          3.714224e+06
## month6                                          2.347264e+07
## month7                                          2.060726e+06
## month8                                          6.467400e+06
## month9                                          2.516995e+07
## duration                                        1.005915e+00
## campaign                                        7.795791e-01
## poutcomesuccess and others                      6.670183e+00
## poutcomeunknown                                 1.860114e+00</code></pre>
</div>
<div id="produce-percentage-odds" class="section level1">
<h1>produce percentage odds</h1>
<pre class="r"><code>bank_or_perc&lt;- (bank_or-1)*100
bank_or_perc</code></pre>
<pre><code>##                             exp.best_bootmodel.coefficients.
## (Intercept)                                    -1.000000e+02
## default1                                        2.565058e+02
## loan1                                          -6.996996e+01
## contacttelephone and others                    -8.593604e+01
## month10                                         6.879206e+09
## month11                                         3.691808e+08
## month2                                          5.807342e+08
## month3                                          1.271035e+10
## month4                                          2.477917e+09
## month5                                          3.714223e+08
## month6                                          2.347264e+09
## month7                                          2.060725e+08
## month8                                          6.467399e+08
## month9                                          2.516994e+09
## duration                                        5.915226e-01
## campaign                                       -2.204209e+01
## poutcomesuccess and others                      5.670183e+02
## poutcomeunknown                                 8.601140e+01</code></pre>
<pre class="r"><code>predict(best_bootmodel, bank, type =&quot;response&quot;)</code></pre>
<pre><code>##            8            9           12           16           20           22 
## 3.017962e-02 2.507667e-03 1.423110e-01 1.995351e-02 7.237690e-02 2.209905e-02 
##           23           24           30           32           33           47 
## 2.113341e-02 1.459465e-02 1.022703e-02 2.719405e-02 2.020028e-02 1.099636e-02 
##           53           57           59           66           72           77 
## 3.812835e-02 2.464272e-03 4.389556e-03 1.904274e-02 7.170954e-02 2.851597e-01 
##           80           82           83           91           98          113 
## 2.222523e-02 3.123915e-02 1.177639e-02 3.988293e-02 3.919692e-01 6.496358e-03 
##          114          119          120          127          129          131 
## 2.894085e-09 4.109294e-02 2.401164e-01 2.065764e-02 5.438836e-03 2.895367e-02 
##          146          149          151          159          161          172 
## 1.763939e-01 2.352948e-08 1.264087e-02 1.188058e-08 4.330700e-02 1.529028e-08 
##          178          181          184          188          189          196 
## 1.607676e-02 1.848102e-02 3.217980e-02 1.392709e-01 1.654995e-02 4.266382e-02 
##          198          229          231          233          236          238 
## 9.257038e-03 1.698272e-02 1.565235e-02 1.662505e-02 1.269115e-01 4.980943e-03 
##          255          258          261          272          280          284 
## 3.269906e-02 2.654342e-02 4.813492e-03 8.000684e-02 1.090617e-01 1.113576e-03 
##          285          289          290          306          314          317 
## 1.322232e-02 2.070388e-02 3.650441e-02 2.803768e-02 9.751748e-02 3.441372e-02 
##          323          325          331          333          346          352 
## 2.056541e-03 1.164068e-02 2.971015e-03 5.956200e-03 1.003376e-02 1.437140e-01 
##          354          356          357          372          385          386 
## 3.158458e-02 2.139306e-03 2.400288e-03 2.598015e-01 1.737041e-02 1.712613e-01 
##          395          399          403          408          412          419 
## 4.639402e-02 1.466066e-03 2.921653e-02 2.279250e-02 1.614458e-01 1.875577e-02 
##          432          433          434          435          437          440 
## 1.616191e-01 4.049741e-02 2.162397e-02 4.325204e-03 2.115879e-02 9.595583e-02 
##          442          449          450          454          456          460 
## 1.924133e-02 1.513167e-02 4.496088e-02 7.818130e-02 5.453179e-03 1.735772e-02 
##          473          477          482          485          494          499 
## 6.204698e-02 3.490126e-03 2.430320e-03 1.351358e-01 7.491265e-02 9.802503e-02 
##          503          504          507          511          513          514 
## 1.975971e-02 1.291646e-02 2.447289e-03 1.101592e-02 4.798561e-02 3.026969e-03 
##          524          528          531          532          535          538 
## 8.892329e-02 1.959091e-02 3.710011e-02 1.498805e-03 1.875904e-01 6.696890e-03 
##          544          547          551          566          567          571 
## 3.531391e-03 2.226141e-01 3.561099e-02 2.235888e-09 7.220348e-09 1.256747e-02 
##          575          579          582          583          585          586 
## 3.812060e-02 5.877357e-02 3.602939e-01 1.457457e-03 1.005223e-02 8.295096e-03 
##          588          597          598          601          602          606 
## 2.259598e-03 1.655339e-02 3.133950e-02 3.499098e-02 1.260965e-03 1.995351e-02 
##          611          612          613          614          617          618 
## 4.108925e-03 3.838765e-02 2.524887e-02 1.506027e-01 5.718141e-02 3.967166e-02 
##          626          629          638          647          649          650 
## 2.871449e-03 5.111366e-02 3.453047e-02 3.922470e-02 2.942277e-02 2.762935e-02 
##          652          653          655          658          659          663 
## 4.215518e-02 2.659607e-03 1.658749e-02 8.003325e-01 2.071226e-01 2.407529e-01 
##          669          673          676          677          678          679 
## 2.955295e-02 2.174580e-02 1.022996e-01 3.757500e-03 2.077705e-02 2.677865e-02 
##          681          682          685          690          694          696 
## 2.473428e-01 1.648273e-02 6.359199e-01 1.550982e-03 1.393140e-02 2.664242e-03 
##          701          707          711          712          713          717 
## 2.605044e-02 1.192148e-01 1.512272e-02 1.677660e-02 2.283439e-08 4.430805e-02 
##          723          730          735          737          746          750 
## 3.133352e-02 3.789928e-02 4.645462e-02 4.672598e-02 8.810113e-04 4.138458e-03 
##          754          758          760          774          775          776 
## 2.754247e-02 1.165887e-01 2.622826e-01 1.941483e-02 4.197914e-04 5.262026e-02 
##          780          784          785          796          798          809 
## 1.677222e-02 1.933114e-03 4.669521e-03 3.258977e-03 7.964637e-02 6.839060e-02 
##          812          813          817          820          822          829 
## 1.897409e-02 1.120015e-08 2.228654e-02 1.026565e-01 2.668917e-02 3.283089e-09 
##          833          837          845          852          854          859 
## 1.230302e-01 2.079680e-02 1.076059e-02 2.567657e-02 3.403717e-03 8.295712e-02 
##          860          869          870          879          880          881 
## 1.841115e-02 1.148160e-01 1.387934e-03 1.369919e-02 7.769367e-04 8.530376e-01 
##          882          883          884          894          897          902 
## 8.851666e-02 1.258692e-02 1.516448e-03 5.504297e-09 4.634864e-01 8.873714e-03 
##          904          906          907          908          915          917 
## 2.034294e-01 1.485130e-02 4.881539e-01 1.143039e-02 3.664280e-02 7.212982e-02 
##          919          921          922          938          941          943 
## 3.313024e-02 2.688374e-02 2.152407e-01 1.933591e-02 2.272448e-01 5.403641e-02 
##          950          954          958          961          965          972 
## 4.640670e-02 9.094379e-02 4.018684e-03 8.130074e-03 3.310387e-02 1.386829e-02 
##          976          978          979          984         1001         1005 
## 7.286036e-01 2.195204e-02 1.268082e-01 2.727469e-02 1.893906e-01 7.148792e-02 
##         1007         1010         1012         1014         1028         1030 
## 3.475872e-02 4.667995e-03 1.446923e-02 3.532565e-02 1.097184e-02 5.651487e-02 
##         1039         1043         1045         1050         1053         1080 
## 8.856264e-04 5.671828e-02 4.466873e-02 4.105999e-02 3.971291e-02 1.157047e-02 
##         1082         1083         1085         1090         1097         1107 
## 2.335947e-02 2.847047e-02 1.238143e-03 1.392558e-03 1.188976e-01 7.045701e-03 
##         1109         1110         1124         1125         1129         1130 
## 7.271832e-02 1.047463e-01 1.072507e-01 8.157920e-01 5.676087e-02 1.733567e-02 
##         1134         1135         1147         1152         1156         1158 
## 2.731189e-03 1.419465e-02 3.561594e-02 8.217923e-02 4.533760e-02 4.391975e-02 
##         1160         1161         1163         1179         1183         1188 
## 2.412623e-02 3.041413e-02 2.858296e-03 1.083071e-02 4.703063e-03 4.536467e-02 
##         1190         1192         1196         1208         1211         1218 
## 3.125298e-02 1.110552e-08 5.517048e-02 1.232462e-03 3.520326e-02 1.203107e-03 
##         1223         1225         1226         1227         1228         1234 
## 7.693292e-03 3.035470e-02 1.926433e-02 5.837742e-02 4.736846e-03 4.013510e-03 
##         1235         1237         1238         1239         1241         1247 
## 1.507657e-03 9.483658e-03 2.788949e-02 5.256391e-03 1.536677e-02 4.228929e-02 
##         1249         1257         1262         1271         1281         1291 
## 3.234232e-02 5.809085e-03 4.794815e-04 4.312136e-03 7.309830e-03 1.228186e-01 
##         1292         1295         1296         1314         1318         1321 
## 1.003661e-02 3.966633e-03 1.041055e-02 4.599834e-03 1.172609e-08 8.791572e-03 
##         1322         1324         1325         1328         1329         1332 
## 1.409022e-01 1.034235e-02 2.915441e-02 1.228301e-03 4.414619e-03 1.322072e-02 
##         1333         1340         1341         1345         1346         1349 
## 2.322341e-01 9.709324e-09 6.504401e-02 4.924548e-01 1.176831e-01 8.761789e-02 
##         1352         1362         1368         1372         1381         1382 
## 3.088298e-09 1.838146e-08 1.711892e-02 6.839356e-01 1.825053e-02 3.686779e-02 
##         1387         1390         1406         1409         1411         1444 
## 3.225911e-01 6.665611e-02 5.011812e-02 7.045649e-03 3.327923e-03 9.959742e-02 
##         1445         1449         1456         1464         1466         1467 
## 4.410140e-02 3.356185e-03 6.735709e-09 3.943399e-03 5.384109e-03 6.003727e-03 
##         1470         1473         1477         1486         1488         1498 
## 8.110353e-01 1.088539e-02 4.460456e-02 3.313534e-01 1.807468e-02 1.220346e-02 
##         1506         1515         1516         1517         1518         1521 
## 2.850228e-02 8.227970e-03 3.492451e-03 6.580214e-03 9.318986e-10 1.283376e-01 
##         1523         1528         1529         1533         1539         1544 
## 1.066326e-02 9.510549e-03 8.179732e-02 5.594633e-02 3.771722e-02 8.230237e-03 
##         1550         1552         1557         1565         1570         1571 
## 2.140448e-02 1.312090e-02 7.404330e-03 2.289920e-03 7.900416e-10 1.899981e-02 
##         1572         1578         1587         1596         1597         1603 
## 1.524888e-01 3.339915e-03 3.141813e-02 5.285748e-02 1.755366e-02 3.601435e-03 
##         1605         1609         1617         1620         1622         1625 
## 9.693703e-03 7.410747e-03 1.115124e-02 6.133364e-03 3.207727e-03 2.130433e-01 
##         1630         1631         1632         1633         1641         1642 
## 1.222234e-02 1.135310e-02 9.197186e-03 3.868626e-02 4.935512e-03 3.932058e-01 
##         1660         1665         1677         1678         1696         1697 
## 1.326041e-02 1.286361e-02 2.895591e-02 2.511942e-02 7.512781e-01 2.140448e-02 
##         1698         1708         1709         1710         1718         1721 
## 5.567197e-02 2.027577e-03 1.724808e-02 6.278295e-01 4.646414e-02 8.126447e-03 
##         1722         1728         1732         1737         1743         1744 
## 1.206728e-01 2.672987e-02 2.220673e-02 2.735902e-01 1.853665e-02 3.068387e-02 
##         1749         1758         1762         1763         1766         1789 
## 1.795933e-01 1.115016e-03 4.961022e-04 6.588776e-01 4.181966e-03 2.970524e-02 
##         1793         1798         1799         1800         1815         1816 
## 3.668102e-02 3.403038e-02 8.920874e-03 3.344887e-02 2.673121e-01 2.272479e-02 
##         1820         1830         1838         1840         1844         1846 
## 1.694942e-02 3.872902e-02 5.094479e-01 5.414065e-02 2.643239e-01 9.489532e-03 
##         1861         1873         1876         1884         1886         1893 
## 1.722155e-02 7.157394e-01 1.592195e-02 4.777849e-02 7.087885e-02 9.820165e-03 
##         1894         1896         1898         1902         1910         1912 
## 2.079188e-02 1.437732e-08 1.167222e-08 1.251046e-02 1.414045e-02 1.018017e-03 
##         1931         1939         1941         1944         1961         1965 
## 8.949680e-04 5.258748e-03 8.389843e-01 1.751606e-09 1.651021e-02 5.167844e-02 
##         1967         1970         1974         1984         1986         1998 
## 2.806806e-02 9.194013e-02 3.465525e-02 1.598374e-02 5.032408e-02 7.173335e-03 
##         2001         2013         2020         2024         2025         2029 
## 2.225673e-02 2.001484e-02 9.190411e-03 3.567575e-03 2.274884e-02 2.935480e-03 
##         2031         2032         2042         2044         2051         2058 
## 1.940338e-02 1.771006e-02 3.577557e-01 1.483501e-02 2.159662e-02 6.641866e-03 
##         2059         2068         2070         2075         2078         2081 
## 3.776166e-02 1.262114e-01 1.285032e-01 1.276343e-02 7.482132e-01 2.837507e-02 
##         2083         2094         2095         2098         2099         2113 
## 6.634506e-02 1.173382e-02 4.331975e-02 1.431560e-02 3.702884e-01 1.344445e-01 
##         2116         2128         2134         2136         2154         2162 
## 8.950763e-02 3.367996e-02 4.288660e-02 4.887313e-02 2.560527e-02 4.752044e-02 
##         2172         2181         2182         2184         2193         2196 
## 1.098058e-02 1.805449e-02 1.807610e-02 4.619714e-03 4.004591e-03 1.812031e-02 
##         2198         2200         2205         2207         2224         2226 
## 2.180614e-03 8.749837e-03 7.089814e-03 2.298823e-02 1.586801e-03 4.349885e-01 
##         2227         2232         2235         2236         2243         2245 
## 2.163971e-02 3.585110e-02 2.986925e-02 4.196290e-03 6.788392e-03 4.506684e-03 
##         2246         2247         2248         2251         2252         2263 
## 3.004515e-02 1.626872e-02 8.707373e-04 4.391147e-02 2.147623e-01 2.269017e-02 
##         2268         2272         2291         2294         2295         2298 
## 1.529941e-02 2.645063e-02 4.542134e-02 7.768147e-03 2.759001e-02 1.551856e-01 
##         2301         2302         2305         2306         2307         2313 
## 3.727252e-02 2.852390e-02 4.372682e-02 1.480952e-02 4.276852e-09 3.026969e-03 
##         2319         2322         2323         2324         2331         2341 
## 2.608831e-01 4.230755e-02 3.897170e-02 3.257654e-02 2.102412e-02 3.282383e-01 
##         2344         2353         2358         2369         2370         2374 
## 6.395767e-09 1.894175e-02 2.140249e-01 2.657246e-01 1.020092e-02 4.947524e-02 
##         2377         2378         2383         2385         2396         2400 
## 2.872172e-01 5.243430e-02 6.964462e-03 4.178736e-02 3.860346e-02 1.761545e-01 
##         2401         2408         2414         2416         2419         2429 
## 9.352541e-02 2.111546e-03 2.076911e-02 2.026011e-01 3.418206e-02 1.515769e-02 
##         2430         2433         2437         2440         2443         2444 
## 1.590905e-02 2.130077e-02 5.561064e-01 3.584950e-03 6.088031e-03 2.284739e-01 
##         2446         2449         2458         2461         2484         2491 
## 3.157799e-02 2.003460e-01 1.050128e-01 1.319314e-08 3.007779e-02 4.058026e-02 
##         2494         2495         2514         2516         2518         2519 
## 4.391975e-02 4.107814e-03 4.648170e-03 1.675528e-02 6.975295e-03 3.492588e-02 
##         2526         2535         2537         2540         2542         2543 
## 3.676219e-08 2.775526e-02 2.512107e-09 1.352142e-01 3.647318e-02 2.471719e-02 
##         2550         2551         2560         2574         2581         2583 
## 1.405847e-02 4.368052e-03 8.678888e-03 1.904527e-03 1.988284e-03 3.792311e-01 
##         2589         2596         2597         2606         2609         2628 
## 4.672598e-02 2.166711e-02 2.462608e-02 1.624619e-03 1.229809e-01 1.426317e-03 
##         2642         2643         2644         2645         2651         2660 
## 2.034962e-01 1.180241e-02 4.499573e-04 1.163602e-01 7.352752e-03 1.534721e-02 
##         2661         2668         2684         2703         2704         2714 
## 2.052706e-02 7.016266e-03 3.179314e-02 1.962372e-03 4.481513e-03 1.386159e-01 
##         2720         2723         2731         2748         2751         2754 
## 1.066600e-01 3.336174e-01 5.636341e-03 3.191455e-03 1.540364e-01 3.369190e-03 
##         2755         2759         2764         2767         2769         2783 
## 7.970737e-04 8.300274e-02 5.102633e-03 3.556478e-02 7.016266e-03 1.857805e-03 
##         2788         2799         2804         2810         2811         2812 
## 2.173150e-02 2.609717e-03 1.812031e-02 4.269800e-02 1.446923e-02 1.321430e-01 
##         2815         2816         2823         2826         2834         2835 
## 6.858355e-02 3.236189e-02 1.817281e-01 3.321715e-02 4.838062e-02 4.293972e-02 
##         2839         2850         2855         2868         2871         2874 
## 4.358380e-03 1.164736e-02 1.042573e-02 2.846502e-02 3.403038e-02 9.538686e-03 
##         2877         2878         2879         2885         2886         2887 
## 2.833758e-02 1.589242e-02 3.794647e-02 2.564883e-02 6.570957e-02 7.215460e-03 
##         2896         2900         2902         2906         2911         2919 
## 1.732166e-02 1.408986e-01 2.663041e-03 2.105076e-02 7.348191e-03 9.066363e-02 
##         2924         2928         2931         2935         2942         2945 
## 1.220417e-01 7.257832e-03 2.805167e-02 1.609724e-02 9.709359e-04 7.770109e-01 
##         2946         2950         2952         2960         2965         2967 
## 3.074033e-02 1.342654e-02 8.517883e-03 8.675102e-02 5.167479e-03 2.236026e-02 
##         2971         2977         2979         2987         2988         2994 
## 3.622868e-02 3.389052e-03 1.368140e-02 3.351364e-01 3.524978e-02 3.084812e-03 
##         2995         3004         3010         3017         3019         3022 
## 1.281749e-02 5.836048e-02 3.333536e-02 3.565544e-02 9.355916e-03 4.473771e-01 
##         3027         3029         3038         3042         3045         3047 
## 3.257200e-02 3.745127e-03 2.670103e-02 1.657101e-02 2.374126e-02 6.374331e-03 
##         3048         3051         3058         3062         3069         3071 
## 7.028696e-09 1.487024e-02 2.675298e-03 3.422479e-02 4.221262e-02 1.669096e-02 
##         3078         3086         3088         3094         3098         3104 
## 1.893472e-02 2.738494e-02 2.684477e-02 2.199684e-09 1.878459e-02 7.825396e-04 
##         3107         3115         3117         3120         3121         3127 
## 1.690350e-01 3.907080e-01 4.975652e-02 1.088833e-09 6.060234e-03 1.319603e-02 
##         3129         3132         3137         3152         3163         3174 
## 1.926968e-03 6.361331e-02 4.363078e-03 2.309603e-02 5.958693e-02 2.220673e-02 
##         3175         3176         3184         3189         3191         3192 
## 3.121300e-03 1.796090e-01 4.061663e-03 8.265668e-03 5.842076e-01 3.764599e-02 
##         3195         3197         3198         3213         3218         3236 
## 6.883357e-03 2.943588e-03 1.953674e-02 1.983048e-03 3.137879e-02 4.267994e-02 
##         3241         3242         3243         3254         3262         3264 
## 1.514521e-03 6.113960e-03 8.134512e-03 1.188127e-03 6.425398e-02 1.373370e-01 
##         3267         3270         3271         3281         3287         3288 
## 5.106483e-02 3.920301e-03 4.284301e-02 2.616459e-03 1.360503e-03 1.825053e-02 
##         3294         3296         3304         3314         3316         3329 
## 2.972257e-02 1.474128e-01 9.631791e-02 1.411946e-01 3.557912e-01 3.181238e-02 
##         3335         3337         3338         3341         3358         3360 
## 1.101980e-01 2.043952e-02 1.133432e-03 3.485630e-03 6.677892e-03 2.469065e-03 
##         3367         3371         3374         3375         3381         3384 
## 1.255481e-02 5.758407e-01 2.530545e-01 6.416144e-01 1.082182e-01 3.882294e-02 
##         3389         3391         3392         3393         3395         3403 
## 3.270396e-03 5.860436e-02 3.956425e-03 2.336726e-03 6.556442e-01 4.098545e-02 
##         3413         3415         3424         3429         3434         3435 
## 9.575766e-03 3.169957e-02 4.058026e-02 1.457606e-02 1.511365e-01 7.782327e-03 
##         3436         3438         3448         3455         3460         3461 
## 4.355883e-02 4.443713e-02 5.549982e-03 7.615583e-03 9.604974e-02 9.540301e-03 
##         3465         3474         3488         3502         3504         3507 
## 3.691102e-03 7.451239e-04 7.060964e-03 2.145121e-02 1.060987e-02 3.588578e-02 
##         3508         3512         3514         3515         3517         3519 
## 1.865250e-02 4.104200e-02 4.755642e-03 2.805167e-02 4.669521e-03 9.685078e-03 
##         3523         3526         3529         3531         3534         3536 
## 1.245706e-02 7.107579e-01 1.612383e-01 3.156255e-02 1.003937e-02 3.697384e-03 
##         3537         3538         3540         3544         3548         3555 
## 2.507667e-03 5.533009e-02 1.047148e-02 1.087215e-02 1.032283e-01 3.329813e-03 
##         3564         3567         3570         3571         3584         3595 
## 5.167914e-02 5.657299e-03 3.477166e-08 1.230803e-03 3.989144e-02 4.338306e-03 
##         3606         3617         3619         3620         3625         3627 
## 3.668102e-02 9.935528e-03 2.414375e-02 1.671909e-03 9.945901e-02 2.156085e-01 
##         3629         3635         3638         3642         3646         3651 
## 1.749017e-03 1.069387e-03 2.719414e-03 1.654657e-01 6.417625e-02 9.922613e-02 
##         3655         3660         3661         3663         3664         3668 
## 9.221313e-02 3.506914e-03 6.251660e-02 1.026743e-02 1.289233e-02 4.371552e-02 
##         3669         3670         3671         3672         3678         3682 
## 6.490890e-03 2.395783e-02 4.849374e-03 1.458600e-02 1.350034e-03 8.533358e-02 
##         3684         3693         3697         3698         3700         3705 
## 2.788528e-02 1.405014e-02 1.024933e-02 1.290698e-02 5.941089e-02 2.605044e-02 
##         3711         3714         3724         3730         3733         3736 
## 1.628399e-01 6.762622e-03 3.141170e-02 3.727252e-02 8.949532e-03 1.585223e-02 
##         3742         3743         3746         3748         3752         3757 
## 4.807811e-02 3.347693e-02 5.720546e-02 8.131889e-02 1.127482e-01 2.132177e-02 
##         3760         3768         3774         3779         3781         3791 
## 3.647555e-02 9.144893e-02 1.757750e-02 1.031057e-01 1.813796e-01 1.163065e-02 
##         3793         3794         3797         3803         3804         3806 
## 7.740533e-03 1.879244e-01 3.016378e-01 3.232185e-02 1.258606e-08 4.090127e-03 
##         3810         3815         3818         3822         3835         3836 
## 8.959250e-03 8.918462e-03 4.408005e-01 1.810160e-02 1.915030e-02 1.204908e-01 
##         3853         3857         3861         3863         3872         3884 
## 8.328997e-02 2.473035e-02 2.152836e-02 6.975261e-03 8.527977e-03 4.245452e-02 
##         3888         3889         3894         3905         3909         3913 
## 1.287977e-01 1.089566e-01 2.703465e-03 5.446168e-03 6.173399e-09 6.115955e-03 
##         3918         3919         3926         3939         3940         3945 
## 7.165234e-01 1.028973e-02 7.823153e-03 1.024751e-02 7.799763e-02 1.247627e-02 
##         3951         3952         3954         3960         3962         3967 
## 2.738986e-03 4.125727e-02 5.527005e-02 7.839163e-03 2.142763e-01 9.392875e-02 
##         3970         3975         3982         3986         3988         4000 
## 3.948483e-03 1.026064e-02 1.298234e-02 7.479526e-03 7.065372e-02 2.225136e-01 
##         4001         4002         4005         4008         4010         4019 
## 1.210603e-02 4.109294e-02 8.940227e-02 7.740533e-03 7.484484e-01 1.576639e-02 
##         4028         4032         4035         4041         4046         4051 
## 1.848135e-02 6.647420e-03 2.366596e-01 3.553373e-02 1.006602e-01 7.435606e-02 
##         4053         4058         4063         4065         4068         4072 
## 1.710767e-09 1.173573e-03 2.038281e-03 4.594881e-03 1.353561e-02 1.478513e-08 
##         4074         4077         4085         4089         4097         4100 
## 2.458293e-03 1.669259e-01 7.769367e-04 2.789602e-03 8.886676e-03 1.520443e-02 
##         4104         4111         4113         4115         4116         4118 
## 3.286655e-03 8.491656e-02 6.796385e-03 2.066572e-03 4.127475e-02 1.380462e-01 
##         4119         4123         4125         4148         4150         4158 
## 2.077047e-02 3.413938e-02 1.461098e-01 4.983029e-03 6.569982e-03 6.791571e-02 
##         4160         4164         4170         4174         4181         4186 
## 6.519720e-01 3.293089e-03 2.088785e-02 2.388196e-02 2.258983e-03 2.678770e-02 
##         4191         4195         4203         4207         4223         4230 
## 8.121001e-02 2.305598e-01 1.259183e-02 1.175658e-02 1.152667e-02 7.954902e-01 
##         4239         4245         4251         4252         4260         4265 
## 3.362057e-01 3.916317e-03 1.350238e-01 2.343805e-02 6.510112e-02 6.388493e-03 
##         4268         4270         4273         4274         4277         4284 
## 5.741357e-03 1.164207e-08 6.349414e-03 1.023054e-02 9.068984e-10 6.239692e-09 
##         4291         4303         4308         4313         4325         4327 
## 1.487974e-02 3.322686e-01 3.990003e-03 1.549086e-01 6.632191e-03 2.786089e-01 
##         4331         4332         4336         4344         4346         4349 
## 5.733977e-03 1.395538e-02 9.509145e-03 1.384046e-02 5.003815e-03 2.967213e-02 
##         4352         4362         4366         4376         4379         4392 
## 3.251303e-02 1.592731e-02 5.140047e-02 6.320751e-02 1.531526e-02 2.277761e-02 
##         4394         4399         4403         4409         4410         4412 
## 4.973193e-03 9.342801e-02 2.444061e-01 2.021094e-03 1.156305e-02 4.042359e-03 
##         4415         4420         4423         4430         4432         4435 
## 2.264670e-02 5.454151e-03 5.418371e-01 2.293974e-02 2.167818e-03 8.628368e-09 
##         4437         4439         4446         4447         4455         4460 
## 1.259120e-01 1.035889e-02 8.217461e-03 2.663041e-03 3.878258e-02 8.868955e-01 
##         4462         4469         4473         4480         4484         4486 
## 7.980580e-03 6.682292e-04 1.185623e-02 6.463290e-09 1.941302e-01 2.718646e-02 
##         4488         4498 
## 5.167914e-02 3.642231e-02</code></pre>
<pre class="r"><code>vif(best_bootmodel)</code></pre>
<pre><code>##              GVIF Df GVIF^(1/(2*Df))
## default  1.071967  1        1.035359
## loan     1.019627  1        1.009766
## contact  1.470646  1        1.212702
## month    2.044676 10        1.036409
## duration 1.054404  1        1.026842
## campaign 1.139525  1        1.067486
## poutcome 1.251915  2        1.057776</code></pre>
</div>
<div id="best-model" class="section level1">
<h1>Best model</h1>
<p>After many iterations, below are the best model to predict the classification models</p>
<pre class="r"><code>best &lt;- glm(y~ contact+duration+loan+campaign,  data = bank, family = &quot;binomial&quot;)
summary(best)</code></pre>
<pre><code>## 
## Call:
## glm(formula = y ~ contact + duration + loan + campaign, family = &quot;binomial&quot;, 
##     data = bank)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.3165  -0.3882  -0.2509  -0.1343   3.1220  
## 
## Coefficients:
##                               Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)                 -2.9592322  0.3834729  -7.717 1.19e-14 ***
## contacttelephone and others -1.8219615  0.4801834  -3.794 0.000148 ***
## duration                     0.0062076  0.0009473   6.553 5.65e-11 ***
## loan1                       -1.6543472  0.6153348  -2.689 0.007177 ** 
## campaign                    -0.3323743  0.1404095  -2.367 0.017924 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 462.78  on 943  degrees of freedom
## Residual deviance: 378.51  on 939  degrees of freedom
## AIC: 388.51
## 
## Number of Fisher Scoring iterations: 7</code></pre>
<pre class="r"><code>predict(best, bank, type =&quot;response&quot;)</code></pre>
<pre><code>##            8            9           12           16           20           22 
## 0.0637666480 0.0061075115 0.0510513380 0.0162210233 0.0852640184 0.0436344907 
##           23           24           30           32           33           47 
## 0.0084147829 0.0547831429 0.0080104456 0.0306634588 0.0455074905 0.0044425745 
##           53           57           59           66           72           77 
## 0.0467244319 0.0027350893 0.0080123116 0.0787256230 0.0598227060 0.2065587505 
##           80           82           83           91           98          113 
## 0.0864610421 0.0379461441 0.0177263987 0.0850013956 0.1364330238 0.0132863295 
##          114          119          120          127          129          131 
## 0.0410045283 0.0539987653 0.1251148423 0.0081870500 0.0176184710 0.0575659093 
##          146          149          151          159          161          172 
## 0.1640683180 0.0437529778 0.0329641714 0.0954589737 0.0063590801 0.1137032251 
##          178          181          184          188          189          196 
## 0.0623002230 0.0167238336 0.0141400206 0.0632288866 0.0641382492 0.1469322206 
##          198          229          231          233          236          238 
## 0.0129353200 0.0378427602 0.0139499978 0.0603200543 0.0449482241 0.0116875256 
##          255          258          261          272          280          284 
## 0.0398012565 0.0279218685 0.0128203628 0.1275433727 0.2359852643 0.0019672068 
##          285          289          290          306          314          317 
## 0.0038626027 0.0639040612 0.0076468044 0.0734697877 0.0871974401 0.0500217401 
##          323          325          331          333          346          352 
## 0.0042665383 0.0032526094 0.0080267933 0.0190565438 0.0265380760 0.1020877142 
##          354          356          357          372          385          386 
## 0.1292829617 0.0051699206 0.0050723104 0.1185080457 0.0652651874 0.0677872706 
##          395          399          403          408          412          419 
## 0.1732079475 0.0022009686 0.1159386399 0.0854854436 0.2371063033 0.0522798432 
##          432          433          434          435          437          440 
## 0.3325147348 0.1316564707 0.0892178826 0.0106951795 0.0474326631 0.1214287873 
##          442          449          450          454          456          460 
## 0.0375979757 0.0607034417 0.1020877142 0.1636463512 0.0147587257 0.0718168001 
##          473          477          482          485          494          499 
## 0.0730681203 0.0092592572 0.0095114753 0.0507514473 0.0727676718 0.0305775881 
##          503          504          507          511          513          514 
## 0.0191096243 0.0484116857 0.0044527978 0.0197805323 0.1272010500 0.0074396302 
##          524          528          531          532          535          538 
## 0.1055021931 0.0689391696 0.0838227259 0.0030931079 0.0796307927 0.0215213725 
##          544          547          551          566          567          571 
## 0.0093738449 0.1034942036 0.0147097750 0.0231648726 0.0514912223 0.0327668613 
##          575          579          582          583          585          586 
## 0.0807557133 0.0210741057 0.1728022368 0.0021873780 0.0374955033 0.0234173448 
##          588          597          598          601          602          606 
## 0.0047099573 0.0368291734 0.0332461217 0.0859490418 0.0021750347 0.0162210233 
##          611          612          613          614          617          618 
## 0.0102449567 0.0170892305 0.0886714061 0.1917144309 0.1477427525 0.0486984600 
##          626          629          638          647          649          650 
## 0.0047856635 0.0633970540 0.0368101554 0.0481265147 0.0544349796 0.0108273432 
##          652          653          655          658          659          663 
## 0.1121753547 0.0064961147 0.0148301499 0.0714041056 0.1517313593 0.1012129410 
##          669          673          676          677          678          679 
## 0.1172172376 0.0902318745 0.0570483979 0.0087021818 0.0169292204 0.0082013791 
##          681          682          685          690          694          696 
## 0.1043864037 0.0132562185 0.1415687961 0.0020295910 0.0522677450 0.0055990544 
##          701          707          711          712          713          717 
## 0.1038074802 0.1607305724 0.0063199765 0.0630294579 0.1636463512 0.0478185161 
##          723          730          735          737          746          750 
## 0.0396725910 0.0807557133 0.0984241942 0.0577491165 0.0027520735 0.0110653582 
##          754          758          760          774          775          776 
## 0.0332633619 0.2387459970 0.3721461951 0.0778298722 0.0005503975 0.0240225917 
##          780          784          785          796          798          809 
## 0.0065582332 0.0043340942 0.0109245254 0.0069912585 0.0061453086 0.0419921419 
##          812          813          817          820          822          829 
## 0.0528984045 0.0902318745 0.0500217401 0.0697751337 0.0667964304 0.0089788237 
##          833          837          845          852          854          859 
## 0.3986043020 0.0088690217 0.0205679013 0.0288711565 0.0089238386 0.0133821093 
##          860          869          870          879          880          881 
## 0.0029703845 0.1458023257 0.0025359424 0.0208933443 0.0012106109 0.3882350798 
##          882          883          884          894          897          902 
## 0.0697555686 0.0412281244 0.0064345806 0.0775882052 0.2836324752 0.0340711500 
##          904          906          907          908          915          917 
## 0.0562619832 0.0557555004 0.0812177300 0.0033092012 0.0448266520 0.0338751293 
##          919          921          922          938          941          943 
## 0.1306869690 0.0302965821 0.0892178826 0.0544746806 0.1003932477 0.2101867810 
##          950          954          958          961          965          972 
## 0.0536553040 0.1349768701 0.0107308162 0.0144021199 0.0751983524 0.0556063996 
##          976          978          979          984         1001         1005 
## 0.1438471094 0.0228681493 0.2711906773 0.1085192286 0.0497137813 0.0149325938 
##         1007         1010         1012         1014         1028         1030 
## 0.0693386813 0.0012827118 0.0405282255 0.0377007170 0.0410045283 0.0703643890 
##         1039         1043         1045         1050         1053         1080 
## 0.0014904340 0.0147397283 0.0551054739 0.1505024986 0.0897235873 0.0175115127 
##         1082         1083         1085         1090         1097         1107 
## 0.0227929240 0.0321744422 0.0021992553 0.0026407889 0.0819354410 0.0011849403 
##         1109         1110         1124         1125         1129         1130 
## 0.0482812195 0.0667964304 0.1360362334 0.1401313229 0.0662017666 0.0671844207 
##         1134         1135         1147         1152         1156         1158 
## 0.0061627095 0.0569248300 0.0435163100 0.1827818827 0.1465100756 0.0541438026 
##         1160         1161         1163         1179         1183         1188 
## 0.0992775269 0.0100807541 0.0051076984 0.0378232393 0.0117986971 0.0901878623 
##         1190         1192         1196         1208         1211         1218 
## 0.1162296034 0.0786867378 0.0286826745 0.0023476572 0.1423903397 0.0020570943 
##         1223         1225         1226         1227         1228         1234 
## 0.0208933443 0.0123919777 0.0796307927 0.0060496927 0.0127419182 0.0099962145 
##         1235         1237         1238         1239         1241         1247 
## 0.0031123084 0.0242357532 0.0628622001 0.0140538772 0.0635975668 0.1641083777 
##         1249         1257         1262         1271         1281         1291 
## 0.1201105008 0.0147097750 0.0013535336 0.0115511060 0.0200225095 0.2490475414 
##         1292         1295         1296         1314         1318         1321 
## 0.0073240240 0.0098740948 0.0388630801 0.0123573216 0.0884425265 0.0426195478 
##         1322         1324         1325         1328         1329         1332 
## 0.0569248300 0.0426318506 0.1198111392 0.0055332512 0.0118380769 0.0495684828 
##         1333         1340         1341         1345         1346         1349 
## 0.0967839810 0.0736829822 0.0464120411 0.0621347721 0.3771736328 0.0778089131 
##         1352         1362         1368         1372         1381         1382 
## 0.0217240273 0.1431500659 0.0176051306 0.1335338547 0.0077356001 0.1360362334 
##         1387         1390         1406         1409         1411         1444 
## 0.2387459970 0.0167793725 0.0300320286 0.0115038984 0.0062149739 0.1261413155 
##         1445         1449         1456         1464         1466         1467 
## 0.1653526740 0.0072100665 0.0513529048 0.0098135899 0.0160117872 0.0081597914 
##         1470         1473         1477         1486         1488         1498 
## 0.3283944048 0.0034149912 0.0886714061 0.1696808674 0.0379461441 0.0336728628 
##         1506         1515         1516         1517         1518         1521 
## 0.0115835276 0.0059387360 0.0170892305 0.0211326850 0.0091460574 0.0835641369 
##         1523         1528         1529         1533         1539         1544 
## 0.0160773415 0.0263052107 0.2912608088 0.1258290723 0.0302202650 0.0285250930 
##         1550         1552         1557         1565         1570         1571 
## 0.0479967782 0.0172900718 0.0017500921 0.0048277545 0.0076980774 0.0196454928 
##         1572         1578         1587         1596         1597         1603 
## 0.1012129410 0.0081597914 0.0381734110 0.0656449091 0.0427357872 0.0077633336 
##         1605         1609         1617         1620         1622         1625 
## 0.0337572884 0.0165120329 0.0389691386 0.0196454928 0.0016801394 0.1017514807 
##         1630         1631         1632         1633         1641         1642 
## 0.0340788778 0.0257342375 0.0319817028 0.0414742003 0.0133002738 0.5096234016 
##         1660         1665         1677         1678         1696         1697 
## 0.0370583858 0.0335630106 0.1112248494 0.0528861711 0.5674736791 0.0479967782 
##         1698         1708         1709         1710         1718         1721 
## 0.0145310515 0.0017294616 0.0606728720 0.0995313846 0.0106652176 0.0051845255 
##         1722         1728         1732         1737         1743         1744 
## 0.1359732186 0.0301147419 0.0231472185 0.1278918191 0.0743394969 0.0240228125 
##         1749         1758         1762         1763         1766         1789 
## 0.1292829617 0.0021130322 0.0013078107 0.1545139410 0.0104355242 0.0129783229 
##         1793         1798         1799         1800         1815         1816 
## 0.0828741967 0.0414955242 0.0289507681 0.0137522178 0.1084673599 0.0237153665 
##         1820         1830         1838         1840         1844         1846 
## 0.0052786985 0.0150240413 0.4347979807 0.2050805636 0.1081934492 0.0141401518 
##         1861         1873         1876         1884         1886         1893 
## 0.0484225031 0.2432880567 0.1159386399 0.1012129410 0.0889442656 0.0366096049 
##         1894         1896         1898         1902         1910         1912 
## 0.0513382203 0.0945890780 0.0938630306 0.0349057553 0.0464249687 0.0040995608 
##         1931         1939         1941         1944         1961         1965 
## 0.0014048251 0.0090316145 0.2798638987 0.0176184710 0.0052461542 0.1093972009 
##         1967         1970         1974         1984         1986         1998 
## 0.1115586147 0.1162296034 0.0153102131 0.0619385661 0.0666198872 0.0183257798 
##         2001         2013         2020         2024         2025         2029 
## 0.0917723304 0.0207508685 0.0353184130 0.0093739323 0.0446824968 0.0067184272 
##         2031         2032         2042         2044         2051         2058 
## 0.0082376100 0.0545811210 0.0658520316 0.0359483071 0.0835641369 0.0126862478 
##         2059         2068         2070         2075         2078         2081 
## 0.1477795307 0.0773472257 0.0892178826 0.0101199235 0.1670732343 0.0123573216 
##         2083         2094         2095         2098         2099         2113 
## 0.0981728526 0.0326771090 0.0467005519 0.0051845255 0.2686384709 0.1520275500 
##         2116         2128         2134         2136         2154         2162 
## 0.1130791548 0.0760663149 0.0494098675 0.0605114639 0.1020877142 0.0587708445 
##         2172         2181         2182         2184         2193         2196 
## 0.0164748860 0.0352037079 0.0747677911 0.0122819034 0.0053320815 0.0477002324 
##         2198         2200         2205         2207         2224         2226 
## 0.0038438298 0.0238777002 0.0181037619 0.0240045207 0.0027520735 0.5720387210 
##         2227         2232         2235         2236         2243         2245 
## 0.0812177300 0.0814697036 0.0677872706 0.0115512135 0.0190711388 0.0111648606 
##         2246         2247         2248         2251         2252         2263 
## 0.0677872706 0.0146202120 0.0011056305 0.0643409453 0.1049681776 0.0907427541 
##         2268         2272         2291         2294         2295         2298 
## 0.0063984241 0.1085192286 0.0666198872 0.0218010107 0.0067827206 0.1975523596 
##         2301         2302         2305         2306         2307         2313 
## 0.0456308209 0.0747475897 0.0575950096 0.0415048636 0.0647156619 0.0074396302 
##         2319         2322         2323         2324         2331         2341 
## 0.1971032201 0.1115287381 0.1349142693 0.0323515124 0.0789315336 0.0541438026 
##         2344         2353         2358         2369         2370         2374 
## 0.0521274562 0.0074645708 0.2944190029 0.1159386399 0.0282820090 0.1115586147 
##         2377         2378         2383         2385         2396         2400 
## 0.1653850799 0.0570483979 0.0188402641 0.0943923362 0.0872206890 0.0656449091 
##         2401         2408         2414         2416         2419         2429 
## 0.0451033071 0.0047550331 0.0435163100 0.2572625622 0.0389691386 0.0425039938 
##         2430         2433         2437         2440         2443         2444 
## 0.0662349256 0.0206824606 0.3262851109 0.0082840728 0.0154471468 0.0959963256 
##         2446         2449         2458         2461         2484         2491 
## 0.0775673057 0.0805454601 0.1331441959 0.1846436802 0.0796087006 0.0498617505 
##         2494         2495         2514         2516         2518         2519 
## 0.0541438026 0.0108635165 0.0116548164 0.0589279009 0.0190709627 0.0372528781 
##         2526         2535         2537         2540         2542         2543 
## 0.0828741967 0.0273310415 0.0355305232 0.0949243139 0.0824036021 0.0559332878 
##         2550         2551         2560         2574         2581         2583 
## 0.0461509330 0.0010017360 0.0194663230 0.0033341113 0.0041622996 0.1749931079 
##         2589         2596         2597         2606         2609         2628 
## 0.0577491165 0.0867277472 0.0615788708 0.0028210688 0.1658185628 0.0042555032 
##         2642         2643         2644         2645         2651         2660 
## 0.3859623123 0.0328738970 0.0013580991 0.1309484211 0.0201446761 0.0594613870 
##         2661         2668         2684         2703         2704         2714 
## 0.0473948261 0.0191874371 0.1181562540 0.0093738449 0.0104648477 0.1568915438 
##         2720         2723         2731         2748         2751         2754 
## 0.3663631516 0.4142623963 0.0015090253 0.0078637382 0.0269487330 0.0089237553 
##         2755         2759         2764         2767         2769         2783 
## 0.0010074276 0.1046518072 0.0220555784 0.0484116857 0.0191874371 0.0030283777 
##         2788         2799         2804         2810         2811         2812 
## 0.0165670337 0.0059386804 0.0477002324 0.0525760993 0.0405282255 0.2798638987 
##         2815         2816         2823         2826         2834         2835 
## 0.0859719892 0.0730681203 0.3663631516 0.0127351740 0.0219335838 0.0528861711 
##         2839         2850         2855         2868         2871         2874 
## 0.0061075115 0.0270093422 0.0286254721 0.0384019847 0.0414955242 0.0027315001 
##         2877         2878         2879         2885         2886         2887 
## 0.0598095020 0.0308485069 0.0862373281 0.0724377290 0.0877161635 0.0184377886 
##         2896         2900         2902         2906         2911         2919 
## 0.0487093381 0.1692063281 0.0069753133 0.0843006803 0.0343778168 0.0599993950 
##         2924         2928         2931         2935         2942         2945 
## 0.0843006803 0.0185504691 0.0122067128 0.0666198872 0.0016849183 0.5871630623 
##         2946         2950         2952         2960         2965         2967 
## 0.0693732947 0.0519611001 0.0326696883 0.1912754004 0.0153413700 0.0083352269 
##         2971         2977         2979         2987         2988         2994 
## 0.0442980622 0.0089788237 0.0282755572 0.5796195780 0.0796307927 0.0081367978 
##         2995         3004         3010         3017         3019         3022 
## 0.0046103835 0.0681465338 0.0138827528 0.0157852436 0.0022422480 0.3541415663 
##         3027         3029         3038         3042         3045         3047 
## 0.0108518967 0.0099681909 0.0754121613 0.0685760352 0.0536825400 0.0093164634 
##         3048         3051         3058         3062         3069         3071 
## 0.0572589989 0.0596502449 0.0065363009 0.0417431267 0.0176676181 0.0070184430 
##         3078         3086         3088         3094         3098         3104 
## 0.0273517971 0.0330643223 0.0337572884 0.0119843041 0.0528979327 0.0013085113 
##         3107         3115         3117         3120         3121         3127 
## 0.4949487642 0.1932032587 0.0226093993 0.0109977373 0.0164747335 0.0047550331 
##         3129         3132         3137         3152         3163         3174 
## 0.0013361397 0.0654056042 0.0116937216 0.0610410749 0.0773472257 0.0231472185 
##         3175         3176         3184         3189         3191         3192 
## 0.0082376100 0.0830670143 0.0068878437 0.0227469833 0.3534932465 0.0145715787 
##         3195         3197         3198         3213         3218         3236 
## 0.0186121313 0.0052678686 0.0078416454 0.0088394302 0.0356278242 0.1710347927 
##         3241         3242         3243         3254         3262         3264 
## 0.0071494273 0.0017059153 0.0281830572 0.0021059342 0.1446796460 0.0959963256 
##         3267         3270         3271         3281         3287         3288 
## 0.0249616887 0.0097534522 0.0461745456 0.0068474969 0.0024283466 0.0077356001 
##         3294         3296         3304         3314         3316         3329 
## 0.1178611107 0.3478394772 0.0650924090 0.0716079618 0.1112248494 0.0718168001 
##         3335         3337         3338         3341         3358         3360 
## 0.2393593722 0.0087068090 0.0020041108 0.0086245161 0.0158735962 0.0081115940 
##         3367         3371         3374         3375         3381         3384 
## 0.0359212690 0.1191580522 0.1146721775 0.1378386411 0.0739134602 0.0877161635 
##         3389         3391         3392         3393         3395         3403 
## 0.0037702798 0.0165757730 0.0085670459 0.0056715748 0.1641083777 0.0159708608 
##         3413         3415         3424         3429         3434         3435 
## 0.0252848736 0.0336474765 0.0498617505 0.0511888870 0.1067306999 0.0259695697 
##         3436         3438         3448         3455         3460         3461 
## 0.0159179547 0.1619542198 0.0150319791 0.0208931517 0.2101867810 0.0070618375 
##         3465         3474         3488         3502         3504         3507 
## 0.0024822384 0.0005467002 0.0044425745 0.0223198341 0.0291478687 0.1001111220 
##         3508         3512         3514         3515         3517         3519 
## 0.0491300874 0.0504532246 0.0205047990 0.0122067128 0.0109245254 0.0374955033 
##         3523         3526         3529         3531         3534         3536 
## 0.0436344907 0.4785997130 0.1146721775 0.0149707612 0.0349934779 0.0051380916 
##         3537         3538         3540         3544         3548         3555 
## 0.0061075115 0.0253678769 0.0390956156 0.0392022828 0.0440233119 0.0088146207 
##         3564         3567         3570         3571         3584         3595 
## 0.0760663149 0.0193539101 0.0689391696 0.0053650555 0.0166219068 0.0079142346 
##         3606         3617         3619         3620         3625         3627 
## 0.0828741967 0.0370500082 0.0904649251 0.0030158666 0.0673960503 0.0180535908 
##         3629         3635         3638         3642         3646         3651 
## 0.0039017210 0.0018173562 0.0062007881 0.4965005474 0.1360362334 0.3394390083 
##         3655         3660         3661         3663         3664         3668 
## 0.0654711958 0.0048602634 0.0289724522 0.0516676591 0.0046389587 0.0414742003 
##         3669         3670         3671         3672         3678         3682 
## 0.0105564568 0.0639682500 0.0130580823 0.0056715748 0.0020181363 0.0720217432 
##         3684         3693         3697         3698         3700         3705 
## 0.0632288866 0.0047391024 0.0181585910 0.0533680621 0.0886911419 0.1038074802 
##         3711         3714         3724         3730         3733         3736 
## 0.1159386399 0.0110201137 0.0664105213 0.0456308209 0.0133821093 0.0181500531 
##         3742         3743         3746         3748         3752         3757 
## 0.1740987220 0.0311038570 0.1285857867 0.1296300551 0.0417431267 0.0773472257 
##         3760         3768         3774         3779         3781         3791 
## 0.0161756842 0.1155934753 0.0157649459 0.0329566877 0.0765037356 0.0435163100 
##         3793         3794         3797         3803         3804         3806 
## 0.0198354057 0.3779660721 0.4211217880 0.0468748516 0.0946350146 0.0109303214 
##         3810         3815         3818         3822         3835         3836 
## 0.0230884819 0.0246116843 0.2293361838 0.0076508033 0.0796307927 0.0501566617 
##         3853         3857         3861         3863         3872         3884 
## 0.2536187387 0.0218010107 0.0482812195 0.0046521142 0.0191140258 0.1020877142 
##         3888         3889         3894         3905         3909         3913 
## 0.2736514511 0.1382398477 0.0061626518 0.0137522178 0.0503175475 0.0144827104 
##         3918         3919         3926         3939         3940         3945 
## 0.5049687327 0.0384019847 0.0116223058 0.0265378327 0.0240836461 0.0109834247 
##         3951         3952         3954         3960         3962         3967 
## 0.0066995305 0.1658185628 0.0687573803 0.0025530344 0.0619527564 0.1188045909 
##         3970         3975         3982         3986         3988         4000 
## 0.0105349137 0.0284531074 0.0536825400 0.0266925687 0.2079564614 0.4302271401 
##         4001         4002         4005         4008         4010         4019 
## 0.0500217401 0.0539987653 0.1060894490 0.0198354057 0.0852222024 0.0413709281 
##         4028         4032         4035         4041         4046         4051 
## 0.0204432217 0.0169290637 0.3235618745 0.0127351740 0.1275162011 0.0305703501 
##         4053         4058         4063         4065         4068         4072 
## 0.0171938137 0.0018682420 0.0045819835 0.0064561739 0.0119687231 0.0292212921 
##         4074         4077         4085         4089         4097         4100 
## 0.0012071870 0.1191580522 0.0012106109 0.0126219728 0.0250629518 0.0135294367 
##         4104         4111         4113         4115         4116         4118 
## 0.0081096294 0.1140434733 0.0108939280 0.0037682308 0.0507514473 0.0492768505 
##         4119         4123         4125         4148         4150         4158 
## 0.0082608090 0.0363724954 0.0562619832 0.0013248364 0.0167236787 0.0907427541 
##         4160         4164         4170         4174         4181         4186 
## 0.4424403714 0.0160771925 0.0862373281 0.0536825400 0.0039891131 0.0607034417 
##         4191         4195         4203         4207         4223         4230 
## 0.1204673162 0.0970791453 0.0489868456 0.0488549089 0.0038408425 0.1244697822 
##         4239         4245         4251         4252         4260         4265 
## 0.1574091993 0.0107169471 0.0472805422 0.0970791453 0.0197105399 0.0174048702 
##         4268         4270         4273         4274         4277         4284 
## 0.0145309167 0.0823630627 0.0103717118 0.0106869247 0.0090900575 0.0327671597 
##         4291         4303         4308         4313         4325         4327 
## 0.0899115642 0.1549549608 0.0099349689 0.0797601086 0.0184990834 0.3498937272 
##         4331         4332         4336         4344         4346         4349 
## 0.0135397313 0.0364991207 0.0021266800 0.0572589989 0.0109552078 0.0359584300 
##         4352         4362         4366         4376         4379         4392 
## 0.0395646968 0.0142084937 0.0637666480 0.1416339790 0.0401573545 0.0478429391 
##         4394         4399         4403         4409         4410         4412 
## 0.0115450922 0.1181562540 0.4462057882 0.0039481616 0.0432586645 0.0107969144 
##         4415         4420         4423         4430         4432         4435 
## 0.0475609509 0.0100602657 0.2983023875 0.0098464101 0.0038201337 0.1265134707 
##         4437         4439         4446         4447         4455         4460 
## 0.1508654020 0.0028739447 0.0226093993 0.0069753133 0.0475609509 0.4655173565 
##         4462         4469         4473         4480         4484         4486 
## 0.0219335838 0.0022902136 0.0308555271 0.0492768505 0.2823728809 0.1046518072 
##         4488         4498 
## 0.0760663149 0.0775882052</code></pre>
<pre class="r"><code>vif(best)</code></pre>
<pre><code>##  contact duration     loan campaign 
## 1.002714 1.011402 1.009681 1.000656</code></pre>
<p>The above model is significant</p>
<p>The contact, duration, loan and campaign are the best predictors</p>
<p>I have done this manual logistic regression after the machine learning automated logsitic regression.</p>
<p>As per the above manual and tidymodels logistic regresssion, it was evident from the confusion matric that majority of the customers are predicted that they will not subscribe to term deposit</p>
<div id="observations-and-comments" class="section level2">
<h2>Observations and comments</h2>
<ol style="list-style-type: decimal">
<li><p>The important determinants of the subcription to term deposit are contact, duration, loan and campaign.</p></li>
<li><p>Though balance, day and default had positive correlation, it failed to get significance in a whole equation</p></li>
<li><p>They failed to include the main determinats such as rate of interest, tenure of the term deposit, flexibility of preclosure, etc which are the main influencer for the customer to subscribe to term deposit</p></li>
<li><p>All the character variables are assigned as a factor and few of the ordinal categorical variables are assigned a number</p></li>
<li><p>Based on the outcome, bank should stop targeting those who has any loan as they wont be able to subscribe to term deposit due to fixed monthly obligations by loan EMI</p></li>
<li><p>Bank should keep doing marketing campaign as that will eventually gain a good business, if not immediately, at least in future.</p></li>
</ol>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<p>[Moro et al., 2014] S. Moro, P. Cortez and P. Rita. A Data-Driven Approach to Predict the Success of Bank Telemarketing. Decision Support Systems, Elsevier, 62:22-31, June 2014
<a href="https://archive.ics.uci.edu/ml/datasets/Bank+Marketing" class="uri">https://archive.ics.uci.edu/ml/datasets/Bank+Marketing</a></p>
</div>
</div>
